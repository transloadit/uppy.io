/*! For license information please see 2429.20d27113.js.LICENSE.txt */
(self.webpackChunkuppy_io=self.webpackChunkuppy_io||[]).push([[2429],{78478:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});i(96540);var r=i(92303),o=i(74848);function n(t){let{children:e,fallback:i}=t;return(0,r.A)()?(0,o.jsx)(o.Fragment,{children:e?.()}):i??null}},65643:function(t){t.exports=function(){"use strict";function t(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function e(e){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?t(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function r(t){var e=i(t,"string");return"symbol"==typeof e?e:e+""}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o)}}function a(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t,e,i){return(e=r(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t){return u(t)||h(t)||p(t)||m()}function u(t){if(Array.isArray(t))return d(t)}function h(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function p(t,e){if(t){if("string"==typeof t)return d(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f="undefined"!=typeof window&&void 0!==window.document,g=f?window:{},v=!(!f||!g.document.documentElement)&&"ontouchstart"in g.document.documentElement,y=!!f&&"PointerEvent"in g,b="cropper",w="all",S="crop",x="move",C="zoom",R="e",k="w",E="s",P="n",A="ne",D="nw",T="se",_="sw",U="".concat(b,"-crop"),M="".concat(b,"-disabled"),L="".concat(b,"-hidden"),O="".concat(b,"-hide"),N="".concat(b,"-invisible"),I="".concat(b,"-modal"),F="".concat(b,"-move"),z="".concat(b,"Action"),j="".concat(b,"Preview"),Y="crop",H="move",B="none",q="crop",V="cropend",W="cropmove",$="cropstart",X="dblclick",K=v?"touchstart":"mousedown",G=v?"touchmove":"mousemove",Z=v?"touchend touchcancel":"mouseup",J=y?"pointerdown":K,Q=y?"pointermove":G,tt=y?"pointerup pointercancel":Z,et="ready",it="resize",rt="wheel",ot="zoom",nt="image/jpeg",st=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,at=/^data:/,ct=/^data:image\/jpeg;base64,/,lt=/^img|canvas$/i,ut=200,ht=100,pt={viewMode:0,dragMode:Y,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:ut,minContainerHeight:ht,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},dt='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',mt=Number.isNaN||g.isNaN;function ft(t){return"number"==typeof t&&!mt(t)}var gt=function(t){return t>0&&t<1/0};function vt(t){return void 0===t}function yt(t){return"object"===o(t)&&null!==t}var bt=Object.prototype.hasOwnProperty;function wt(t){if(!yt(t))return!1;try{var e=t.constructor,i=e.prototype;return e&&i&&bt.call(i,"isPrototypeOf")}catch(r){return!1}}function St(t){return"function"==typeof t}var xt=Array.prototype.slice;function Ct(t){return Array.from?Array.from(t):xt.call(t)}function Rt(t,e){return t&&St(e)&&(Array.isArray(t)||ft(t.length)?Ct(t).forEach((function(i,r){e.call(t,i,r,t)})):yt(t)&&Object.keys(t).forEach((function(i){e.call(t,t[i],i,t)}))),t}var kt=Object.assign||function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return yt(t)&&i.length>0&&i.forEach((function(e){yt(e)&&Object.keys(e).forEach((function(i){t[i]=e[i]}))})),t},Et=/\.\d*(?:0|9){12}\d*$/;function Pt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return Et.test(t)?Math.round(t*e)/e:t}var At=/^width|height|left|top|marginLeft|marginTop$/;function Dt(t,e){var i=t.style;Rt(e,(function(t,e){At.test(e)&&ft(t)&&(t="".concat(t,"px")),i[e]=t}))}function Tt(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function _t(t,e){if(e)if(ft(t.length))Rt(t,(function(t){_t(t,e)}));else if(t.classList)t.classList.add(e);else{var i=t.className.trim();i?i.indexOf(e)<0&&(t.className="".concat(i," ").concat(e)):t.className=e}}function Ut(t,e){e&&(ft(t.length)?Rt(t,(function(t){Ut(t,e)})):t.classList?t.classList.remove(e):t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,"")))}function Mt(t,e,i){e&&(ft(t.length)?Rt(t,(function(t){Mt(t,e,i)})):i?_t(t,e):Ut(t,e))}var Lt=/([a-z\d])([A-Z])/g;function Ot(t){return t.replace(Lt,"$1-$2").toLowerCase()}function Nt(t,e){return yt(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(Ot(e)))}function It(t,e,i){yt(i)?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-".concat(Ot(e)),i)}function Ft(t,e){if(yt(t[e]))try{delete t[e]}catch(i){t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch(i){t.dataset[e]=void 0}else t.removeAttribute("data-".concat(Ot(e)))}var zt=/\s\s*/,jt=function(){var t=!1;if(f){var e=!1,i=function(){},r=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(t){e=t}});g.addEventListener("test",i,r),g.removeEventListener("test",i,r)}return t}();function Yt(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i;e.trim().split(zt).forEach((function(e){if(!jt){var n=t.listeners;n&&n[e]&&n[e][i]&&(o=n[e][i],delete n[e][i],0===Object.keys(n[e]).length&&delete n[e],0===Object.keys(n).length&&delete t.listeners)}t.removeEventListener(e,o,r)}))}function Ht(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i;e.trim().split(zt).forEach((function(e){if(r.once&&!jt){var n=t.listeners,s=void 0===n?{}:n;o=function(){delete s[e][i],t.removeEventListener(e,o,r);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];i.apply(t,a)},s[e]||(s[e]={}),s[e][i]&&t.removeEventListener(e,s[e][i],r),s[e][i]=o,t.listeners=s}t.addEventListener(e,o,r)}))}function Bt(t,e,i){var r;return St(Event)&&St(CustomEvent)?r=new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0}):(r=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,i),t.dispatchEvent(r)}function qt(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Vt=g.location,Wt=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function $t(t){var e=t.match(Wt);return null!==e&&(e[1]!==Vt.protocol||e[2]!==Vt.hostname||e[3]!==Vt.port)}function Xt(t){var e="timestamp=".concat((new Date).getTime());return t+(-1===t.indexOf("?")?"?":"&")+e}function Kt(t){var e=t.rotate,i=t.scaleX,r=t.scaleY,o=t.translateX,n=t.translateY,s=[];ft(o)&&0!==o&&s.push("translateX(".concat(o,"px)")),ft(n)&&0!==n&&s.push("translateY(".concat(n,"px)")),ft(e)&&0!==e&&s.push("rotate(".concat(e,"deg)")),ft(i)&&1!==i&&s.push("scaleX(".concat(i,")")),ft(r)&&1!==r&&s.push("scaleY(".concat(r,")"));var a=s.length?s.join(" "):"none";return{WebkitTransform:a,msTransform:a,transform:a}}function Gt(t){var i=e({},t),r=0;return Rt(t,(function(t,e){delete i[e],Rt(i,(function(e){var i=Math.abs(t.startX-e.startX),o=Math.abs(t.startY-e.startY),n=Math.abs(t.endX-e.endX),s=Math.abs(t.endY-e.endY),a=Math.sqrt(i*i+o*o),c=(Math.sqrt(n*n+s*s)-a)/a;Math.abs(c)>Math.abs(r)&&(r=c)}))})),r}function Zt(t,i){var r=t.pageX,o=t.pageY,n={endX:r,endY:o};return i?n:e({startX:r,startY:o},n)}function Jt(t){var e=0,i=0,r=0;return Rt(t,(function(t){var o=t.startX,n=t.startY;e+=o,i+=n,r+=1})),{pageX:e/=r,pageY:i/=r}}function Qt(t){var e=t.aspectRatio,i=t.height,r=t.width,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",n=gt(r),s=gt(i);if(n&&s){var a=i*e;"contain"===o&&a>r||"cover"===o&&a<r?i=r/e:r=i*e}else n?i=r/e:s&&(r=i*e);return{width:r,height:i}}function te(t){var e=t.width,i=t.height,r=t.degree;if(90==(r=Math.abs(r)%180))return{width:i,height:e};var o=r%90*Math.PI/180,n=Math.sin(o),s=Math.cos(o),a=e*s+i*n,c=e*n+i*s;return r>90?{width:c,height:a}:{width:a,height:c}}function ee(t,e,i,r){var o=e.aspectRatio,n=e.naturalWidth,s=e.naturalHeight,a=e.rotate,c=void 0===a?0:a,u=e.scaleX,h=void 0===u?1:u,p=e.scaleY,d=void 0===p?1:p,m=i.aspectRatio,f=i.naturalWidth,g=i.naturalHeight,v=r.fillColor,y=void 0===v?"transparent":v,b=r.imageSmoothingEnabled,w=void 0===b||b,S=r.imageSmoothingQuality,x=void 0===S?"low":S,C=r.maxWidth,R=void 0===C?1/0:C,k=r.maxHeight,E=void 0===k?1/0:k,P=r.minWidth,A=void 0===P?0:P,D=r.minHeight,T=void 0===D?0:D,_=document.createElement("canvas"),U=_.getContext("2d"),M=Qt({aspectRatio:m,width:R,height:E}),L=Qt({aspectRatio:m,width:A,height:T},"cover"),O=Math.min(M.width,Math.max(L.width,f)),N=Math.min(M.height,Math.max(L.height,g)),I=Qt({aspectRatio:o,width:R,height:E}),F=Qt({aspectRatio:o,width:A,height:T},"cover"),z=Math.min(I.width,Math.max(F.width,n)),j=Math.min(I.height,Math.max(F.height,s)),Y=[-z/2,-j/2,z,j];return _.width=Pt(O),_.height=Pt(N),U.fillStyle=y,U.fillRect(0,0,O,N),U.save(),U.translate(O/2,N/2),U.rotate(c*Math.PI/180),U.scale(h,d),U.imageSmoothingEnabled=w,U.imageSmoothingQuality=x,U.drawImage.apply(U,[t].concat(l(Y.map((function(t){return Math.floor(Pt(t))}))))),U.restore(),_}var ie=String.fromCharCode;function re(t,e,i){var r="";i+=e;for(var o=e;o<i;o+=1)r+=ie(t.getUint8(o));return r}var oe=/^data:.*,/;function ne(t){var e=t.replace(oe,""),i=atob(e),r=new ArrayBuffer(i.length),o=new Uint8Array(r);return Rt(o,(function(t,e){o[e]=i.charCodeAt(e)})),r}function se(t,e){for(var i=[],r=8192,o=new Uint8Array(t);o.length>0;)i.push(ie.apply(null,Ct(o.subarray(0,r)))),o=o.subarray(r);return"data:".concat(e,";base64,").concat(btoa(i.join("")))}function ae(t){var e,i=new DataView(t);try{var r,o,n;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var s=i.byteLength,a=2;a+1<s;){if(255===i.getUint8(a)&&225===i.getUint8(a+1)){o=a;break}a+=1}if(o){var c=o+10;if("Exif"===re(i,o+4,4)){var l=i.getUint16(c);if(((r=18761===l)||19789===l)&&42===i.getUint16(c+2,r)){var u=i.getUint32(c+4,r);u>=8&&(n=c+u)}}}if(n){var h,p,d=i.getUint16(n,r);for(p=0;p<d;p+=1)if(h=n+12*p+2,274===i.getUint16(h,r)){h+=8,e=i.getUint16(h,r),i.setUint16(h,1,r);break}}}catch(m){e=1}return e}function ce(t){var e=0,i=1,r=1;switch(t){case 2:i=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,i=-1;break;case 8:e=-90}return{rotate:e,scaleX:i,scaleY:r}}var le={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,e=this.options,i=this.container,r=this.cropper,o=Number(e.minContainerWidth),n=Number(e.minContainerHeight);_t(r,L),Ut(t,L);var s={width:Math.max(i.offsetWidth,o>=0?o:ut),height:Math.max(i.offsetHeight,n>=0?n:ht)};this.containerData=s,Dt(r,{width:s.width,height:s.height}),_t(t,L),Ut(r,L)},initCanvas:function(){var t=this.containerData,e=this.imageData,i=this.options.viewMode,r=Math.abs(e.rotate)%180==90,o=r?e.naturalHeight:e.naturalWidth,n=r?e.naturalWidth:e.naturalHeight,s=o/n,a=t.width,c=t.height;t.height*s>t.width?3===i?a=t.height*s:c=t.width/s:3===i?c=t.width/s:a=t.height*s;var l={aspectRatio:s,naturalWidth:o,naturalHeight:n,width:a,height:c};this.canvasData=l,this.limited=1===i||2===i,this.limitCanvas(!0,!0),l.width=Math.min(Math.max(l.width,l.minWidth),l.maxWidth),l.height=Math.min(Math.max(l.height,l.minHeight),l.maxHeight),l.left=(t.width-l.width)/2,l.top=(t.height-l.height)/2,l.oldLeft=l.left,l.oldTop=l.top,this.initialCanvasData=kt({},l)},limitCanvas:function(t,e){var i=this.options,r=this.containerData,o=this.canvasData,n=this.cropBoxData,s=i.viewMode,a=o.aspectRatio,c=this.cropped&&n;if(t){var l=Number(i.minCanvasWidth)||0,u=Number(i.minCanvasHeight)||0;s>1?(l=Math.max(l,r.width),u=Math.max(u,r.height),3===s&&(u*a>l?l=u*a:u=l/a)):s>0&&(l?l=Math.max(l,c?n.width:0):u?u=Math.max(u,c?n.height:0):c&&(l=n.width,(u=n.height)*a>l?l=u*a:u=l/a));var h=Qt({aspectRatio:a,width:l,height:u});l=h.width,u=h.height,o.minWidth=l,o.minHeight=u,o.maxWidth=1/0,o.maxHeight=1/0}if(e)if(s>(c?0:1)){var p=r.width-o.width,d=r.height-o.height;o.minLeft=Math.min(0,p),o.minTop=Math.min(0,d),o.maxLeft=Math.max(0,p),o.maxTop=Math.max(0,d),c&&this.limited&&(o.minLeft=Math.min(n.left,n.left+(n.width-o.width)),o.minTop=Math.min(n.top,n.top+(n.height-o.height)),o.maxLeft=n.left,o.maxTop=n.top,2===s&&(o.width>=r.width&&(o.minLeft=Math.min(0,p),o.maxLeft=Math.max(0,p)),o.height>=r.height&&(o.minTop=Math.min(0,d),o.maxTop=Math.max(0,d))))}else o.minLeft=-o.width,o.minTop=-o.height,o.maxLeft=r.width,o.maxTop=r.height},renderCanvas:function(t,e){var i=this.canvasData,r=this.imageData;if(e){var o=te({width:r.naturalWidth*Math.abs(r.scaleX||1),height:r.naturalHeight*Math.abs(r.scaleY||1),degree:r.rotate||0}),n=o.width,s=o.height,a=i.width*(n/i.naturalWidth),c=i.height*(s/i.naturalHeight);i.left-=(a-i.width)/2,i.top-=(c-i.height)/2,i.width=a,i.height=c,i.aspectRatio=n/s,i.naturalWidth=n,i.naturalHeight=s,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,Dt(this.canvas,kt({width:i.width,height:i.height},Kt({translateX:i.left,translateY:i.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var e=this.canvasData,i=this.imageData,r=i.naturalWidth*(e.width/e.naturalWidth),o=i.naturalHeight*(e.height/e.naturalHeight);kt(i,{width:r,height:o,left:(e.width-r)/2,top:(e.height-o)/2}),Dt(this.image,kt({width:i.width,height:i.height},Kt(kt({translateX:i.left,translateY:i.top},i)))),t&&this.output()},initCropBox:function(){var t=this.options,e=this.canvasData,i=t.aspectRatio||t.initialAspectRatio,r=Number(t.autoCropArea)||.8,o={width:e.width,height:e.height};i&&(e.height*i>e.width?o.height=o.width/i:o.width=o.height*i),this.cropBoxData=o,this.limitCropBox(!0,!0),o.width=Math.min(Math.max(o.width,o.minWidth),o.maxWidth),o.height=Math.min(Math.max(o.height,o.minHeight),o.maxHeight),o.width=Math.max(o.minWidth,o.width*r),o.height=Math.max(o.minHeight,o.height*r),o.left=e.left+(e.width-o.width)/2,o.top=e.top+(e.height-o.height)/2,o.oldLeft=o.left,o.oldTop=o.top,this.initialCropBoxData=kt({},o)},limitCropBox:function(t,e){var i=this.options,r=this.containerData,o=this.canvasData,n=this.cropBoxData,s=this.limited,a=i.aspectRatio;if(t){var c=Number(i.minCropBoxWidth)||0,l=Number(i.minCropBoxHeight)||0,u=s?Math.min(r.width,o.width,o.width+o.left,r.width-o.left):r.width,h=s?Math.min(r.height,o.height,o.height+o.top,r.height-o.top):r.height;c=Math.min(c,r.width),l=Math.min(l,r.height),a&&(c&&l?l*a>c?l=c/a:c=l*a:c?l=c/a:l&&(c=l*a),h*a>u?h=u/a:u=h*a),n.minWidth=Math.min(c,u),n.minHeight=Math.min(l,h),n.maxWidth=u,n.maxHeight=h}e&&(s?(n.minLeft=Math.max(0,o.left),n.minTop=Math.max(0,o.top),n.maxLeft=Math.min(r.width,o.left+o.width)-n.width,n.maxTop=Math.min(r.height,o.top+o.height)-n.height):(n.minLeft=0,n.minTop=0,n.maxLeft=r.width-n.width,n.maxTop=r.height-n.height))},renderCropBox:function(){var t=this.options,e=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,t.movable&&t.cropBoxMovable&&It(this.face,z,i.width>=e.width&&i.height>=e.height?x:w),Dt(this.cropBox,kt({width:i.width,height:i.height},Kt({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Bt(this.element,q,this.getData())}},ue={initPreview:function(){var t=this.element,e=this.crossOrigin,i=this.options.preview,r=e?this.crossOriginUrl:this.url,o=t.alt||"The image to preview",n=document.createElement("img");if(e&&(n.crossOrigin=e),n.src=r,n.alt=o,this.viewBox.appendChild(n),this.viewBoxImage=n,i){var s=i;"string"==typeof i?s=t.ownerDocument.querySelectorAll(i):i.querySelector&&(s=[i]),this.previews=s,Rt(s,(function(t){var i=document.createElement("img");It(t,j,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),e&&(i.crossOrigin=e),i.src=r,i.alt=o,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',t.innerHTML="",t.appendChild(i)}))}},resetPreview:function(){Rt(this.previews,(function(t){var e=Nt(t,j);Dt(t,{width:e.width,height:e.height}),t.innerHTML=e.html,Ft(t,j)}))},preview:function(){var t=this.imageData,e=this.canvasData,i=this.cropBoxData,r=i.width,o=i.height,n=t.width,s=t.height,a=i.left-e.left-t.left,c=i.top-e.top-t.top;this.cropped&&!this.disabled&&(Dt(this.viewBoxImage,kt({width:n,height:s},Kt(kt({translateX:-a,translateY:-c},t)))),Rt(this.previews,(function(e){var i=Nt(e,j),l=i.width,u=i.height,h=l,p=u,d=1;r&&(p=o*(d=l/r)),o&&p>u&&(h=r*(d=u/o),p=u),Dt(e,{width:h,height:p}),Dt(e.getElementsByTagName("img")[0],kt({width:n*d,height:s*d},Kt(kt({translateX:-a*d,translateY:-c*d},t))))})))}},he={bind:function(){var t=this.element,e=this.options,i=this.cropper;St(e.cropstart)&&Ht(t,$,e.cropstart),St(e.cropmove)&&Ht(t,W,e.cropmove),St(e.cropend)&&Ht(t,V,e.cropend),St(e.crop)&&Ht(t,q,e.crop),St(e.zoom)&&Ht(t,ot,e.zoom),Ht(i,J,this.onCropStart=this.cropStart.bind(this)),e.zoomable&&e.zoomOnWheel&&Ht(i,rt,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&Ht(i,X,this.onDblclick=this.dblclick.bind(this)),Ht(t.ownerDocument,Q,this.onCropMove=this.cropMove.bind(this)),Ht(t.ownerDocument,tt,this.onCropEnd=this.cropEnd.bind(this)),e.responsive&&Ht(window,it,this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,e=this.options,i=this.cropper;St(e.cropstart)&&Yt(t,$,e.cropstart),St(e.cropmove)&&Yt(t,W,e.cropmove),St(e.cropend)&&Yt(t,V,e.cropend),St(e.crop)&&Yt(t,q,e.crop),St(e.zoom)&&Yt(t,ot,e.zoom),Yt(i,J,this.onCropStart),e.zoomable&&e.zoomOnWheel&&Yt(i,rt,this.onWheel,{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&Yt(i,X,this.onDblclick),Yt(t.ownerDocument,Q,this.onCropMove),Yt(t.ownerDocument,tt,this.onCropEnd),e.responsive&&Yt(window,it,this.onResize)}},pe={resize:function(){if(!this.disabled){var t,e,i=this.options,r=this.container,o=this.containerData,n=r.offsetWidth/o.width,s=r.offsetHeight/o.height,a=Math.abs(n-1)>Math.abs(s-1)?n:s;1!==a&&(i.restore&&(t=this.getCanvasData(),e=this.getCropBoxData()),this.render(),i.restore&&(this.setCanvasData(Rt(t,(function(e,i){t[i]=e*a}))),this.setCropBoxData(Rt(e,(function(t,i){e[i]=t*a})))))}},dblclick:function(){this.disabled||this.options.dragMode===B||this.setDragMode(Tt(this.dragBox,U)?H:Y)},wheel:function(t){var e=this,i=Number(this.options.wheelZoomRatio)||.1,r=1;this.disabled||(t.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((function(){e.wheeling=!1}),50),t.deltaY?r=t.deltaY>0?1:-1:t.wheelDelta?r=-t.wheelDelta/120:t.detail&&(r=t.detail>0?1:-1),this.zoom(-r*i,t)))},cropStart:function(t){var e=t.buttons,i=t.button;if(!(this.disabled||("mousedown"===t.type||"pointerdown"===t.type&&"mouse"===t.pointerType)&&(ft(e)&&1!==e||ft(i)&&0!==i||t.ctrlKey))){var r,o=this.options,n=this.pointers;t.changedTouches?Rt(t.changedTouches,(function(t){n[t.identifier]=Zt(t)})):n[t.pointerId||0]=Zt(t),r=Object.keys(n).length>1&&o.zoomable&&o.zoomOnTouch?C:Nt(t.target,z),st.test(r)&&!1!==Bt(this.element,$,{originalEvent:t,action:r})&&(t.preventDefault(),this.action=r,this.cropping=!1,r===S&&(this.cropping=!0,_t(this.dragBox,I)))}},cropMove:function(t){var e=this.action;if(!this.disabled&&e){var i=this.pointers;t.preventDefault(),!1!==Bt(this.element,W,{originalEvent:t,action:e})&&(t.changedTouches?Rt(t.changedTouches,(function(t){kt(i[t.identifier]||{},Zt(t,!0))})):kt(i[t.pointerId||0]||{},Zt(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var e=this.action,i=this.pointers;t.changedTouches?Rt(t.changedTouches,(function(t){delete i[t.identifier]})):delete i[t.pointerId||0],e&&(t.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,Mt(this.dragBox,I,this.cropped&&this.options.modal)),Bt(this.element,V,{originalEvent:t,action:e}))}}},de={change:function(t){var e,i=this.options,r=this.canvasData,o=this.containerData,n=this.cropBoxData,s=this.pointers,a=this.action,c=i.aspectRatio,l=n.left,u=n.top,h=n.width,p=n.height,d=l+h,m=u+p,f=0,g=0,v=o.width,y=o.height,b=!0;!c&&t.shiftKey&&(c=h&&p?h/p:1),this.limited&&(f=n.minLeft,g=n.minTop,v=f+Math.min(o.width,r.width,r.left+r.width),y=g+Math.min(o.height,r.height,r.top+r.height));var U=s[Object.keys(s)[0]],M={x:U.endX-U.startX,y:U.endY-U.startY},O=function(t){switch(t){case R:d+M.x>v&&(M.x=v-d);break;case k:l+M.x<f&&(M.x=f-l);break;case P:u+M.y<g&&(M.y=g-u);break;case E:m+M.y>y&&(M.y=y-m)}};switch(a){case w:l+=M.x,u+=M.y;break;case R:if(M.x>=0&&(d>=v||c&&(u<=g||m>=y))){b=!1;break}O(R),(h+=M.x)<0&&(a=k,l-=h=-h),c&&(p=h/c,u+=(n.height-p)/2);break;case P:if(M.y<=0&&(u<=g||c&&(l<=f||d>=v))){b=!1;break}O(P),p-=M.y,u+=M.y,p<0&&(a=E,u-=p=-p),c&&(h=p*c,l+=(n.width-h)/2);break;case k:if(M.x<=0&&(l<=f||c&&(u<=g||m>=y))){b=!1;break}O(k),h-=M.x,l+=M.x,h<0&&(a=R,l-=h=-h),c&&(p=h/c,u+=(n.height-p)/2);break;case E:if(M.y>=0&&(m>=y||c&&(l<=f||d>=v))){b=!1;break}O(E),(p+=M.y)<0&&(a=P,u-=p=-p),c&&(h=p*c,l+=(n.width-h)/2);break;case A:if(c){if(M.y<=0&&(u<=g||d>=v)){b=!1;break}O(P),p-=M.y,u+=M.y,h=p*c}else O(P),O(R),M.x>=0?d<v?h+=M.x:M.y<=0&&u<=g&&(b=!1):h+=M.x,M.y<=0?u>g&&(p-=M.y,u+=M.y):(p-=M.y,u+=M.y);h<0&&p<0?(a=_,u-=p=-p,l-=h=-h):h<0?(a=D,l-=h=-h):p<0&&(a=T,u-=p=-p);break;case D:if(c){if(M.y<=0&&(u<=g||l<=f)){b=!1;break}O(P),p-=M.y,u+=M.y,h=p*c,l+=n.width-h}else O(P),O(k),M.x<=0?l>f?(h-=M.x,l+=M.x):M.y<=0&&u<=g&&(b=!1):(h-=M.x,l+=M.x),M.y<=0?u>g&&(p-=M.y,u+=M.y):(p-=M.y,u+=M.y);h<0&&p<0?(a=T,u-=p=-p,l-=h=-h):h<0?(a=A,l-=h=-h):p<0&&(a=_,u-=p=-p);break;case _:if(c){if(M.x<=0&&(l<=f||m>=y)){b=!1;break}O(k),h-=M.x,l+=M.x,p=h/c}else O(E),O(k),M.x<=0?l>f?(h-=M.x,l+=M.x):M.y>=0&&m>=y&&(b=!1):(h-=M.x,l+=M.x),M.y>=0?m<y&&(p+=M.y):p+=M.y;h<0&&p<0?(a=A,u-=p=-p,l-=h=-h):h<0?(a=T,l-=h=-h):p<0&&(a=D,u-=p=-p);break;case T:if(c){if(M.x>=0&&(d>=v||m>=y)){b=!1;break}O(R),p=(h+=M.x)/c}else O(E),O(R),M.x>=0?d<v?h+=M.x:M.y>=0&&m>=y&&(b=!1):h+=M.x,M.y>=0?m<y&&(p+=M.y):p+=M.y;h<0&&p<0?(a=D,u-=p=-p,l-=h=-h):h<0?(a=_,l-=h=-h):p<0&&(a=A,u-=p=-p);break;case x:this.move(M.x,M.y),b=!1;break;case C:this.zoom(Gt(s),t),b=!1;break;case S:if(!M.x||!M.y){b=!1;break}e=qt(this.cropper),l=U.startX-e.left,u=U.startY-e.top,h=n.minWidth,p=n.minHeight,M.x>0?a=M.y>0?T:A:M.x<0&&(l-=h,a=M.y>0?_:D),M.y<0&&(u-=p),this.cropped||(Ut(this.cropBox,L),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}b&&(n.width=h,n.height=p,n.left=l,n.top=u,this.action=a,this.renderCropBox()),Rt(s,(function(t){t.startX=t.endX,t.startY=t.endY}))}},me={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&_t(this.dragBox,I),Ut(this.cropBox,L),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=kt({},this.initialImageData),this.canvasData=kt({},this.initialCanvasData),this.cropBoxData=kt({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(kt(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Ut(this.dragBox,I),_t(this.cropBox,L)),this},replace:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&t&&(this.isImg&&(this.element.src=t),e?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,Rt(this.previews,(function(e){e.getElementsByTagName("img")[0].src=t})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Ut(this.cropper,M)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,_t(this.cropper,M)),this},destroy:function(){var t=this.element;return t[b]?(t[b]=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.canvasData,r=i.left,o=i.top;return this.moveTo(vt(t)?t:r+Number(t),vt(e)?e:o+Number(e))},moveTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.canvasData,r=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.movable&&(ft(t)&&(i.left=t,r=!0),ft(e)&&(i.top=e,r=!0),r&&this.renderCanvas(!0)),this},zoom:function(t,e){var i=this.canvasData;return t=(t=Number(t))<0?1/(1-t):1+t,this.zoomTo(i.width*t/i.naturalWidth,null,e)},zoomTo:function(t,e,i){var r=this.options,o=this.canvasData,n=o.width,s=o.height,a=o.naturalWidth,c=o.naturalHeight;if((t=Number(t))>=0&&this.ready&&!this.disabled&&r.zoomable){var l=a*t,u=c*t;if(!1===Bt(this.element,ot,{ratio:t,oldRatio:n/a,originalEvent:i}))return this;if(i){var h=this.pointers,p=qt(this.cropper),d=h&&Object.keys(h).length?Jt(h):{pageX:i.pageX,pageY:i.pageY};o.left-=(l-n)*((d.pageX-p.left-o.left)/n),o.top-=(u-s)*((d.pageY-p.top-o.top)/s)}else wt(e)&&ft(e.x)&&ft(e.y)?(o.left-=(l-n)*((e.x-o.left)/n),o.top-=(u-s)*((e.y-o.top)/s)):(o.left-=(l-n)/2,o.top-=(u-s)/2);o.width=l,o.height=u,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return ft(t=Number(t))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var e=this.imageData.scaleY;return this.scale(t,ft(e)?e:1)},scaleY:function(t){var e=this.imageData.scaleX;return this.scale(ft(e)?e:1,t)},scale:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.imageData,r=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.scalable&&(ft(t)&&(i.scaleX=t,r=!0),ft(e)&&(i.scaleY=e,r=!0),r&&this.renderCanvas(!0,!0)),this},getData:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.options,r=this.imageData,o=this.canvasData,n=this.cropBoxData;if(this.ready&&this.cropped){t={x:n.left-o.left,y:n.top-o.top,width:n.width,height:n.height};var s=r.width/r.naturalWidth;if(Rt(t,(function(e,i){t[i]=e/s})),e){var a=Math.round(t.y+t.height),c=Math.round(t.x+t.width);t.x=Math.round(t.x),t.y=Math.round(t.y),t.width=c-t.x,t.height=a-t.y}}else t={x:0,y:0,width:0,height:0};return i.rotatable&&(t.rotate=r.rotate||0),i.scalable&&(t.scaleX=r.scaleX||1,t.scaleY=r.scaleY||1),t},setData:function(t){var e=this.options,i=this.imageData,r=this.canvasData,o={};if(this.ready&&!this.disabled&&wt(t)){var n=!1;e.rotatable&&ft(t.rotate)&&t.rotate!==i.rotate&&(i.rotate=t.rotate,n=!0),e.scalable&&(ft(t.scaleX)&&t.scaleX!==i.scaleX&&(i.scaleX=t.scaleX,n=!0),ft(t.scaleY)&&t.scaleY!==i.scaleY&&(i.scaleY=t.scaleY,n=!0)),n&&this.renderCanvas(!0,!0);var s=i.width/i.naturalWidth;ft(t.x)&&(o.left=t.x*s+r.left),ft(t.y)&&(o.top=t.y*s+r.top),ft(t.width)&&(o.width=t.width*s),ft(t.height)&&(o.height=t.height*s),this.setCropBoxData(o)}return this},getContainerData:function(){return this.ready?kt({},this.containerData):{}},getImageData:function(){return this.sized?kt({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,e={};return this.ready&&Rt(["left","top","width","height","naturalWidth","naturalHeight"],(function(i){e[i]=t[i]})),e},setCanvasData:function(t){var e=this.canvasData,i=e.aspectRatio;return this.ready&&!this.disabled&&wt(t)&&(ft(t.left)&&(e.left=t.left),ft(t.top)&&(e.top=t.top),ft(t.width)?(e.width=t.width,e.height=t.width/i):ft(t.height)&&(e.height=t.height,e.width=t.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var t,e=this.cropBoxData;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(t){var e,i,r=this.cropBoxData,o=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&wt(t)&&(ft(t.left)&&(r.left=t.left),ft(t.top)&&(r.top=t.top),ft(t.width)&&t.width!==r.width&&(e=!0,r.width=t.width),ft(t.height)&&t.height!==r.height&&(i=!0,r.height=t.height),o&&(e?r.height=r.width/o:i&&(r.width=r.height*o)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var e=this.canvasData,i=ee(this.image,this.imageData,e,t);if(!this.cropped)return i;var r=this.getData(t.rounded),o=r.x,n=r.y,s=r.width,a=r.height,c=i.width/Math.floor(e.naturalWidth);1!==c&&(o*=c,n*=c,s*=c,a*=c);var u=s/a,h=Qt({aspectRatio:u,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),p=Qt({aspectRatio:u,width:t.minWidth||0,height:t.minHeight||0},"cover"),d=Qt({aspectRatio:u,width:t.width||(1!==c?i.width:s),height:t.height||(1!==c?i.height:a)}),m=d.width,f=d.height;m=Math.min(h.width,Math.max(p.width,m)),f=Math.min(h.height,Math.max(p.height,f));var g=document.createElement("canvas"),v=g.getContext("2d");g.width=Pt(m),g.height=Pt(f),v.fillStyle=t.fillColor||"transparent",v.fillRect(0,0,m,f);var y=t.imageSmoothingEnabled,b=void 0===y||y,w=t.imageSmoothingQuality;v.imageSmoothingEnabled=b,w&&(v.imageSmoothingQuality=w);var S,x,C,R,k,E,P=i.width,A=i.height,D=o,T=n;D<=-s||D>P?(D=0,S=0,C=0,k=0):D<=0?(C=-D,D=0,k=S=Math.min(P,s+D)):D<=P&&(C=0,k=S=Math.min(s,P-D)),S<=0||T<=-a||T>A?(T=0,x=0,R=0,E=0):T<=0?(R=-T,T=0,E=x=Math.min(A,a+T)):T<=A&&(R=0,E=x=Math.min(a,A-T));var _=[D,T,S,x];if(k>0&&E>0){var U=m/s;_.push(C*U,R*U,k*U,E*U)}return v.drawImage.apply(v,[i].concat(l(_.map((function(t){return Math.floor(Pt(t))}))))),g},setAspectRatio:function(t){var e=this.options;return this.disabled||vt(t)||(e.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var e=this.options,i=this.dragBox,r=this.face;if(this.ready&&!this.disabled){var o=t===Y,n=e.movable&&t===H;t=o||n?t:B,e.dragMode=t,It(i,z,t),Mt(i,U,o),Mt(i,F,n),e.cropBoxMovable||(It(r,z,t),Mt(r,U,o),Mt(r,F,n))}return this}},fe=g.Cropper,ge=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n(this,t),!e||!lt.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=kt({},pt,wt(i)&&i),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return a(t,[{key:"init",value:function(){var t,e=this.element,i=e.tagName.toLowerCase();if(!e[b]){if(e[b]=this,"img"===i){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}},{key:"load",value:function(t){var e=this;if(t){this.url=t,this.imageData={};var i=this.element,r=this.options;if(r.rotatable||r.scalable||(r.checkOrientation=!1),r.checkOrientation&&window.ArrayBuffer)if(at.test(t))ct.test(t)?this.read(ne(t)):this.clone();else{var o=new XMLHttpRequest,n=this.clone.bind(this);this.reloading=!0,this.xhr=o,o.onabort=n,o.onerror=n,o.ontimeout=n,o.onprogress=function(){o.getResponseHeader("content-type")!==nt&&o.abort()},o.onload=function(){e.read(o.response)},o.onloadend=function(){e.reloading=!1,e.xhr=null},r.checkCrossOrigin&&$t(t)&&i.crossOrigin&&(t=Xt(t)),o.open("GET",t,!0),o.responseType="arraybuffer",o.withCredentials="use-credentials"===i.crossOrigin,o.send()}else this.clone()}}},{key:"read",value:function(t){var e=this.options,i=this.imageData,r=ae(t),o=0,n=1,s=1;if(r>1){this.url=se(t,nt);var a=ce(r);o=a.rotate,n=a.scaleX,s=a.scaleY}e.rotatable&&(i.rotate=o),e.scalable&&(i.scaleX=n,i.scaleY=s),this.clone()}},{key:"clone",value:function(){var t=this.element,e=this.url,i=t.crossOrigin,r=e;this.options.checkCrossOrigin&&$t(e)&&(i||(i="anonymous"),r=Xt(e)),this.crossOrigin=i,this.crossOriginUrl=r;var o=document.createElement("img");i&&(o.crossOrigin=i),o.src=r||e,o.alt=t.alt||"The image to crop",this.image=o,o.onload=this.start.bind(this),o.onerror=this.stop.bind(this),_t(o,O),t.parentNode.insertBefore(o,t.nextSibling)}},{key:"start",value:function(){var t=this,e=this.image;e.onload=null,e.onerror=null,this.sizing=!0;var i=g.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(g.navigator.userAgent),r=function(e,i){kt(t.imageData,{naturalWidth:e,naturalHeight:i,aspectRatio:e/i}),t.initialImageData=kt({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(!e.naturalWidth||i){var o=document.createElement("img"),n=document.body||document.documentElement;this.sizingImage=o,o.onload=function(){r(o.width,o.height),i||n.removeChild(o)},o.src=e.src,i||(o.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",n.appendChild(o))}else r(e.naturalWidth,e.naturalHeight)}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var t=this.element,e=this.options,i=this.image,r=t.parentNode,o=document.createElement("div");o.innerHTML=dt;var n=o.querySelector(".".concat(b,"-container")),s=n.querySelector(".".concat(b,"-canvas")),a=n.querySelector(".".concat(b,"-drag-box")),c=n.querySelector(".".concat(b,"-crop-box")),l=c.querySelector(".".concat(b,"-face"));this.container=r,this.cropper=n,this.canvas=s,this.dragBox=a,this.cropBox=c,this.viewBox=n.querySelector(".".concat(b,"-view-box")),this.face=l,s.appendChild(i),_t(t,L),r.insertBefore(n,t.nextSibling),Ut(i,O),this.initPreview(),this.bind(),e.initialAspectRatio=Math.max(0,e.initialAspectRatio)||NaN,e.aspectRatio=Math.max(0,e.aspectRatio)||NaN,e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0,_t(c,L),e.guides||_t(c.getElementsByClassName("".concat(b,"-dashed")),L),e.center||_t(c.getElementsByClassName("".concat(b,"-center")),L),e.background&&_t(n,"".concat(b,"-bg")),e.highlight||_t(l,N),e.cropBoxMovable&&(_t(l,F),It(l,z,w)),e.cropBoxResizable||(_t(c.getElementsByClassName("".concat(b,"-line")),L),_t(c.getElementsByClassName("".concat(b,"-point")),L)),this.render(),this.ready=!0,this.setDragMode(e.dragMode),e.autoCrop&&this.crop(),this.setData(e.data),St(e.ready)&&Ht(t,et,e.ready,{once:!0}),Bt(t,et)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var t=this.cropper.parentNode;t&&t.removeChild(this.cropper),Ut(this.element,L)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=fe,t}},{key:"setDefaults",value:function(t){kt(pt,wt(t)&&t)}}])}();return kt(ge.prototype,le,ue,he,pe,de,me),ge}()},5574:t=>{"use strict";t.exports=o,t.exports.isMobile=o,t.exports.default=o;const e=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,i=/CrOS/,r=/android|ipad|playbook|silk/i;function o(t){t||(t={});let o=t.ua;if(o||"undefined"==typeof navigator||(o=navigator.userAgent),o&&o.headers&&"string"==typeof o.headers["user-agent"]&&(o=o.headers["user-agent"]),"string"!=typeof o)return!1;let n=e.test(o)&&!i.test(o)||!!t.tablet&&r.test(o);return!n&&t.tablet&&t.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==o.indexOf("Macintosh")&&-1!==o.indexOf("Safari")&&(n=!0),n}},10727:()=>{},73992:(t,e)=>{"use strict";var i=Object.prototype.hasOwnProperty;function r(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return null}}function o(t){try{return encodeURIComponent(t)}catch(e){return null}}e.stringify=function(t,e){e=e||"";var r,n,s=[];for(n in"string"!=typeof e&&(e="?"),t)if(i.call(t,n)){if((r=t[n])||null!=r&&!isNaN(r)||(r=""),n=o(n),r=o(r),null===n||null===r)continue;s.push(n+"="+r)}return s.length?e+s.join("&"):""},e.parse=function(t){for(var e,i=/([^=?#&]+)=?([^&]*)/g,o={};e=i.exec(t);){var n=r(e[1]),s=r(e[2]);null===n||null===s||n in o||(o[n]=s)}return o}},92063:t=>{"use strict";t.exports=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}},75617:(t,e,i)=>{t.exports=i(58303)},58303:(t,e,i)=>{var r=i(93961);e.operation=function(t){var i=e.timeouts(t);return new r(i,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},e.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var i in t)e[i]=t[i];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],o=0;o<e.retries;o++)r.push(this.createTimeout(o,e));return t&&t.forever&&!r.length&&r.push(this.createTimeout(o,e)),r.sort((function(t,e){return t-e})),r},e.createTimeout=function(t,e){var i=e.randomize?Math.random()+1:1,r=Math.round(i*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return r=Math.min(r,e.maxTimeout)},e.wrap=function(t,i,r){if(i instanceof Array&&(r=i,i=null),!r)for(var o in r=[],t)"function"==typeof t[o]&&r.push(o);for(var n=0;n<r.length;n++){var s=r[n],a=t[s];t[s]=function(r){var o=e.operation(i),n=Array.prototype.slice.call(arguments,1),s=n.pop();n.push((function(t){o.retry(t)||(t&&(arguments[0]=o.mainError()),s.apply(this,arguments))})),o.attempt((function(){r.apply(t,n)}))}.bind(t,a),t[s].options=i}}},93961:t=>{function e(t,e){"boolean"==typeof e&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}t.exports=e,e.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},e.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},e.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=(new Date).getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var i=this._timeouts.shift();if(void 0===i){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),i=this._cachedTimeouts.slice(-1)}var r=this;return this._timer=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),i),this._options.unref&&this._timer.unref(),!0},e.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var i=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){i._operationTimeoutCb()}),i._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},e.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)},e.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)},e.prototype.start=e.prototype.try,e.prototype.errors=function(){return this._errors},e.prototype.attempts=function(){return this._attempts},e.prototype.mainError=function(){if(0===this._errors.length)return null;for(var t={},e=null,i=0,r=0;r<this._errors.length;r++){var o=this._errors[r],n=o.message,s=(t[n]||0)+1;t[n]=s,s>=i&&(e=o,i=s)}return e}},61160:(t,e,i)=>{"use strict";var r=i(92063),o=i(73992),n=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,s=/[\n\r\t]/g,a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/:\d+$/,l=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,u=/^[a-zA-Z]:/;function h(t){return(t||"").toString().replace(n,"")}var p=[["#","hash"],["?","query"],function(t,e){return f(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};function m(t){var e,r=("undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{}).location||{},o={},n=typeof(t=t||r);if("blob:"===t.protocol)o=new v(unescape(t.pathname),{});else if("string"===n)for(e in o=new v(t,{}),d)delete o[e];else if("object"===n){for(e in t)e in d||(o[e]=t[e]);void 0===o.slashes&&(o.slashes=a.test(t.href))}return o}function f(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function g(t,e){t=(t=h(t)).replace(s,""),e=e||{};var i,r=l.exec(t),o=r[1]?r[1].toLowerCase():"",n=!!r[2],a=!!r[3],c=0;return n?a?(i=r[2]+r[3]+r[4],c=r[2].length+r[3].length):(i=r[2]+r[4],c=r[2].length):a?(i=r[3]+r[4],c=r[3].length):i=r[4],"file:"===o?c>=2&&(i=i.slice(2)):f(o)?i=r[4]:o?n&&(i=i.slice(2)):c>=2&&f(e.protocol)&&(i=r[4]),{protocol:o,slashes:n||f(o),slashesCount:c,rest:i}}function v(t,e,i){if(t=(t=h(t)).replace(s,""),!(this instanceof v))return new v(t,e,i);var n,a,c,l,d,y,b=p.slice(),w=typeof e,S=this,x=0;for("object"!==w&&"string"!==w&&(i=e,e=null),i&&"function"!=typeof i&&(i=o.parse),n=!(a=g(t||"",e=m(e))).protocol&&!a.slashes,S.slashes=a.slashes||n&&e.slashes,S.protocol=a.protocol||e.protocol||"",t=a.rest,("file:"===a.protocol&&(2!==a.slashesCount||u.test(t))||!a.slashes&&(a.protocol||a.slashesCount<2||!f(S.protocol)))&&(b[3]=[/(.*)/,"pathname"]);x<b.length;x++)"function"!=typeof(l=b[x])?(c=l[0],y=l[1],c!=c?S[y]=t:"string"==typeof c?~(d="@"===c?t.lastIndexOf(c):t.indexOf(c))&&("number"==typeof l[2]?(S[y]=t.slice(0,d),t=t.slice(d+l[2])):(S[y]=t.slice(d),t=t.slice(0,d))):(d=c.exec(t))&&(S[y]=d[1],t=t.slice(0,d.index)),S[y]=S[y]||n&&l[3]&&e[y]||"",l[4]&&(S[y]=S[y].toLowerCase())):t=l(t,S);i&&(S.query=i(S.query)),n&&e.slashes&&"/"!==S.pathname.charAt(0)&&(""!==S.pathname||""!==e.pathname)&&(S.pathname=function(t,e){if(""===t)return e;for(var i=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=i.length,o=i[r-1],n=!1,s=0;r--;)"."===i[r]?i.splice(r,1):".."===i[r]?(i.splice(r,1),s++):s&&(0===r&&(n=!0),i.splice(r,1),s--);return n&&i.unshift(""),"."!==o&&".."!==o||i.push(""),i.join("/")}(S.pathname,e.pathname)),"/"!==S.pathname.charAt(0)&&f(S.protocol)&&(S.pathname="/"+S.pathname),r(S.port,S.protocol)||(S.host=S.hostname,S.port=""),S.username=S.password="",S.auth&&(~(d=S.auth.indexOf(":"))?(S.username=S.auth.slice(0,d),S.username=encodeURIComponent(decodeURIComponent(S.username)),S.password=S.auth.slice(d+1),S.password=encodeURIComponent(decodeURIComponent(S.password))):S.username=encodeURIComponent(decodeURIComponent(S.auth)),S.auth=S.password?S.username+":"+S.password:S.username),S.origin="file:"!==S.protocol&&f(S.protocol)&&S.host?S.protocol+"//"+S.host:"null",S.href=S.toString()}v.prototype={set:function(t,e,i){var n=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(i||o.parse)(e)),n[t]=e;break;case"port":n[t]=e,r(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[t]="");break;case"hostname":n[t]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[t]=e,c.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!i;break;case"pathname":case"hash":if(e){var s="pathname"===t?"/":"#";n[t]=e.charAt(0)!==s?s+e:e}else n[t]=e;break;case"username":case"password":n[t]=encodeURIComponent(e);break;case"auth":var a=e.indexOf(":");~a?(n.username=e.slice(0,a),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(a+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var l=0;l<p.length;l++){var u=p[l];u[4]&&(n[u[1]]=n[u[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin="file:"!==n.protocol&&f(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n},toString:function(t){t&&"function"==typeof t||(t=o.stringify);var e,i=this,r=i.host,n=i.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var s=n+(i.protocol&&i.slashes||f(i.protocol)?"//":"");return i.username?(s+=i.username,i.password&&(s+=":"+i.password),s+="@"):i.password?(s+=":"+i.password,s+="@"):"file:"!==i.protocol&&f(i.protocol)&&!r&&"/"!==i.pathname&&(s+="@"),(":"===r[r.length-1]||c.test(i.hostname)&&!i.port)&&(r+=":"),s+=r+i.pathname,(e="object"==typeof i.query?t(i.query):i.query)&&(s+="?"!==e.charAt(0)?"?"+e:e),i.hash&&(s+=i.hash),s}},v.extractProtocol=g,v.location=m,v.trimLeft=h,v.qs=o,t.exports=v},4430:(t,e,i)=>{"use strict";i.d(e,{A:()=>b});var r=i(10201),o=i(31837),n=i(79885);i(50172);const s="2.2.2",a={strings:{pluginNameAudio:"Audio",startAudioRecording:"Begin audio recording",stopAudioRecording:"Stop audio recording",allowAudioAccessTitle:"Please allow access to your microphone",allowAudioAccessDescription:"In order to record audio, please allow microphone access for this site.",noAudioTitle:"Microphone Not Available",noAudioDescription:"In order to record audio, please connect a microphone or another audio input device",recordingStoppedMaxSize:"Recording stopped because the file size is about to exceed the limit",recordingLength:"Recording length %{recording_length}",submitRecordedFile:"Submit recorded file",discardRecordedFile:"Discard recorded file"}},c=t=>{const{icon:e,hasAudio:i,i18n:o}=t;return(0,r.FD)("div",{className:"uppy-Audio-permissons",children:[(0,r.Y)("div",{className:"uppy-Audio-permissonsIcon",children:e()}),(0,r.Y)("div",{className:"uppy-Audio-title",children:o(i?"allowAudioAccessTitle":"noAudioTitle")}),(0,r.Y)("p",{children:o(i?"allowAudioAccessDescription":"noAudioDescription")})]})};var l=i(45994);const u=({currentDeviceId:t,audioSources:e,onChangeSource:i})=>(0,r.Y)("div",{className:"uppy-Audio-videoSource",children:(0,r.Y)("select",{className:"uppy-u-reset uppy-Audio-audioSource-select",onChange:t=>{i(t.target.value)},children:e.map((e=>(0,r.Y)("option",{value:e.deviceId,selected:e.deviceId===t,children:e.label},e.deviceId)))})});function h(t){return"function"==typeof t}function p(t){return h(t)?t():t}class d{canvas;canvasContext;width;height;analyser;bufferLength;dataArray;onDrawFrame;streamSource;audioContext;source;constructor(t,e={}){const i=e.canvas||{},r=e.canvasContext||{};this.analyser=null,this.bufferLength=0,this.canvas=t,this.width=p(i.width)||this.canvas.width,this.height=p(i.height)||this.canvas.height,this.canvas.width=this.width,this.canvas.height=this.height,this.canvasContext=this.canvas.getContext("2d"),this.canvasContext.fillStyle=p(r.fillStyle)||"rgb(255, 255, 255)",this.canvasContext.strokeStyle=p(r.strokeStyle)||"rgb(0, 0, 0)",this.canvasContext.lineWidth=p(r.lineWidth)||1,this.onDrawFrame=h(e.onDrawFrame)?e.onDrawFrame:()=>{}}addSource(t){this.streamSource=t,this.audioContext=this.streamSource.context,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.bufferLength=this.analyser.frequencyBinCount,this.source=this.audioContext.createBufferSource(),this.dataArray=new Uint8Array(this.bufferLength),this.analyser.getByteTimeDomainData(this.dataArray),this.streamSource.connect(this.analyser)}draw(){const{analyser:t,dataArray:e,bufferLength:i}=this,r=this.canvasContext,o=this.width,n=this.height;t&&t.getByteTimeDomainData(e),r.fillRect(0,0,o,n),r.beginPath();const s=1*o/i;let a=0;i||r.moveTo(0,this.height/2);for(let c=0;c<i;c++){const t=e[c]/128*(n/2);0===c?r.moveTo(a,t):r.lineTo(a,t),a+=s}r.lineTo(o,n/2),r.stroke(),this.onDrawFrame(this),requestAnimationFrame(this.#t)}#t=()=>this.draw()}const m=function({onDiscard:t,i18n:e}){return(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-Audio-button",type:"button",title:e("discardRecordedFile"),"aria-label":e("discardRecordedFile"),onClick:t,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{width:"13",height:"13",viewBox:"0 0 13 13",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",className:"uppy-c-icon",children:(0,r.FD)("g",{fill:"#FFF",fillRule:"evenodd",children:[(0,r.Y)("path",{d:"M.496 11.367L11.103.76l1.414 1.414L1.911 12.781z"}),(0,r.Y)("path",{d:"M11.104 12.782L.497 2.175 1.911.76l10.607 10.606z"})]})})})};function f({recording:t,onStartRecording:e,onStopRecording:i,i18n:o}){return t?(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-Audio-button",type:"button",title:o("stopAudioRecording"),"aria-label":o("stopAudioRecording"),onClick:i,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100",children:(0,r.Y)("rect",{x:"15",y:"15",width:"70",height:"70"})})}):(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-Audio-button",type:"button",title:o("startAudioRecording"),"aria-label":o("startAudioRecording"),onClick:e,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14px",height:"20px",viewBox:"0 0 14 20",children:(0,r.Y)("path",{d:"M7 14c2.21 0 4-1.71 4-3.818V3.818C11 1.71 9.21 0 7 0S3 1.71 3 3.818v6.364C3 12.29 4.79 14 7 14zm6.364-7h-.637a.643.643 0 0 0-.636.65V9.6c0 3.039-2.565 5.477-5.6 5.175-2.645-.264-4.582-2.692-4.582-5.407V7.65c0-.36-.285-.65-.636-.65H.636A.643.643 0 0 0 0 7.65v1.631c0 3.642 2.544 6.888 6.045 7.382v1.387H3.818a.643.643 0 0 0-.636.65v.65c0 .36.285.65.636.65h6.364c.351 0 .636-.29.636-.65v-.65c0-.36-.285-.65-.636-.65H7.955v-1.372C11.363 16.2 14 13.212 14 9.6V7.65c0-.36-.285-.65-.636-.65z",fill:"#FFF","fill-rule":"nonzero"})})})}function g({recordingLengthSeconds:t}){const e=(i=t,`${Math.floor(i/60)}:${String(i%60).padStart(2,"0")}`);var i;return(0,r.Y)("span",{children:e})}const v=function({onSubmit:t,i18n:e}){return(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-Audio-button uppy-Audio-button--submit",type:"button",title:e("submitRecordedFile"),"aria-label":e("submitRecordedFile"),onClick:t,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{width:"12",height:"9",viewBox:"0 0 12 9",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon",children:(0,r.Y)("path",{fill:"#fff",fillRule:"nonzero",d:"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z"})})})};function y(t){const{stream:e,recordedAudio:i,onStop:o,recording:n,supportsRecording:s,audioSources:a,showAudioSourceDropdown:c,onSubmit:h,i18n:p,onStartRecording:y,onStopRecording:b,onDiscardRecordedAudio:w,recordingLengthSeconds:S}=t,x=(0,l.li)(null),C=(0,l.li)();(0,l.vJ)((()=>()=>{C.current=null,o()}),[o]),(0,l.vJ)((()=>{if(!i&&(C.current=new d(x.current,{canvas:{width:600,height:600},canvasContext:{lineWidth:2,fillStyle:"rgb(0,0,0)",strokeStyle:"green"}}),C.current.draw(),e)){const t=(new AudioContext).createMediaStreamSource(e);C.current.addSource(t)}}),[i,e]);const R=null!=i,k=!R&&s,E=c&&!R&&a&&a.length>1;return(0,r.FD)("div",{className:"uppy-Audio-container",children:[(0,r.Y)("div",{className:"uppy-Audio-audioContainer",children:R?(0,r.Y)("audio",{className:"uppy-Audio-player",controls:!0,src:i}):(0,r.Y)("canvas",{ref:x,className:"uppy-Audio-canvas"})}),(0,r.FD)("div",{className:"uppy-Audio-footer",children:[(0,r.Y)("div",{className:"uppy-Audio-audioSourceContainer",children:E?u(t):null}),(0,r.FD)("div",{className:"uppy-Audio-buttonContainer",children:[k&&(0,r.Y)(f,{recording:n,onStartRecording:y,onStopRecording:b,i18n:p}),R&&(0,r.Y)(v,{onSubmit:h,i18n:p}),R&&(0,r.Y)(m,{onDiscard:w,i18n:p})]}),(0,r.Y)("div",{className:"uppy-Audio-recordingLength",children:!R&&(0,r.Y)(g,{recordingLengthSeconds:S})})]})]})}class b extends o.A{static VERSION=s;#e;icon;#i=null;#r=!1;#o=null;#n=null;#s=null;#a;#c;constructor(t,e){super(t,e),this.#a=navigator.mediaDevices,this.#c=null!=this.#a,this.id=this.opts.id||"Audio",this.type="acquirer",this.icon=()=>(0,r.Y)("svg",{className:"uppy-DashboardTab-iconAudio","aria-hidden":"true",focusable:"false",width:"32px",height:"32px",viewBox:"0 0 32 32",children:(0,r.Y)("path",{d:"M21.143 12.297c.473 0 .857.383.857.857v2.572c0 3.016-2.24 5.513-5.143 5.931v2.64h2.572a.857.857 0 110 1.714H12.57a.857.857 0 110-1.714h2.572v-2.64C12.24 21.24 10 18.742 10 15.726v-2.572a.857.857 0 111.714 0v2.572A4.29 4.29 0 0016 20.01a4.29 4.29 0 004.286-4.285v-2.572c0-.474.384-.857.857-.857zM16 6.5a3 3 0 013 3v6a3 3 0 01-6 0v-6a3 3 0 013-3z",fill:"currentcolor","fill-rule":"nonzero"})}),this.defaultLocale=a,this.opts={...e},this.i18nInit(),this.title=this.i18n("pluginNameAudio"),this.setPluginState({hasAudio:!1,audioReady:!1,cameraError:null,recordingLengthSeconds:0,audioSources:[],currentDeviceId:null})}#l(){return this.#a?this.#a.enumerateDevices().then((t=>t.some((t=>"audioinput"===t.kind)))):Promise.resolve(!1)}#u=t=>{if(!this.#c)return Promise.reject(new Error("Microphone access not supported"));this.#r=!0,this.#l().then((e=>(this.setPluginState({hasAudio:e}),this.#a.getUserMedia({audio:!0}).then((e=>{this.#i=e;let i=null;const r=e.getAudioTracks();i=t?.deviceId?r.findLast((e=>e.getSettings().deviceId===t.deviceId)):r[0].getSettings().deviceId,this.#h(),this.setPluginState({currentDeviceId:i,audioReady:!0})})).catch((t=>{this.setPluginState({audioReady:!1,cameraError:t}),this.uppy.info(t.message,"error")})))))};#p=()=>{this.#n=new MediaRecorder(this.#i),this.#o=[];let t=!1;this.#n.addEventListener("dataavailable",(e=>{this.#o.push(e.data);const{restrictions:i}=this.uppy.opts;if(this.#o.length>1&&null!=i.maxFileSize&&!t){const e=this.#o.reduce(((t,e)=>t+e.size),0),r=3*((e-this.#o[0].size)/(this.#o.length-1));e>Math.max(0,i.maxFileSize-r)&&(t=!0,this.uppy.info(this.i18n("recordingStoppedMaxSize"),"warning",4e3),this.#d())}})),this.#n.start(500),this.#e=setInterval((()=>{const t=this.getPluginState().recordingLengthSeconds;this.setPluginState({recordingLengthSeconds:t+1})}),1e3),this.setPluginState({isRecording:!0})};#d=()=>new Promise((t=>{this.#n.addEventListener("stop",(()=>{t()})),this.#n.stop(),clearInterval(this.#e),this.setPluginState({recordingLengthSeconds:0})})).then((()=>(this.setPluginState({isRecording:!1}),this.#m()))).then((t=>{try{this.#s=t,this.setPluginState({recordedAudio:URL.createObjectURL(t.data)})}catch(e){e.isRestriction||this.uppy.log(e)}})).then((()=>{this.#o=null,this.#n=null}),(t=>{throw this.#o=null,this.#n=null,t}));#f=()=>{this.setPluginState({recordedAudio:null}),this.#s=null};#g=()=>{try{this.#s&&this.uppy.addFile(this.#s)}catch(t){t.isRestriction||this.uppy.log(t,"warning")}};#v=async()=>{if(this.#i){this.#i.getAudioTracks().forEach((t=>t.stop()))}this.#n&&await new Promise((t=>{this.#n.addEventListener("stop",t,{once:!0}),this.#n.stop(),clearInterval(this.#e)})),this.#o=null,this.#n=null,this.#r=!1,this.#i=null,this.setPluginState({recordedAudio:null,isRecording:!1,recordingLengthSeconds:0})};#m(){const t=this.#o.find((t=>t.type?.length>0)).type,e=(0,n.A)(t);if(!e)return Promise.reject(new Error(`Could not retrieve recording: Unsupported media type "${t}"`));const i=`audio-${Date.now()}.${e}`,r=new Blob(this.#o,{type:t}),o={source:this.id,name:i,data:new Blob([r],{type:t}),type:t};return Promise.resolve(o)}#y=t=>{this.#v(),this.#u({deviceId:t})};#h=()=>{this.#a.enumerateDevices().then((t=>{this.setPluginState({audioSources:t.filter((t=>"audioinput"===t.kind))})}))};render(){this.#r||this.#u();const t=this.getPluginState();return t.audioReady&&t.hasAudio?(0,r.Y)(y,{...t,onChangeSource:this.#y,onStartRecording:this.#p,onStopRecording:this.#d,onDiscardRecordedAudio:this.#f,onSubmit:this.#g,onStop:this.#v,i18n:this.i18n,showAudioSourceDropdown:this.opts.showAudioSourceDropdown,supportsRecording:"function"==typeof MediaRecorder&&"function"==typeof MediaRecorder.prototype?.start,recording:t.isRecording,stream:this.#i}):(0,r.Y)(c,{icon:this.icon,i18n:this.i18n,hasAudio:t.hasAudio})}install(){this.setPluginState({audioReady:!1,recordingLengthSeconds:0});const{target:t}=this.opts;t&&this.mount(t,this),this.#a&&(this.#h(),this.#a.ondevicechange=()=>{if(this.#h(),this.#i){let t=!0;const{audioSources:e,currentDeviceId:i}=this.getPluginState();e.forEach((e=>{i===e.deviceId&&(t=!1)})),t&&(this.#v(),this.#u())}})}uninstall(){this.#i&&this.#v(),this.unmount()}}},91307:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(10201),o=i(5666),n=i(31837),s=i(3103);i(50172);const a="3.3.2",c={strings:{pluginNameBox:"Box"}};class l extends n.A{static VERSION=a;icon;provider;view;storage;files;rootFolderId=null;constructor(t,e){super(t,e),this.id=this.opts.id||"Box",this.type="acquirer",this.storage=this.opts.storage||o.HM,this.files=[],this.icon=()=>(0,r.Y)("svg",{className:"uppy-DashboardTab-iconBox","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:(0,r.FD)("g",{fill:"currentcolor",fillRule:"nonzero",children:[(0,r.Y)("path",{d:"m16.4 13.5c-1.6 0-3 0.9-3.7 2.2-0.7-1.3-2.1-2.2-3.7-2.2-1 0-1.8 0.3-2.5 0.8v-3.6c-0.1-0.3-0.5-0.7-1-0.7s-0.8 0.4-0.8 0.8v7c0 2.3 1.9 4.2 4.2 4.2 1.6 0 3-0.9 3.7-2.2 0.7 1.3 2.1 2.2 3.7 2.2 2.3 0 4.2-1.9 4.2-4.2 0.1-2.4-1.8-4.3-4.1-4.3m-7.5 6.8c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5m7.5 0c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5"}),(0,r.Y)("path",{d:"m27.2 20.6l-2.3-2.8 2.3-2.8c0.3-0.4 0.2-0.9-0.2-1.2s-1-0.2-1.3 0.2l-2 2.4-2-2.4c-0.3-0.4-0.9-0.4-1.3-0.2-0.4 0.3-0.5 0.8-0.2 1.2l2.3 2.8-2.3 2.8c-0.3 0.4-0.2 0.9 0.2 1.2s1 0.2 1.3-0.2l2-2.4 2 2.4c0.3 0.4 0.9 0.4 1.3 0.2 0.4-0.3 0.4-0.8 0.2-1.2"})]})}),this.opts.companionAllowedHosts=(0,o.cP)(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new o.Kq(t,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"box",pluginId:this.id,supportsRefreshToken:!1}),this.defaultLocale=c,this.i18nInit(),this.title=this.i18n("pluginNameBox"),this.render=this.render.bind(this)}install(){this.view=new s.gi(this,{provider:this.provider,loadAllFiles:!0,virtualList:!0});const{target:t}=this.opts;t&&this.mount(t,this)}uninstall(){this.view.tearDown(),this.unmount()}render(t){return this.view.render(t)}}},5666:(t,e,i)=>{"use strict";i.d(e,{Kq:()=>R,R0:()=>C,YL:()=>k,cP:()=>n,HM:()=>r});var r={};function o(t){return"string"==typeof t?new RegExp(`^${t}$`):t instanceof RegExp?t:void 0}function n(t,e){if(t){const e=t=>{if(!("string"==typeof t&&o(t)||t instanceof RegExp))throw new TypeError('The option "companionAllowedHosts" must be one of string, Array, RegExp')};return Array.isArray(t)?t.every(e):e(t),t}let i=e;return/^(?!https?:\/\/).*$/i.test(i)&&(i=`https://${e.replace(/^\/\//,"")}`),i=new URL(i).origin,i=i.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),i}i.r(r),i.d(r,{getItem:()=>P,removeItem:()=>A,setItem:()=>E});var s=i(61825);class a extends Error{isNetworkError;cause;constructor(t,e){super(t),this.cause=e?.cause,this.cause&&(0,s.A)(this.cause,"isNetworkError")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}}const c=a;var l=i(52094);class u extends Error{name="UserFacingApiError"}const h=u;var p=i(75617);const d=Object.prototype.toString,m=t=>"[object Error]"===d.call(t),f=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);class g extends Error{constructor(t){super(),t instanceof Error?(this.originalError=t,({message:t}=t)):(this.originalError=new Error(t),this.originalError.stack=this.stack),this.name="AbortError",this.message=t}}const v=(t,e,i)=>{const r=i.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=r,t};async function y(t,e){return new Promise(((i,r)=>{e={onFailedAttempt(){},retries:10,shouldRetry:()=>!0,...e};const o=p.operation(e),n=()=>{o.stop(),r(e.signal?.reason)};e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",n,{once:!0});const s=()=>{e.signal?.removeEventListener("abort",n),o.stop()};o.attempt((async n=>{try{const e=await t(n);s(),i(e)}catch(a){try{if(!(a instanceof Error))throw new TypeError(`Non-error was thrown: "${a}". You should only throw errors.`);if(a instanceof g)throw a.originalError;if(a instanceof TypeError&&!function(t){return!(!t||!m(t)||"TypeError"!==t.name||"string"!=typeof t.message)&&("Load failed"===t.message?void 0===t.stack:f.has(t.message))}(a))throw a;if(v(a,n,e),await e.shouldRetry(a)||(o.stop(),r(a)),await e.onFailedAttempt(a),!o.retry(a))throw o.mainError()}catch(c){v(c,n,e),s(),r(c)}}}))}))}const b="4.5.2";class w extends Error{isAuthError;constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}}const S=w;class x extends Error{statusCode;constructor({statusCode:t,message:e}){super(e),this.name="HttpError",this.statusCode=t}}class C{static VERSION=b;#b;uppy;opts;constructor(t,e){this.uppy=t,this.opts=e,this.onReceiveResponse=this.onReceiveResponse.bind(this),this.#b=e.companionHeaders}setCompanionHeaders(t){this.#b=t}[Symbol.for("uppy test: getCompanionHeaders")](){return this.#b}get hostname(){const{companion:t}=this.uppy.getState(),e=this.opts.companionUrl;return(t?.[e]?t[e]:e).replace(/\/$/,"")}async headers(t=!1){return{...{Accept:"application/json",...t?void 0:{"Content-Type":"application/json"}},...this.#b}}onReceiveResponse(t){const{headers:e}=t,i=this.uppy.getState().companion||{},r=this.opts.companionUrl;e.has("i-am")&&e.get("i-am")!==i[r]&&this.uppy.setState({companion:{...i,[r]:e.get("i-am")}})}#w(t){return/^(https?:|)\/\//.test(t)?t:`${this.hostname}/${t}`}async request({path:t,method:e="GET",data:i,skipPostResponse:r,signal:o}){try{const n=await this.headers(!i),s=await function(...t){return fetch(...t).catch((t=>{throw"AbortError"===t.name?t:new l.A(t)}))}(this.#w(t),{method:e,signal:o,headers:n,credentials:this.opts.companionCookiesRule||"same-origin",body:i?JSON.stringify(i):null});return r||this.onReceiveResponse(s),await async function(t){if(401===t.status)throw new S;if(t.ok)return t.json();let e,i=`Failed request with status: ${t.status}. ${t.statusText}`;try{e=await t.json(),e.message&&(i=`${i} message: ${e.message}`),e.requestId&&(i=`${i} request-Id: ${e.requestId}`)}catch(r){throw new Error(i,{cause:r})}if(t.status>=400&&t.status<=499&&e.message)throw new h(e.message);throw new x({statusCode:t.status,message:i})}(s)}catch(n){if(n.isAuthError||"UserFacingApiError"===n.name||"AbortError"===n.name)throw n;throw new c(`Could not ${e} ${this.#w(t)}`,{cause:n})}}async get(t,e){return this.request({...e,path:t})}async post(t,e,i){return this.request({...i,path:t,method:"POST",data:e})}async delete(t,e,i){return this.request({...i,path:t,method:"DELETE",data:e})}async uploadRemoteFile(t,e,i){try{const{signal:r,getQueue:o}=i||{};return await y((async()=>{const i=this.uppy.getFile(t.id)?.serverToken;if(null!=i)return this.uppy.log(`Connecting to exiting websocket ${i}`),this.#S({file:t,queue:o(),signal:r});const n=o().wrapPromiseFunction((async(...t)=>{try{return await this.#x(...t)}catch(e){if(e.isAuthError)throw new g(e);if(null==e.cause)throw e;const t=e.cause,i=()=>[408,409,429,418,423].includes(t.statusCode)||t.statusCode>=500&&t.statusCode<=599&&![501,505].includes(t.statusCode);if("HttpError"===t.name&&!i())throw new g(t);throw t}}),{priority:-1}),s=await n({file:t,postBody:e,signal:r}).abortOn(r);return this.uppy.getFile(t.id)?(this.uppy.setFileState(t.id,{serverToken:s}),this.#S({file:this.uppy.getFile(t.id),queue:o(),signal:r})):void 0}),{retries:10,signal:r,onFailedAttempt:t=>this.uppy.log(`Retrying upload due to: ${t.message}`,"warning")})}catch(r){if("AbortError"===r.name)return;throw this.uppy.emit("upload-error",t,r),r}}#x=async({file:t,postBody:e,signal:i})=>{if(null==t.remote?.url)throw new Error("Cannot connect to an undefined URL");return(await this.post(t.remote.url,{...t.remote.body,...e},{signal:i})).token};async#S({file:t,queue:e,signal:i}){let r;const{capabilities:o}=this.uppy.getState();try{return await new Promise(((n,s)=>{const a=t.serverToken,c=function(t){const e=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?([^\n]+)/i.exec(t)?.[1];return`${/^http:\/\//i.test(t)?"ws":"wss"}://${e}`}(t.remote.companionUrl);let l,u,h,{isPaused:p}=t;const d=(e,i)=>{null!=l&&l.readyState===l.OPEN?l.send(JSON.stringify({action:e,payload:i??{}})):this.uppy.log(`Cannot send "${e}" to socket ${t.id} because the socket state was ${String(l?.readyState)}`,"warning")};function m(){o.resumableUploads&&d(p?"pause":"resume")}const f=t=>{o.resumableUploads&&(p=t,l&&m())},g=e=>{o.individualCancellation&&e.id===t.id&&(d("cancel"),u?.abort?.(),this.uppy.log(`upload ${t.id} was removed`),n())},v=()=>{d("cancel"),u?.abort?.(),this.uppy.log(`upload ${t.id} was canceled`),n()},b=(e,i)=>{e?.id===t.id&&f(i)},w=()=>f(!0),S=()=>f(!1);this.uppy.on("file-removed",g),this.uppy.on("cancel-all",v),this.uppy.on("upload-pause",b),this.uppy.on("pause-all",w),this.uppy.on("resume-all",S),r=()=>{this.uppy.off("file-removed",g),this.uppy.off("cancel-all",v),this.uppy.off("upload-pause",b),this.uppy.off("pause-all",w),this.uppy.off("resume-all",S)},i.addEventListener("abort",(()=>{u?.abort()})),(async()=>{u&&u.abort(),u=new AbortController;const i=e=>{this.uppy.setFileState(t.id,{serverToken:null}),u?.abort?.(),s(e)};function r(){clearTimeout(h),p||(h=setTimeout((()=>i(new Error("Timeout waiting for message from Companion socket"))),3e5))}try{await e.wrapPromiseFunction((async()=>{await y((async()=>new Promise(((e,o)=>{l=new WebSocket(`${c}/api/${a}`),r(),l.addEventListener("close",(()=>{l=void 0,o(new Error("Socket closed unexpectedly"))})),l.addEventListener("error",(t=>{this.uppy.log(`Companion socket error ${JSON.stringify(t)}, closing socket`,"warning"),l?.close()})),l.addEventListener("open",(()=>{m()})),l.addEventListener("message",(e=>{r();try{const{action:i,payload:r}=JSON.parse(e.data);switch(i){case"progress":!function(t,e,i){const{progress:r,bytesUploaded:o,bytesTotal:n}=e;r&&(t.uppy.log(`Upload progress: ${r}`),t.uppy.emit("upload-progress",i,{uploadStarted:i.progress.uploadStarted??0,bytesUploaded:o,bytesTotal:n}))}(this,r,this.uppy.getFile(t.id));break;case"success":{const e=r.response?.responseText;this.uppy.emit("upload-success",this.uppy.getFile(t.id),{uploadURL:r.url,status:r.response?.status??200,body:e?JSON.parse(e):void 0}),u?.abort?.(),n();break}case"error":{const{message:t}=r.error;throw Object.assign(new Error(t),{cause:r.error})}default:this.uppy.log(`Companion socket unknown action ${i}`,"warning")}}catch(o){i(o)}}));const s=()=>{this.uppy.log(`Closing socket ${t.id}`),clearTimeout(h),l&&l.close(),l=void 0};u.signal.addEventListener("abort",(()=>{s()}))}))),{retries:10,signal:u.signal,onFailedAttempt:()=>{u.signal.aborted||this.uppy.log(`Retrying websocket ${t.id}`)}})}))().abortOn(u.signal)}catch(o){if(u.signal.aborted)return;i(o)}})()}))}finally{r?.()}}}class R extends C{#C;provider;id;name;pluginId;tokenKey;companionKeysParams;preAuthToken;supportsRefreshToken;constructor(t,e){super(t,e),this.provider=e.provider,this.id=this.provider,this.name=this.opts.name||this.id.split("-").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(" "),this.pluginId=this.opts.pluginId,this.tokenKey=`companion-${this.pluginId}-auth-token`,this.companionKeysParams=this.opts.companionKeysParams,this.preAuthToken=null,this.supportsRefreshToken=!!e.supportsRefreshToken}async headers(){const[t,e]=await Promise.all([super.headers(),this.#R()]),i={};return e&&(i["uppy-auth-token"]=e),this.companionKeysParams&&(i["uppy-credentials-params"]=btoa(JSON.stringify({params:this.companionKeysParams}))),{...t,...i}}onReceiveResponse(t){super.onReceiveResponse(t);const e=this.#k(),i=e.getPluginState().authenticated?401!==t.status:t.status<400;return e.setPluginState({authenticated:i}),t}async setAuthToken(t){return this.#k().storage.setItem(this.tokenKey,t)}async#R(){return this.#k().storage.getItem(this.tokenKey)}async removeAuthToken(){return this.#k().storage.removeItem(this.tokenKey)}#k(){const t=this.uppy.getPlugin(this.pluginId);if(null==t)throw new Error("Plugin was nullish");return t}async ensurePreAuth(){if(this.companionKeysParams&&!this.preAuthToken&&(await this.fetchPreAuthToken(),!this.preAuthToken))throw new Error("Could not load authentication data required for third-party login. Please try again later.")}authQuery(t){return{}}authUrl({authFormData:t,query:e}){const i=new URLSearchParams({...e,state:btoa(JSON.stringify({origin:location.origin})),...this.authQuery({authFormData:t})});return this.preAuthToken&&i.set("uppyPreAuthToken",this.preAuthToken),`${this.hostname}/${this.id}/connect?${i}`}async loginSimpleAuth({uppyVersions:t,authFormData:e,signal:i}){const r=await this.post(`${this.id}/simple-auth`,{form:e},{qs:{uppyVersions:t},signal:i});this.setAuthToken(r.uppyAuthToken)}async loginOAuth({uppyVersions:t,authFormData:e,signal:i}){await this.ensurePreAuth(),i.throwIfAborted();const r=this.authUrl({query:{uppyVersions:t},authFormData:e}),n=window.open(r,"_blank");let s,a;try{return await new Promise(((t,e)=>{a=i=>{if(i.source!==n){let t="";try{t=JSON.stringify(i.data)}catch(l){}return void this.uppy.log(`ignoring event from unknown source ${t}`,"warning")}const{companionAllowedHosts:r}=this.#k().opts;if(s=i.origin,a=r,!(Array.isArray(a)?a.map(o):[o(a)]).some((t=>t?.test(s)||t?.test(`${s}/`))))return void this.uppy.log(`ignoring event from ${i.origin} vs allowed pattern ${r}`,"warning");var s,a;const c="string"==typeof i.data?JSON.parse(i.data):i.data;if(c.error){const{uppy:t}=this,i=t.i18n("authAborted");return t.info({message:i},"warning",5e3),void e(new Error("auth aborted"))}c.token?t(this.setAuthToken(c.token)):e(new Error("did not receive token from auth window"))},n&&(s=window.setInterval((()=>{n.closed&&e(new Error("Auth window was closed by the user"))}),500)),i.addEventListener("abort",(()=>e(new Error("Aborted")))),window.addEventListener("message",a)}))}finally{n?.close(),window.clearInterval(s),a&&window.removeEventListener("message",a)}}async login({uppyVersions:t,authFormData:e,signal:i}){return this.loginOAuth({uppyVersions:t,authFormData:e,signal:i})}refreshTokenUrl(){return`${this.hostname}/${this.id}/refresh-token`}fileUrl(t){return`${this.hostname}/${this.id}/get/${t}`}async request(...t){await this.#C;try{return await super.request(...t)}catch(e){if(!this.supportsRefreshToken)throw e;const i=await this.#R();if(!e.isAuthError||!i)throw e;return null==this.#C&&(this.#C=(async()=>{try{this.uppy.log("[CompanionClient] Refreshing expired auth token");const t=await super.request({path:this.refreshTokenUrl(),method:"POST"});await this.setAuthToken(t.uppyAuthToken)}catch(t){throw t.isAuthError&&await this.removeAuthToken(),e}finally{this.#C=void 0}})()),await this.#C,super.request(...t)}}async fetchPreAuthToken(){if(this.companionKeysParams)try{const t=await this.post(`${this.id}/preauth/`,{params:this.companionKeysParams});this.preAuthToken=t.token}catch(t){this.uppy.log(`[CompanionClient] unable to fetch preAuthToken ${t}`,"warning")}}list(t,e){return this.get(`${this.id}/list/${t||""}`,e)}async logout(t){const e=await this.get(`${this.id}/logout`,t);return await this.removeAuthToken(),e}}class k extends C{provider;id;name;pluginId;constructor(t,e){super(t,e),this.provider=e.provider,this.id=this.provider,this.name=this.opts.name||this.id.split("-").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(" "),this.pluginId=this.opts.pluginId}fileUrl(t){return`${this.hostname}/search/${this.id}/get/${t}`}search(t,e){return this.get(`search/${this.id}/list?q=${encodeURIComponent(t)}${e?`&${e}`:""}`)}}async function E(t,e){localStorage.setItem(t,e)}async function P(t){return localStorage.getItem(t)}async function A(t){localStorage.removeItem(t)}},76952:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(10201),o=i(5666),n=i(31837),s=i(3103);i(50172);const a="4.3.2",c={strings:{pluginNameDropbox:"Dropbox"}};class l extends n.A{static VERSION=a;icon;provider;view;storage;files;rootFolderId=null;constructor(t,e){super(t,e),this.id=this.opts.id||"Dropbox",this.type="acquirer",this.storage=this.opts.storage||o.HM,this.files=[],this.icon=()=>(0,r.Y)("svg",{className:"uppy-DashboardTab-iconDropbox","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:(0,r.Y)("path",{d:"M10.5 7.5L5 10.955l5.5 3.454 5.5-3.454 5.5 3.454 5.5-3.454L21.5 7.5 16 10.955zM10.5 21.319L5 17.864l5.5-3.455 5.5 3.455zM16 17.864l5.5-3.455 5.5 3.455-5.5 3.455zM16 25.925l-5.5-3.455 5.5-3.454 5.5 3.454z",fill:"currentcolor",fillRule:"nonzero"})}),this.opts.companionAllowedHosts=(0,o.cP)(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new o.Kq(t,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"dropbox",pluginId:this.id,supportsRefreshToken:!0}),this.defaultLocale=c,this.i18nInit(),this.title=this.i18n("pluginNameDropbox"),this.render=this.render.bind(this)}install(){this.view=new s.gi(this,{provider:this.provider,loadAllFiles:!0,virtualList:!0});const{target:t}=this.opts;t&&this.mount(t,this)}uninstall(){this.view.tearDown(),this.unmount()}render(t){return this.view.render(t)}}},61855:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var r=i(10201),o=i(5666),n=i(31837),s=i(3103),a=i(80753);i(50172);const c="0.4.2",l={strings:{pluginNameGoogleDrivePicker:"Google Drive"}};class u extends n.A{static VERSION=c;static requestClientId=u.name;type="acquirer";icon=a.R;storage;defaultLocale=l;constructor(t,e){super(t,e),this.id=this.opts.id||"GoogleDrivePicker",this.storage=this.opts.storage||o.HM,this.defaultLocale=l,this.i18nInit(),this.title=this.i18n("pluginNameGoogleDrivePicker");const i=new o.R0(t,{pluginId:this.id,provider:"url",companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule});this.uppy.registerRequestClient(u.requestClientId,i)}install(){const{target:t}=this.opts;t&&this.mount(t,this)}uninstall(){this.unmount()}handleFilesPicked=async(t,e)=>{this.uppy.addFiles(t.map((({id:t,mimeType:i,name:r,platform:o,...n})=>({source:this.id,name:r,type:i,data:{size:null},isRemote:!0,remote:{companionUrl:this.opts.companionUrl,url:`${this.opts.companionUrl}/google-picker/get`,body:{fileId:t,accessToken:e,platform:o,..."url"in n&&{url:n.url}},requestClientId:u.requestClientId},..."metadata"in n&&{meta:n.metadata}}))))};render=()=>(0,r.Y)(s.HL,{storage:this.storage,pickerType:"drive",uppy:this.uppy,i18n:this.i18n,clientId:this.opts.clientId,apiKey:this.opts.apiKey,appId:this.opts.appId,onFilesPicked:this.handleFilesPicked})}},32293:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var r=i(10201),o=i(5666),n=i(31837),s=i(3103),a=i(80753);i(50172);const c="0.4.2",l={strings:{pluginNameGooglePhotosPicker:"Google Photos"}};class u extends n.A{static VERSION=c;static requestClientId=u.name;type="acquirer";icon=a.m;storage;defaultLocale=l;constructor(t,e){super(t,e),this.id=this.opts.id||"GooglePhotosPicker",this.storage=this.opts.storage||o.HM,this.defaultLocale=l,this.i18nInit(),this.title=this.i18n("pluginNameGooglePhotosPicker");const i=new o.R0(t,{pluginId:this.id,provider:"url",companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule});this.uppy.registerRequestClient(u.requestClientId,i)}install(){const{target:t}=this.opts;t&&this.mount(t,this)}uninstall(){this.unmount()}handleFilesPicked=async(t,e)=>{this.uppy.addFiles(t.map((({id:t,mimeType:i,name:r,platform:o,...n})=>({source:this.id,name:r,type:i,data:{size:null},isRemote:!0,remote:{companionUrl:this.opts.companionUrl,url:`${this.opts.companionUrl}/google-picker/get`,body:{fileId:t,accessToken:e,platform:o,..."url"in n&&{url:n.url}},requestClientId:u.requestClientId},..."metadata"in n&&{meta:n.metadata}}))))};render=()=>(0,r.Y)(s.HL,{storage:this.storage,pickerType:"photos",uppy:this.uppy,i18n:this.i18n,clientId:this.opts.clientId,onFilesPicked:this.handleFilesPicked})}},96053:(t,e,i)=>{"use strict";i.d(e,{A:()=>v});var r=i(10201),o=i(31837),n=i(50172);const s="3.4.2";var a=i(65643);const c=function(t,e){const i=t.width/e.width,r=t.height/e.height,o=Math.min(i,r),n=e.width*o,s=e.height*o;return{width:n,height:s,left:(t.width-n)/2,top:(t.height-s)/2}};const l=function(t,e,i){const r=Math.abs(i*(Math.PI/180));return Math.max((Math.sin(r)*t+Math.cos(r)*e)/e,(Math.sin(r)*e+Math.cos(r)*t)/t)};const u=function(t,e,i){return e.left<t.left?{left:t.left,width:i.width}:e.top<t.top?{top:t.top,height:i.height}:e.left+e.width>t.left+t.width?{left:t.left+t.width-i.width,width:i.width}:e.top+e.height>t.top+t.height?{top:t.top+t.height-i.height,height:i.height}:null};const h=function(t,e,i){return e.left<t.left?{left:t.left,width:i.left+i.width-t.left}:e.top<t.top?{top:t.top,height:i.top+i.height-t.top}:e.left+e.width>t.left+t.width?{left:i.left,width:t.left+t.width-i.left}:e.top+e.height>t.top+t.height?{top:i.top,height:t.top+t.height-i.top}:null};class p extends n.uA{imgElement;cropper;constructor(t){super(t),this.state={angle90Deg:0,angleGranular:0,prevCropboxData:null},this.storePrevCropboxData=this.storePrevCropboxData.bind(this),this.limitCropboxMovement=this.limitCropboxMovement.bind(this)}componentDidMount(){const{opts:t,storeCropperInstance:e}=this.props;this.cropper=new a(this.imgElement,t.cropperOptions),this.imgElement.addEventListener("cropstart",this.storePrevCropboxData),this.imgElement.addEventListener("cropend",this.limitCropboxMovement),e(this.cropper)}componentWillUnmount(){this.cropper.destroy(),this.imgElement.removeEventListener("cropstart",this.storePrevCropboxData),this.imgElement.removeEventListener("cropend",this.limitCropboxMovement)}storePrevCropboxData(){this.setState({prevCropboxData:this.cropper.getCropBoxData()})}limitCropboxMovement(t){const e=this.cropper.getCanvasData(),i=this.cropper.getCropBoxData(),{prevCropboxData:r}=this.state;if("all"===t.detail.action){const t=u(e,i,r);t&&this.cropper.setCropBoxData(t)}else{const t=h(e,i,r);t&&this.cropper.setCropBoxData(t)}}onRotate90Deg=()=>{const{angle90Deg:t}=this.state,e=t-90;this.setState({angle90Deg:e,angleGranular:0}),this.cropper.scale(1),this.cropper.rotateTo(e);const i=this.cropper.getCanvasData(),r=this.cropper.getContainerData(),o=c(r,i);this.cropper.setCanvasData(o),this.cropper.setCropBoxData(o)};onRotateGranular=t=>{const e=Number(t.target.value);this.setState({angleGranular:e});const{angle90Deg:i}=this.state,r=i+e;this.cropper.rotateTo(r);const o=this.cropper.getImageData(),n=l(o.naturalWidth,o.naturalHeight,e),s=this.cropper.getImageData().scaleX<0?-n:n;this.cropper.scale(s,n)};renderGranularRotate(){const{i18n:t}=this.props,{angleGranular:e}=this.state;return(0,r.Y)("label",{role:"tooltip","aria-label":`${e}\xba`,"data-microtip-position":"top",className:"uppy-ImageCropper-rangeWrapper",children:(0,r.Y)("input",{className:"uppy-ImageCropper-range uppy-u-reset",type:"range",onInput:this.onRotateGranular,onChange:this.onRotateGranular,value:e,min:"-45",max:"45","aria-label":t("rotate")})})}renderRevert(){const{i18n:t,opts:e}=this.props;return(0,r.Y)("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":t("revert"),onClick:()=>{this.cropper.reset(),this.cropper.setAspectRatio(e.cropperOptions.initialAspectRatio),this.setState({angle90Deg:0,angleGranular:0})},children:(0,r.FD)("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[(0,r.Y)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,r.Y)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"})]})})}renderRotate(){const{i18n:t}=this.props;return(0,r.Y)("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":t("rotate"),onClick:this.onRotate90Deg,children:(0,r.FD)("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[(0,r.Y)("path",{d:"M0 0h24v24H0V0zm0 0h24v24H0V0z",fill:"none"}),(0,r.Y)("path",{d:"M14 10a2 2 0 012 2v7a2 2 0 01-2 2H6a2 2 0 01-2-2v-7a2 2 0 012-2h8zm0 1.75H6a.25.25 0 00-.243.193L5.75 12v7a.25.25 0 00.193.243L6 19.25h8a.25.25 0 00.243-.193L14.25 19v-7a.25.25 0 00-.193-.243L14 11.75zM12 .76V4c2.3 0 4.61.88 6.36 2.64a8.95 8.95 0 012.634 6.025L21 13a1 1 0 01-1.993.117L19 13h-.003a6.979 6.979 0 00-2.047-4.95 6.97 6.97 0 00-4.652-2.044L12 6v3.24L7.76 5 12 .76z"})]})})}renderFlip(){const{i18n:t}=this.props;return(0,r.Y)("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":t("flipHorizontal"),onClick:()=>this.cropper.scaleX(-this.cropper.getData().scaleX||-1),children:(0,r.FD)("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[(0,r.Y)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,r.Y)("path",{d:"M15 21h2v-2h-2v2zm4-12h2V7h-2v2zM3 5v14c0 1.1.9 2 2 2h4v-2H5V5h4V3H5c-1.1 0-2 .9-2 2zm16-2v2h2c0-1.1-.9-2-2-2zm-8 20h2V1h-2v22zm8-6h2v-2h-2v2zM15 5h2V3h-2v2zm4 8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2z"})]})})}renderZoomIn(){const{i18n:t}=this.props;return(0,r.Y)("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":t("zoomIn"),onClick:()=>this.cropper.zoom(.1),children:(0,r.FD)("svg",{"aria-hidden":"true",className:"uppy-c-icon",height:"24",viewBox:"0 0 24 24",width:"24",children:[(0,r.Y)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Y)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),(0,r.Y)("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})}renderZoomOut(){const{i18n:t}=this.props;return(0,r.Y)("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":t("zoomOut"),onClick:()=>this.cropper.zoom(-.1),children:(0,r.FD)("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[(0,r.Y)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,r.Y)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"})]})})}renderCropSquare(){const{i18n:t}=this.props;return(0,r.Y)("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":t("aspectRatioSquare"),onClick:()=>this.cropper.setAspectRatio(1),children:(0,r.FD)("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[(0,r.Y)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,r.Y)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})]})})}renderCropWidescreen(){const{i18n:t}=this.props;return(0,r.Y)("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":t("aspectRatioLandscape"),onClick:()=>this.cropper.setAspectRatio(16/9),children:(0,r.FD)("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[(0,r.Y)("path",{d:"M 19,4.9999992 V 17.000001 H 4.9999998 V 6.9999992 H 19 m 0,-2 H 4.9999998 c -1.0999999,0 -1.9999999,0.9000001 -1.9999999,2 V 17.000001 c 0,1.1 0.9,2 1.9999999,2 H 19 c 1.1,0 2,-0.9 2,-2 V 6.9999992 c 0,-1.0999999 -0.9,-2 -2,-2 z"}),(0,r.Y)("path",{fill:"none",d:"M0 0h24v24H0z"})]})})}renderCropWidescreenVertical(){const{i18n:t}=this.props;return(0,r.Y)("button",{"data-microtip-position":"top",type:"button","aria-label":t("aspectRatioPortrait"),className:"uppy-u-reset uppy-c-btn",onClick:()=>this.cropper.setAspectRatio(9/16),children:(0,r.FD)("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[(0,r.Y)("path",{d:"M 19.000001,19 H 6.999999 V 5 h 10.000002 v 14 m 2,0 V 5 c 0,-1.0999999 -0.9,-1.9999999 -2,-1.9999999 H 6.999999 c -1.1,0 -2,0.9 -2,1.9999999 v 14 c 0,1.1 0.9,2 2,2 h 10.000002 c 1.1,0 2,-0.9 2,-2 z"}),(0,r.Y)("path",{d:"M0 0h24v24H0z",fill:"none"})]})})}render(){const{currentImage:t,opts:e}=this.props,{actions:i}=e,o=URL.createObjectURL(t.data);return(0,r.FD)("div",{className:"uppy-ImageCropper",children:[(0,r.Y)("div",{className:"uppy-ImageCropper-container",children:(0,r.Y)("img",{className:"uppy-ImageCropper-image",alt:t.name,src:o,ref:t=>{this.imgElement=t}})}),(0,r.FD)("div",{className:"uppy-ImageCropper-controls",children:[i.revert&&this.renderRevert(),i.rotate&&this.renderRotate(),i.granularRotate&&this.renderGranularRotate(),i.flip&&this.renderFlip(),i.zoomIn&&this.renderZoomIn(),i.zoomOut&&this.renderZoomOut(),i.cropSquare&&this.renderCropSquare(),i.cropWidescreen&&this.renderCropWidescreen(),i.cropWidescreenVertical&&this.renderCropWidescreenVertical()]})]})}}const d={strings:{revert:"Reset",rotate:"Rotate 90\xb0",zoomIn:"Zoom in",zoomOut:"Zoom out",flipHorizontal:"Flip horizontally",aspectRatioSquare:"Crop square",aspectRatioLandscape:"Crop landscape (16:9)",aspectRatioPortrait:"Crop portrait (9:16)"}},m={viewMode:0,background:!1,autoCropArea:1,responsive:!0,minCropBoxWidth:70,minCropBoxHeight:70,croppedCanvasOptions:{},initialAspectRatio:0},f={revert:!0,rotate:!0,granularRotate:!0,flip:!0,zoomIn:!0,zoomOut:!0,cropSquare:!0,cropWidescreen:!0,cropWidescreenVertical:!0},g={quality:.8,actions:f,cropperOptions:m};class v extends o.A{static VERSION=s;cropper;constructor(t,e){super(t,{...g,...e,actions:{...f,...e?.actions},cropperOptions:{...m,...e?.cropperOptions}}),this.id=this.opts.id||"ImageEditor",this.title="Image Editor",this.type="editor",this.defaultLocale=d,this.i18nInit()}canEditFile(t){if(!t.type||t.isRemote)return!1;const e=t.type.split("/")[1];return!!/^(jpe?g|gif|png|bmp|webp)$/.test(e)}save=()=>{const{currentImage:t}=this.getPluginState(),e=this.cropper.getCroppedCanvas({});e.width%2!=0&&this.cropper.setData({width:e.width-1}),e.height%2!=0&&this.cropper.setData({height:e.height-1}),this.cropper.getCroppedCanvas(this.opts.cropperOptions.croppedCanvasOptions).toBlob((t=>{const{currentImage:e}=this.getPluginState();this.uppy.setFileState(e.id,{data:new File([t],e.name??this.i18n("unnamed"),{type:t.type}),size:t.size,preview:void 0});const i=this.uppy.getFile(e.id);this.uppy.emit("thumbnail:request",i),this.setPluginState({currentImage:i}),this.uppy.emit("file-editor:complete",i)}),t.type,this.opts.quality)};storeCropperInstance=t=>{this.cropper=t};selectFile=t=>{this.uppy.emit("file-editor:start",t),this.setPluginState({currentImage:t})};install(){this.setPluginState({currentImage:null});const{target:t}=this.opts;t&&this.mount(t,this)}uninstall(){const{currentImage:t}=this.getPluginState();if(t){const e=this.uppy.getFile(t.id);this.uppy.emit("file-editor:cancel",e)}this.unmount()}render(){const{currentImage:t}=this.getPluginState();return null===t||t.isRemote?null:(0,r.Y)(p,{currentImage:t,storeCropperInstance:this.storeCropperInstance,save:this.save,opts:this.opts,i18n:this.i18n})}}},65341:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(10201),o=i(5666),n=i(31837),s=i(3103);i(50172);const a="4.3.2",c={strings:{pluginNameOneDrive:"OneDrive"}};class l extends n.A{static VERSION=a;icon;provider;view;storage;files;rootFolderId=null;constructor(t,e){super(t,e),this.type="acquirer",this.files=[],this.storage=this.opts.storage||o.HM,this.id=this.opts.id||"OneDrive",this.icon=()=>(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:(0,r.FD)("g",{fill:"none",fillRule:"nonzero",children:[(0,r.Y)("path",{d:"M13.39 12.888l4.618 2.747 2.752-1.15a4.478 4.478 0 012.073-.352 6.858 6.858 0 00-5.527-5.04 6.895 6.895 0 00-6.876 2.982l.07-.002a5.5 5.5 0 012.89.815z",fill:"#0364B8"}),(0,r.Y)("path",{d:"M13.39 12.887v.001a5.5 5.5 0 00-2.89-.815l-.07.002a5.502 5.502 0 00-4.822 2.964 5.43 5.43 0 00.38 5.62l4.073-1.702 1.81-.757 4.032-1.685 2.105-.88-4.619-2.748z",fill:"#0078D4"}),(0,r.Y)("path",{d:"M22.833 14.133a4.479 4.479 0 00-2.073.352l-2.752 1.15.798.475 2.616 1.556 1.141.68 3.902 2.321a4.413 4.413 0 00-.022-4.25 4.471 4.471 0 00-3.61-2.284z",fill:"#1490DF"}),(0,r.Y)("path",{d:"M22.563 18.346l-1.141-.68-2.616-1.556-.798-.475-2.105.88L11.87 18.2l-1.81.757-4.073 1.702A5.503 5.503 0 0010.5 23h12.031a4.472 4.472 0 003.934-2.333l-3.902-2.321z",fill:"#28A8EA"})]})}),this.opts.companionAllowedHosts=(0,o.cP)(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new o.Kq(t,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"onedrive",pluginId:this.id,supportsRefreshToken:!1}),this.defaultLocale=c,this.i18nInit(),this.title=this.i18n("pluginNameOneDrive"),this.render=this.render.bind(this)}install(){this.view=new s.gi(this,{provider:this.provider,loadAllFiles:!0,virtualList:!0});const{target:t}=this.opts;t&&this.mount(t,this)}uninstall(){this.view.tearDown(),this.unmount()}render(t){return this.view.render(t)}}},15640:(t,e,i)=>{"use strict";i.d(e,{A:()=>S});var r=i(10201),o=i(31837),n=i(79885),s=i(50172);const a="4.4.2",c={strings:{pluginNameScreenCapture:"Screencast",startCapturing:"Begin screen capturing",stopCapturing:"Stop screen capturing",submitRecordedFile:"Submit recorded file",streamActive:"Stream active",streamPassive:"Stream passive",micDisabled:"Microphone access denied by user",recording:"Recording",takeScreenshot:"Take Screenshot",discardMediaFile:"Discard Media"}};function l({onDiscard:t,i18n:e}){return(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--discard",type:"button",title:e("discardMediaFile"),"aria-label":e("discardMediaFile"),onClick:t,"data-uppy-super-focusable":!0,children:(0,r.FD)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[(0,r.Y)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,r.Y)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})}function u({recording:t,onStartRecording:e,onStopRecording:i,i18n:o}){return t?(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--video uppy-ScreenCapture-button--stop-rec",type:"button",title:o("stopCapturing"),"aria-label":o("stopCapturing"),onClick:i,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100",children:(0,r.Y)("rect",{x:"15",y:"15",width:"70",height:"70"})})}):(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--video",type:"button",title:o("startCapturing"),"aria-label":o("startCapturing"),onClick:e,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.Y)("path",{d:"M4.5 4.5a3 3 0 0 0-3 3v9a3 3 0 0 0 3 3h8.25a3 3 0 0 0 3-3v-9a3 3 0 0 0-3-3H4.5ZM19.94 18.75l-2.69-2.69V7.94l2.69-2.69c.944-.945 2.56-.276 2.56 1.06v11.38c0 1.336-1.616 2.005-2.56 1.06Z"})})})}function h({onScreenshot:t,i18n:e}){return(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--screenshot",type:"button",title:e("takeScreenshot"),"aria-label":e("takeScreenshot"),onClick:t,"data-uppy-super-focusable":!0,children:(0,r.FD)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:[(0,r.Y)("path",{d:"M12 9a3.75 3.75 0 1 0 0 7.5A3.75 3.75 0 0 0 12 9Z"}),(0,r.Y)("path",{"fill-rule":"evenodd",d:"M9.344 3.071a49.52 49.52 0 0 1 5.312 0c.967.052 1.83.585 2.332 1.39l.821 1.317c.24.383.645.643 1.11.71.386.054.77.113 1.152.177 1.432.239 2.429 1.493 2.429 2.909V18a3 3 0 0 1-3 3h-15a3 3 0 0 1-3-3V9.574c0-1.416.997-2.67 2.429-2.909.382-.064.766-.123 1.151-.178a1.56 1.56 0 0 0 1.11-.71l.822-1.315a2.942 2.942 0 0 1 2.332-1.39ZM6.75 12.75a5.25 5.25 0 1 1 10.5 0 5.25 5.25 0 0 1-10.5 0Zm12-1.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z","clip-rule":"evenodd"})]})})}class p extends s.uA{wrapperStyle={width:"100%",height:"100%",display:"flex"};overlayStyle={position:"absolute",width:"100%",height:"100%",background:"black",opacity:.7};infoContainerStyle={marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto",zIndex:1,color:"white"};infotextStyle={marginLeft:"auto",marginRight:"auto",marginBottom:"1rem",fontSize:"1.5rem"};timeStyle={display:"block",fontWeight:"bold",marginLeft:"auto",marginRight:"auto",fontSize:"3rem",fontFamily:"Courier New"};timerRunning=!1;timer;constructor(t){super(t),this.state={elapsedTime:0}}startTimer(){this.timerTick(),this.timerRunning=!0}resetTimer(){clearTimeout(this.timer),this.setState({elapsedTime:0}),this.timerRunning=!1}timerTick(){this.timer=setTimeout((()=>{this.setState((t=>({elapsedTime:t.elapsedTime+1}))),this.timerTick()}),1e3)}render(){const{recording:t,i18n:e}={...this.props},{elapsedTime:i}=this.state,o=((n=i)-(n%=60))/60+(n>9?":":":0")+n;var n;return t&&!this.timerRunning&&this.startTimer(),!t&&this.timerRunning&&this.resetTimer(),t?(0,r.FD)("div",{style:this.wrapperStyle,children:[(0,r.Y)("div",{style:this.overlayStyle}),(0,r.FD)("div",{style:this.infoContainerStyle,children:[(0,r.Y)("div",{style:this.infotextStyle,children:e("recording")}),(0,r.Y)("div",{style:this.timeStyle,children:o})]})]}):null}}const d=p;function m({streamActive:t,i18n:e}){return t?(0,r.Y)("div",{title:e("streamActive"),className:"uppy-ScreenCapture-icon--stream uppy-ScreenCapture-icon--streamActive",children:(0,r.FD)("svg",{"aria-hidden":"true",focusable:"false",width:"24",height:"24",viewBox:"0 0 24 24",children:[(0,r.Y)("path",{d:"M0 0h24v24H0z",opacity:".1",fill:"none"}),(0,r.Y)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,r.Y)("path",{d:"M1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm18-7H5v1.63c3.96 1.28 7.09 4.41 8.37 8.37H19V7zM1 10v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11zm20-7H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})]})}):(0,r.Y)("div",{title:e("streamPassive"),className:"uppy-ScreenCapture-icon--stream",children:(0,r.FD)("svg",{"aria-hidden":"true",focusable:"false",width:"24",height:"24",viewBox:"0 0 24 24",children:[(0,r.Y)("path",{d:"M0 0h24v24H0z",opacity:".1",fill:"none"}),(0,r.Y)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,r.Y)("path",{d:"M21 3H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm0-4v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11z"})]})})}function f({recording:t,recordedVideo:e,onSubmit:i,capturedScreenshotUrl:o,i18n:n}){return!e&&!o||t?null:(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--submit",type:"button",title:n("submitRecordedFile"),"aria-label":n("submitRecordedFile"),onClick:i,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{width:"12",height:"9",viewBox:"0 0 12 9",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon",children:(0,r.Y)("path",{fill:"#fff",fillRule:"nonzero",d:"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z"})})})}class g extends s.uA{videoElement=null;componentWillUnmount(){const{onStop:t}=this.props;t()}render(){const{recording:t,stream:e,recordedVideo:i,enableScreenshots:o,capturedScreenshotUrl:n}=this.props,a={playsinline:!0};return(t||!i&&!t)&&(a.muted=!0,a.autoplay=!0,a.srcObject=e),i&&!t&&(a.muted=!1,a.controls=!0,a.src=i,this.videoElement&&(this.videoElement.srcObject=null)),(0,r.FD)("div",{className:"uppy uppy-ScreenCapture-container",children:[(0,r.FD)("div",{className:"uppy-ScreenCapture-mediaContainer",children:[(0,r.Y)(m,{...this.props}),!n||t||i?(0,r.Y)("video",{ref:t=>{this.videoElement=t},className:"uppy-ScreenCapture-media",...a}):(0,r.Y)("div",{className:"uppy-ScreenCapture-imageContainer",children:(0,r.Y)("img",{src:n,className:"uppy-ScreenCapture-media",alt:"screenshotPreview"})}),(0,r.Y)("div",{children:(0,r.Y)(d,{...this.props})})]}),(0,r.Y)("div",{className:"uppy-ScreenCapture-buttonContainer",children:i||n?(0,r.FD)(s.FK,{children:[(0,r.Y)(f,{...this.props}),(0,r.Y)(l,{...this.props})]}):(0,r.FD)(s.FK,{children:[o&&!t&&(0,r.Y)(h,{...this.props}),(0,r.Y)(u,{...this.props})]})})]})}}const v=g;function y(){return(0,r.Y)("svg",{className:"uppy-DashboardTab-iconScreenRec","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:(0,r.FD)("g",{fill:"currentcolor",fillRule:"evenodd",children:[(0,r.Y)("path",{d:"M24.182 9H7.818C6.81 9 6 9.742 6 10.667v10c0 .916.81 1.666 1.818 1.666h4.546V24h7.272v-1.667h4.546c1 0 1.809-.75 1.809-1.666l.009-10C26 9.742 25.182 9 24.182 9zM24 21H8V11h16v10z"}),(0,r.Y)("circle",{cx:"16",cy:"16",r:"2"})]})})}const b=["image/png","image/jpeg","image/webp"],w={displayMediaConstraints:{video:{width:1280,height:720,frameRate:{ideal:3,max:5},cursor:"motion",displaySurface:"monitor"}},userMediaConstraints:{audio:!0},preferredVideoMimeType:"video/webm",preferredImageMimeType:"image/png",enableScreenshots:!0};class S extends o.A{static VERSION=a;mediaDevices;protocol;icon;streamInterrupted;captureActive;capturedMediaFile;videoStream=null;audioStream=null;userDenied=!1;recorder=null;outputStream=null;recordingChunks=null;constructor(t,e){super(t,{...w,...e}),this.mediaDevices=window.MediaRecorder&&navigator.mediaDevices,this.protocol="https:"===location.protocol?"https":"http",this.id=this.opts.id||"ScreenCapture",this.type="acquirer",this.icon=y,this.defaultLocale=c,this.i18nInit(),this.title=this.i18n("pluginNameScreenCapture"),this.install=this.install.bind(this),this.setPluginState=this.setPluginState.bind(this),this.render=this.render.bind(this),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.startRecording=this.startRecording.bind(this),this.stopRecording=this.stopRecording.bind(this),this.submit=this.submit.bind(this),this.streamInterrupted=this.streamInactivated.bind(this),this.captureScreenshot=this.captureScreenshot.bind(this),this.discardRecordedMedia=this.discardRecordedMedia.bind(this),this.captureActive=!1,this.capturedMediaFile=null,this.setPluginState({streamActive:!1,audioStreamActive:!1,recording:!1,recordedVideo:null,screenRecError:null,capturedScreenshotUrl:null,status:"init"})}install(){if(!window.MediaRecorder||!navigator.mediaDevices?.getDisplayMedia)return this.uppy.log("Screen recorder access is not supported","warning"),null;this.setPluginState({streamActive:!1,audioStreamActive:!1,status:"init"});const{target:t}=this.opts;t&&this.mount(t,this)}uninstall(){this.videoStream&&this.stop(),this.unmount()}start(){return this.mediaDevices?(this.captureActive=!0,this.selectAudioStreamSource(),this.selectVideoStreamSource().then((t=>{!1===t&&this.parent?.hideAllPanels&&(this.parent.hideAllPanels(),this.captureActive=!1)}))):Promise.reject(new Error("Screen recorder access not supported"))}selectVideoStreamSource(){return this.videoStream?new Promise((t=>t(this.videoStream))):this.mediaDevices.getDisplayMedia(this.opts.displayMediaConstraints).then((t=>(this.videoStream=t,this.videoStream.addEventListener("inactive",(()=>{this.streamInactivated()})),this.setPluginState({streamActive:!0,status:"ready",screenRecError:null}),t))).catch((t=>(this.setPluginState({screenRecError:t,status:"error"}),this.userDenied=!0,setTimeout((()=>{this.userDenied=!1}),1e3),!1)))}selectAudioStreamSource(){return this.audioStream?new Promise((t=>t(this.audioStream))):this.mediaDevices.getUserMedia(this.opts.userMediaConstraints).then((t=>(this.audioStream=t,this.setPluginState({audioStreamActive:!0}),t))).catch((t=>("NotAllowedError"===t.name&&(this.uppy.info(this.i18n("micDisabled"),"error",5e3),this.uppy.log(this.i18n("micDisabled"),"warning")),!1)))}startRecording(){const t={};this.capturedMediaFile=null,this.recordingChunks=[];const{preferredVideoMimeType:e}=this.opts;this.selectVideoStreamSource().then((i=>{if(!1===i)throw new Error("No video stream available");e&&MediaRecorder.isTypeSupported(e)&&(0,n.A)(e)&&(t.mimeType=e);const r=[i.getVideoTracks()[0]];this.audioStream&&r.push(this.audioStream.getAudioTracks()[0]),this.outputStream=new MediaStream(r),this.recorder=new MediaRecorder(this.outputStream,t),this.recorder.addEventListener("dataavailable",(t=>{this.recordingChunks.push(t.data)})),this.recorder.start(),this.setPluginState({recording:!0,status:"recording"})})).catch((t=>{this.uppy.log(t,"error"),this.setPluginState({screenRecError:t,status:"error"})}))}streamInactivated(){const{recordedVideo:t,recording:e}={...this.getPluginState()};t||e?e&&(this.uppy.log("Capture stream inactive \u2014 stop recording"),this.stopRecording()):(this.parent?.hideAllPanels&&this.parent.hideAllPanels(),this.setPluginState({status:"init"})),this.videoStream=null,this.audioStream=null,this.setPluginState({streamActive:!1,audioStreamActive:!1})}stopRecording(){return new Promise((t=>{this.recorder.addEventListener("stop",(()=>{t()})),this.recorder.stop()})).then((()=>(this.setPluginState({recording:!1}),this.getVideo()))).then((t=>{this.capturedMediaFile=t,this.setPluginState({recordedVideo:URL.createObjectURL(t.data),status:"captured"})})).then((()=>{this.recordingChunks=null,this.recorder=null}),(t=>{throw this.recordingChunks=null,this.recorder=null,t}))}discardRecordedMedia(){const{capturedScreenshotUrl:t,recordedVideo:e}=this.getPluginState();t&&URL.revokeObjectURL(t),e&&URL.revokeObjectURL(e),this.capturedMediaFile=null,this.setPluginState({recordedVideo:null,capturedScreenshotUrl:null,status:this.getPluginState().streamActive?"ready":"init"})}submit(){try{this.capturedMediaFile&&this.uppy.addFile(this.capturedMediaFile)}catch(t){t.isRestriction||this.uppy.log(t,"warning")}}stop(){this.videoStream&&(this.videoStream.getVideoTracks().forEach((t=>{t.stop()})),this.videoStream.getAudioTracks().forEach((t=>{t.stop()})),this.videoStream=null),this.audioStream&&(this.audioStream.getAudioTracks().forEach((t=>{t.stop()})),this.audioStream.getVideoTracks().forEach((t=>{t.stop()})),this.audioStream=null),this.outputStream&&(this.outputStream.getAudioTracks().forEach((t=>{t.stop()})),this.outputStream.getVideoTracks().forEach((t=>{t.stop()})),this.outputStream=null);const{capturedScreenshotUrl:t,recordedVideo:e}=this.getPluginState();t&&URL.revokeObjectURL(t),e&&URL.revokeObjectURL(e),this.setPluginState({recording:!1,streamActive:!1,audioStreamActive:!1,recordedVideo:null,capturedScreenshotUrl:null,status:"init"}),this.captureActive=!1}getVideo(){const t=this.recordingChunks[0].type,e=(0,n.A)(t);if(!e)return Promise.reject(new Error(`Could not retrieve recording: Unsupported media type "${t}"`));const i=`screencap-${Date.now()}.${e}`,r=new Blob(this.recordingChunks,{type:t}),o={source:this.id,name:i,data:new Blob([r],{type:t}),type:t};return Promise.resolve(o)}async captureScreenshot(){if(!this.mediaDevices?.getDisplayMedia)throw new Error("Screen capture is not supported");try{let t=this.videoStream;if(!t){const e=await this.selectVideoStreamSource();if(!e)throw new Error("Failed to get screen capture stream");t=e}const e=document.createElement("video");e.srcObject=t,await new Promise((t=>{e.onloadedmetadata=()=>{e.play(),t(null)}}));const i=document.createElement("canvas");i.width=e.videoWidth,i.height=e.videoHeight;const r=i.getContext("2d");if(!r)throw new Error("Failed to get canvas context");r.drawImage(e,0,0,i.width,i.height);let o=this.opts.preferredImageMimeType;o&&b.includes(o)||(this.uppy.log(`Unsupported image type "${o}", falling back to image/png`,"warning"),o="image/png");const s=1;return new Promise(((t,r)=>{i.toBlob((s=>{if(!s)return void r(new Error("Failed to create screenshot blob"));const a=(0,n.A)(o)||"png",c={source:this.id,name:`Screenshot ${(new Date).toISOString()}.${a}`,type:o,data:s};try{this.capturedMediaFile=c;const e=URL.createObjectURL(s);this.setPluginState({capturedScreenshotUrl:e,status:"captured"}),t()}catch(l){this.getPluginState().capturedScreenshotUrl&&this.setPluginState({capturedScreenshotUrl:null}),l.isRestriction||this.uppy.log(l,"error"),r(l)}finally{e.srcObject=null,i.remove(),e.remove()}}),o,s)}))}catch(t){throw this.uppy.log(t,"error"),t}}render(){const t=this.getPluginState();return t.streamActive||this.captureActive||this.userDenied||this.start(),(0,r.Y)(v,{...t,onStartRecording:this.startRecording,onStopRecording:this.stopRecording,enableScreenshots:this.opts.enableScreenshots,onScreenshot:this.captureScreenshot,onStop:this.stop,onSubmit:this.submit,i18n:this.i18n,stream:this.videoStream,onDiscard:this.discardRecordedMedia})}}},64700:(t,e,i)=>{"use strict";i.d(e,{A:()=>he});var r=i(42656);class o{#E;#P=[];constructor(t){this.#E=t}on(t,e){return this.#P.push([t,e]),this.#E.on(t,e)}remove(){for(const[t,e]of this.#P.splice(0))this.#E.off(t,e)}onFilePause(t,e){this.on("upload-pause",((i,r)=>{t===i?.id&&e(r)}))}onFileRemove(t,e){this.on("file-removed",(i=>{t===i.id&&e(i.id)}))}onPause(t,e){this.on("upload-pause",((i,r)=>{t===i?.id&&e(r)}))}onRetry(t,e){this.on("upload-retry",(i=>{t===i?.id&&e()}))}onRetryAll(t,e){this.on("retry-all",(()=>{this.#E.getFile(t)&&e()}))}onPauseAll(t,e){this.on("pause-all",(()=>{this.#E.getFile(t)&&e()}))}onCancelAll(t,e){this.on("cancel-all",((...i)=>{this.#E.getFile(t)&&e(...i)}))}onResumeAll(t,e){this.on("resume-all",(()=>{this.#E.getFile(t)&&e()}))}}var n=i(61825);const s=function(t){return!!t&&(0!==t.readyState&&4!==t.readyState||0===t.status)};var a=i(52094);function c(t){if(null!=t){const e=()=>this.abort(t.reason);t.addEventListener("abort",e,{once:!0});const i=()=>{t.removeEventListener("abort",e)};this.then?.(i,i)}return this}class l{#A=0;#D=[];#T=!1;#_;#U=1;#M;#L;limit;constructor(t){this.limit="number"!=typeof t||0===t?1/0:t}#O(t){this.#A+=1;let e,i=!1;try{e=t()}catch(r){throw this.#A-=1,r}return{abort:t=>{i||(i=!0,this.#A-=1,e?.(t),this.#N())},done:()=>{i||(i=!0,this.#A-=1,this.#N())}}}#N(){queueMicrotask((()=>this.#I()))}#I(){if(this.#T||this.#A>=this.limit)return;if(0===this.#D.length)return;const t=this.#D.shift();if(null==t)throw new Error("Invariant violation: next is null");const e=this.#O(t.fn);t.abort=e.abort,t.done=e.done}#F(t,e){const i={fn:t,priority:e?.priority||0,abort:()=>{this.#z(i)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},r=this.#D.findIndex((t=>i.priority>t.priority));return-1===r?this.#D.push(i):this.#D.splice(r,0,i),i}#z(t){const e=this.#D.indexOf(t);-1!==e&&this.#D.splice(e,1)}run(t,e){return!this.#T&&this.#A<this.limit?this.#O(t):this.#F(t,e)}wrapSyncFunction(t,e){return(...i)=>{const r=this.run((()=>(t(...i),queueMicrotask((()=>r.done())),()=>{})),e);return{abortOn:c,abort(){r.abort()}}}}wrapPromiseFunction(t,e){return(...i)=>{let r;const o=new Promise(((o,n)=>{r=this.run((()=>{let e,s;try{s=Promise.resolve(t(...i))}catch(a){s=Promise.reject(a)}return s.then((t=>{e?n(e):(r.done(),o(t))}),(t=>{e?n(e):(r.done(),n(t))})),t=>{e=function(t){return new Error("Cancelled",{cause:t})}(t)}}),e)}));return o.abort=t=>{r.abort(t)},o.abortOn=c,o}}resume(){this.#T=!1,clearTimeout(this.#_);for(let t=0;t<this.limit;t++)this.#N()}#j=()=>this.resume();pause(t=null){this.#T=!0,clearTimeout(this.#_),null!=t&&(this.#_=setTimeout(this.#j,t))}rateLimit(t){clearTimeout(this.#L),this.pause(t),this.limit>1&&Number.isFinite(this.limit)&&(this.#M=this.limit-1,this.limit=this.#U,this.#L=setTimeout(this.#Y,t))}#Y=()=>{if(this.#T)this.#L=setTimeout(this.#Y,0);else{this.#U=this.limit,this.limit=Math.ceil((this.#M+this.#U)/2);for(let t=this.#U;t<=this.limit;t++)this.#N();this.#M-this.#U>3?this.#L=setTimeout(this.#Y,2e3):this.#U=Math.floor(this.#U/2)}};get isPaused(){return this.#T}}Symbol("__queue");function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function h(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,p(r.key),r)}}function p(t){var e=function(t,e){if("object"!=u(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==u(e)?e:e+""}var d=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(t){return Promise.resolve([])}},{key:"removeUpload",value:function(t){return Promise.resolve()}},{key:"addUpload",value:function(t,e){return Promise.resolve(null)}}])&&h(t.prototype,e),i&&h(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,i}();const m="function"==typeof Buffer,f=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),g=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),v=(t=>{let e={};return t.forEach(((t,i)=>e[t]=i)),e})(g),y=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,b=String.fromCharCode.bind(String),w=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),t=>t.replace(/=/g,"").replace(/[+\/]/g,(t=>"+"==t?"-":"_"))),S=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),x=t=>{let e,i,r,o,n="";const s=t.length%3;for(let a=0;a<t.length;){if((i=t.charCodeAt(a++))>255||(r=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=i<<16|r<<8|o,n+=g[e>>18&63]+g[e>>12&63]+g[e>>6&63]+g[63&e]}return s?n.slice(0,s-3)+"===".substring(s):n},C="function"==typeof btoa?t=>btoa(t):m?t=>Buffer.from(t,"binary").toString("base64"):x,R=m?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let i=0,r=t.length;i<r;i+=4096)e.push(b.apply(null,t.subarray(i,i+4096)));return C(e.join(""))},k=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?b(192|e>>>6)+b(128|63&e):b(224|e>>>12&15)+b(128|e>>>6&63)+b(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return b(240|e>>>18&7)+b(128|e>>>12&63)+b(128|e>>>6&63)+b(128|63&e)},E=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,P=t=>t.replace(E,k),A=m?t=>Buffer.from(t,"utf8").toString("base64"):f?t=>R(f.encode(t)):t=>C(P(t)),D=(t,e=!1)=>e?w(A(t)):A(t),T=t=>{if(t=t.replace(/\s+/g,""),!y.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));let e,i,r,o="";for(let n=0;n<t.length;)e=v[t.charAt(n++)]<<18|v[t.charAt(n++)]<<12|(i=v[t.charAt(n++)])<<6|(r=v[t.charAt(n++)]),o+=64===i?b(e>>16&255):64===r?b(e>>16&255,e>>8&255):b(e>>16&255,e>>8&255,255&e);return o},_=D;var U=i(61160),M=i.n(U);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function O(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,N(r.key),r)}}function N(t){var e=function(t,e){if("object"!=L(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==L(e)?e:e+""}function I(t,e,i){return e=Y(e),function(t,e){if(e&&("object"===L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,z()?Reflect.construct(e,i||[],Y(t).constructor):e.apply(t,i))}function F(t){var e="function"==typeof Map?new Map:void 0;return F=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return function(t,e,i){if(z())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var o=new(t.bind.apply(t,r));return i&&j(o,i.prototype),o}(t,arguments,Y(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),j(i,t)},F(t)}function z(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(z=function(){return!!t})()}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}function Y(t){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Y(t)}const H=function(t){function e(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=I(this,e,[t])).originalRequest=o,i.originalResponse=n,i.causingError=r,null!=r&&(t+=", caused by ".concat(r.toString())),null!=o){var s=o.getHeader("X-Request-ID")||"n/a",a=o.getMethod(),c=o.getURL(),l=n?n.getStatus():"n/a",u=n?n.getBody()||"":"n/a";t+=", originated from request (method: ".concat(a,", url: ").concat(c,", response code: ").concat(l,", response text: ").concat(u,", request id: ").concat(s,")")}return i.message=t,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}(e,t),i=e,r&&O(i.prototype,r),o&&O(i,o),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,o}(F(Error));var B=!1;function q(t){B&&console.log(t)}function V(){V=function(){return e};var t,e={},i=Object.prototype,r=i.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,i){return t[e]=i}}function u(t,e,i,r){var n=e&&e.prototype instanceof v?e:v,s=Object.create(n.prototype),a=new T(r||[]);return o(s,"_invoke",{value:E(t,i,a)}),s}function h(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p="suspendedStart",d="suspendedYield",m="executing",f="completed",g={};function v(){}function y(){}function b(){}var w={};l(w,s,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(_([])));x&&x!==i&&r.call(x,s)&&(w=x);var C=b.prototype=v.prototype=Object.create(w);function R(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function i(o,n,s,a){var c=h(t[o],t,n);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==X(u)&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(u).then((function(t){l.value=t,s(l)}),(function(t){return i("throw",t,s,a)}))}a(c.arg)}var n;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){i(t,r,e,o)}))}return n=n?n.then(o,o):o()}})}function E(e,i,r){var o=p;return function(n,s){if(o===m)throw Error("Generator is already running");if(o===f){if("throw"===n)throw s;return{value:t,done:!0}}for(r.method=n,r.arg=s;;){var a=r.delegate;if(a){var c=P(a,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var l=h(e,i,r);if("normal"===l.type){if(o=r.done?f:d,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=f,r.method="throw",r.arg=l.arg)}}}function P(e,i){var r=i.method,o=e.iterator[r];if(o===t)return i.delegate=null,"throw"===r&&e.iterator.return&&(i.method="return",i.arg=t,P(e,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var n=h(o,e.iterator,i.arg);if("throw"===n.type)return i.method="throw",i.arg=n.arg,i.delegate=null,g;var s=n.arg;return s?s.done?(i[e.resultName]=s.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):s:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function _(e){if(e||""===e){var i=e[s];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,n=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return n.next=n}}throw new TypeError(X(e)+" is not iterable")}return y.prototype=b,o(C,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,c,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},R(k.prototype),l(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,i,r,o,n){void 0===n&&(n=Promise);var s=new k(u(t,i,r,o),n);return e.isGeneratorFunction(i)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},R(C),l(C,c,"Generator"),l(C,s,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var r in e)i.push(r);return i.reverse(),function t(){for(;i.length;){var r=i.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=_,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function o(r,o){return a.type="throw",a.arg=e,i.next=r,o&&(i.method="next",i.arg=t),!!o}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var s=n?n.completion:{};return s.type=t,s.arg=e,n?(this.method="next",this.next=n.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),D(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var o=r.arg;D(i)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,i,r){return this.delegate={iterator:_(e),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function W(t,e,i,r,o,n,s){try{var a=t[n](s),c=a.value}catch(H){return void i(H)}a.done?e(c):Promise.resolve(c).then(r,o)}function $(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var r,o,n,s,a=[],c=!0,l=!1;try{if(n=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;c=!1}else for(;!(c=(r=n.call(i)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=i.return&&(s=i.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}(t,e)||K(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function K(t,e){if(t){if("string"==typeof t)return G(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?G(t,e):void 0}}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function Z(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function J(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(i),!0).forEach((function(e){Q(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Z(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Q(t,e,i){return(e=et(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,et(r.key),r)}}function et(t){var e=function(t,e){if("object"!=X(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==X(e)?e:e+""}var it="tus-v1",rt="ietf-draft-03",ot={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:pt,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:it},nt=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"resume"in i&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=i,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return e=t,i=[{key:"findPreviousUploads",value:function(){var t=this;return this.options.fingerprint(this.file,this.options).then((function(e){return t._urlStorage.findUploadsByFingerprint(e)}))}},{key:"resumeFromPreviousUpload",value:function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey}},{key:"start",value:function(){var t=this,e=this.file;if(e)if([it,rt].includes(this.options.protocol))if(this.options.endpoint||this.options.uploadUrl||this.url){var i=this.options.retryDelays;if(null==i||"[object Array]"===Object.prototype.toString.call(i)){if(this.options.parallelUploads>1)for(var r=0,o=["uploadUrl","uploadSize","uploadLengthDeferred"];r<o.length;r++){var n=o[r];if(this.options[n])return void this._emitError(new Error("tus: cannot use the ".concat(n," option when parallelUploads is enabled")))}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1)return void this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length)return void this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"))}this.options.fingerprint(e,this.options).then((function(i){return q(null==i?"No fingerprint was calculated meaning that the upload cannot be stored in the URL storage.":"Calculated fingerprint: ".concat(i)),t._fingerprint=i,t._source?t._source:t.options.fileReader.openFile(e,t.options.chunkSize)})).then((function(e){if(t._source=e,t.options.uploadLengthDeferred)t._size=null;else if(null!=t.options.uploadSize){if(t._size=Number(t.options.uploadSize),Number.isNaN(t._size))return void t._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(t._size=t._source.size,null==t._size)return void t._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));t.options.parallelUploads>1||null!=t._parallelUploadUrls?t._startParallelUpload():t._startSingleUpload()})).catch((function(e){t._emitError(e)}))}else this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var e,i=this,r=this._size,o=0;this._parallelUploads=[];var n=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,s=null!==(e=this.options.parallelUploadBoundaries)&&void 0!==e?e:function(t,e){for(var i=Math.floor(t/e),r=[],o=0;o<e;o++)r.push({start:i*o,end:i*(o+1)});return r[e-1].end=t,r}(this._source.size,n);this._parallelUploadUrls&&s.forEach((function(t,e){t.uploadUrl=i._parallelUploadUrls[e]||null})),this._parallelUploadUrls=new Array(s.length);var a,c=s.map((function(e,n){var a=0;return i._source.slice(e.start,e.end).then((function(c){var l=c.value;return new Promise((function(c,u){var h=J(J({},i.options),{},{uploadUrl:e.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:i.options.metadataForPartialUploads,headers:J(J({},i.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:c,onError:u,onProgress:function(t){o=o-a+t,a=t,i._emitProgress(o,r)},onUploadUrlAvailable:function(){i._parallelUploadUrls[n]=p.url,i._parallelUploadUrls.filter((function(t){return Boolean(t)})).length===s.length&&i._saveUploadInUrlStorage()}}),p=new t(l,h);p.start(),i._parallelUploads.push(p)}))}))}));Promise.all(c).then((function(){(a=i._openRequest("POST",i.options.endpoint)).setHeader("Upload-Concat","final;".concat(i._parallelUploadUrls.join(" ")));var t=st(i.options.metadata);return""!==t&&a.setHeader("Upload-Metadata",t),i._sendRequest(a,null)})).then((function(t){if(at(t.getStatus(),200)){var e=t.getHeader("Location");null!=e?(i.url=dt(i.options.endpoint,e),q("Created upload at ".concat(i.url)),i._emitSuccess(t)):i._emitHttpError(a,t,"tus: invalid or missing Location header")}else i._emitHttpError(a,t,"tus: unexpected response while creating upload")})).catch((function(t){i._emitError(t)}))}},{key:"_startSingleUpload",value:function(){return this._aborted=!1,null!=this.url?(q("Resuming upload from previous URL: ".concat(this.url)),void this._resumeUpload()):null!=this.options.uploadUrl?(q("Resuming upload from provided URL: ".concat(this.options.uploadUrl)),this.url=this.options.uploadUrl,void this._resumeUpload()):(q("Creating a new upload"),void this._createUpload())}},{key:"abort",value:function(e){var i=this;if(null!=this._parallelUploads){var r,o=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=K(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,n=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw n}}}}(this._parallelUploads);try{for(o.s();!(r=o.n()).done;)r.value.abort(e)}catch(n){o.e(n)}finally{o.f()}}return null!==this._req&&this._req.abort(),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),e&&null!=this.url?t.terminate(this.url,this.options).then((function(){return i._removeFromUrlStorage()})):Promise.resolve()}},{key:"_emitHttpError",value:function(t,e,i,r){this._emitError(new H(i,r,t,e))}},{key:"_emitError",value:function(t){var e=this;if(!this._aborted){if(null!=this.options.retryDelays&&(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),ht(t,this._retryAttempt,this.options))){var i=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout((function(){e.start()}),i))}if("function"!=typeof this.options.onError)throw t;this.options.onError(t)}}},{key:"_emitSuccess",value:function(t){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess({lastResponse:t})}},{key:"_emitProgress",value:function(t,e){"function"==typeof this.options.onProgress&&this.options.onProgress(t,e)}},{key:"_emitChunkComplete",value:function(t,e,i){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(t,e,i)}},{key:"_createUpload",value:function(){var t=this;if(this.options.endpoint){var e=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?e.setHeader("Upload-Defer-Length","1"):e.setHeader("Upload-Length","".concat(this._size));var i,r=st(this.options.metadata);""!==r&&e.setHeader("Upload-Metadata",r),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,i=this._addChunkToRequest(e)):(this.options.protocol===rt&&e.setHeader("Upload-Complete","?0"),i=this._sendRequest(e,null)),i.then((function(i){if(at(i.getStatus(),200)){var r=i.getHeader("Location");if(null!=r){if(t.url=dt(t.options.endpoint,r),q("Created upload at ".concat(t.url)),"function"==typeof t.options.onUploadUrlAvailable&&t.options.onUploadUrlAvailable(),0===t._size)return t._emitSuccess(i),void t._source.close();t._saveUploadInUrlStorage().then((function(){t.options.uploadDataDuringCreation?t._handleUploadResponse(e,i):(t._offset=0,t._performUpload())}))}else t._emitHttpError(e,i,"tus: invalid or missing Location header")}else t._emitHttpError(e,i,"tus: unexpected response while creating upload")})).catch((function(i){t._emitHttpError(e,null,"tus: failed to create upload",i)}))}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var t=this,e=this._openRequest("HEAD",this.url);this._sendRequest(e,null).then((function(i){var r=i.getStatus();if(!at(r,200))return 423===r?void t._emitHttpError(e,i,"tus: upload is currently locked; retry later"):(at(r,400)&&t._removeFromUrlStorage(),t.options.endpoint?(t.url=null,void t._createUpload()):void t._emitHttpError(e,i,"tus: unable to resume upload (new upload cannot be created without an endpoint)"));var o=Number.parseInt(i.getHeader("Upload-Offset"),10);if(Number.isNaN(o))t._emitHttpError(e,i,"tus: invalid or missing offset value");else{var n=Number.parseInt(i.getHeader("Upload-Length"),10);!Number.isNaN(n)||t.options.uploadLengthDeferred||t.options.protocol!==it?("function"==typeof t.options.onUploadUrlAvailable&&t.options.onUploadUrlAvailable(),t._saveUploadInUrlStorage().then((function(){if(o===n)return t._emitProgress(n,n),void t._emitSuccess(i);t._offset=o,t._performUpload()}))):t._emitHttpError(e,i,"tus: invalid or missing length value")}})).catch((function(i){t._emitHttpError(e,null,"tus: failed to resume upload",i)}))}},{key:"_performUpload",value:function(){var t,e=this;this._aborted||(this.options.overridePatchMethod?(t=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):t=this._openRequest("PATCH",this.url),t.setHeader("Upload-Offset","".concat(this._offset)),this._addChunkToRequest(t).then((function(i){at(i.getStatus(),200)?e._handleUploadResponse(t,i):e._emitHttpError(t,i,"tus: unexpected response while uploading chunk")})).catch((function(i){e._aborted||e._emitHttpError(t,null,"tus: failed to upload chunk at offset ".concat(e._offset),i)})))}},{key:"_addChunkToRequest",value:function(t){var e=this,i=this._offset,r=this._offset+this.options.chunkSize;return t.setProgressHandler((function(t){e._emitProgress(i+t,e._size)})),t.setHeader("Content-Type","application/offset+octet-stream"),(r===Number.POSITIVE_INFINITY||r>this._size)&&!this.options.uploadLengthDeferred&&(r=this._size),this._source.slice(i,r).then((function(i){var r=i.value,o=i.done,n=null!=r&&r.size?r.size:0;e.options.uploadLengthDeferred&&o&&(e._size=e._offset+n,t.setHeader("Upload-Length","".concat(e._size)));var s=e._offset+n;return!e.options.uploadLengthDeferred&&o&&s!==e._size?Promise.reject(new Error("upload was configured with a size of ".concat(e._size," bytes, but the source is done after ").concat(s," bytes"))):null===r?e._sendRequest(t):(e.options.protocol===rt&&t.setHeader("Upload-Complete",o?"?1":"?0"),e._emitProgress(e._offset,e._size),e._sendRequest(t,r))}))}},{key:"_handleUploadResponse",value:function(t,e){var i=Number.parseInt(e.getHeader("Upload-Offset"),10);if(Number.isNaN(i))this._emitHttpError(t,e,"tus: invalid or missing offset value");else{if(this._emitProgress(i,this._size),this._emitChunkComplete(i-this._offset,i,this._size),this._offset=i,i===this._size)return this._emitSuccess(e),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(t,e){var i=ct(t,e,this.options);return this._req=i,i}},{key:"_removeFromUrlStorage",value:function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch((function(e){t._emitError(e)})),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var t=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||null!==this._urlStorageKey)return Promise.resolve();var e={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};return this._parallelUploads?e.parallelUploadUrls=this._parallelUploadUrls:e.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,e).then((function(e){t._urlStorageKey=e}))}},{key:"_sendRequest",value:function(t){return lt(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,this.options)}}],r=[{key:"terminate",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=ct("DELETE",e,i);return lt(r,null,i).then((function(t){if(204!==t.getStatus())throw new H("tus: unexpected response while terminating upload",null,r,t)})).catch((function(o){if(o instanceof H||(o=new H("tus: failed to terminate upload",o,r,null)),!ht(o,0,i))throw o;var n=i.retryDelays[0],s=i.retryDelays.slice(1),a=J(J({},i),{},{retryDelays:s});return new Promise((function(t){return setTimeout(t,n)})).then((function(){return t.terminate(e,a)}))}))}}],i&&tt(e.prototype,i),r&&tt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,r}();function st(t){return Object.entries(t).map((function(t){var e=$(t,2),i=e[0],r=e[1];return"".concat(i," ").concat(_(String(r)))})).join(",")}function at(t,e){return t>=e&&t<e+100}function ct(t,e,i){var r=i.httpStack.createRequest(t,e);i.protocol===rt?r.setHeader("Upload-Draft-Interop-Version","5"):r.setHeader("Tus-Resumable","1.0.0");for(var o=i.headers||{},n=0,s=Object.entries(o);n<s.length;n++){var a=$(s[n],2),c=a[0],l=a[1];r.setHeader(c,l)}if(i.addRequestId){var u="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}));r.setHeader("X-Request-ID",u)}return r}function lt(t,e,i){return ut.apply(this,arguments)}function ut(){var t;return t=V().mark((function t(e,i,r){var o;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!=typeof r.onBeforeRequest){t.next=3;break}return t.next=3,r.onBeforeRequest(e);case 3:return t.next=5,e.send(i);case 5:if(o=t.sent,"function"!=typeof r.onAfterResponse){t.next=9;break}return t.next=9,r.onAfterResponse(e,o);case 9:return t.abrupt("return",o);case 10:case"end":return t.stop()}}),t)})),ut=function(){var e=this,i=arguments;return new Promise((function(r,o){var n=t.apply(e,i);function s(t){W(n,r,o,s,a,"next",t)}function a(t){W(n,r,o,s,a,"throw",t)}s(void 0)}))},ut.apply(this,arguments)}function ht(t,e,i){return!(null==i.retryDelays||e>=i.retryDelays.length||null==t.originalRequest)&&(i&&"function"==typeof i.onShouldRetry?i.onShouldRetry(t,e,i):pt(t))}function pt(t){var e,i=t.originalResponse?t.originalResponse.getStatus():0;return(!at(i,400)||409===i||423===i)&&(e=!0,"undefined"!=typeof navigator&&!1===navigator.onLine&&(e=!1),e)}function dt(t,e){return new(M())(e,t).toString()}nt.defaultOptions=ot;const mt=nt;const ft=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};function gt(t){return new Promise((function(e,i){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var t=r.response;e(t)},r.onerror=function(t){i(t)},r.open("GET",t),r.send()}))}const vt=function(){return"undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova)};function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function bt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wt(r.key),r)}}function wt(t){var e=function(t,e){if("object"!=yt(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yt(e)?e:e+""}var St=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._file=e,this.size=e.size},(e=[{key:"slice",value:function(t,e){if(vt())return i=this._file.slice(t,e),new Promise((function(t,e){var r=new FileReader;r.onload=function(){var e=new Uint8Array(r.result);t({value:e})},r.onerror=function(t){e(t)},r.readAsArrayBuffer(i)}));var i,r=this._file.slice(t,e),o=e>=this.size;return Promise.resolve({value:r,done:o})}},{key:"close",value:function(){}}])&&bt(t.prototype,e),i&&bt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,i}();function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function Ct(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rt(r.key),r)}}function Rt(t){var e=function(t,e){if("object"!=xt(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xt(e)?e:e+""}function kt(t){return void 0===t?0:void 0!==t.size?t.size:t.length}var Et=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1},(e=[{key:"slice",value:function(t,e){return t<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(t,e)}},{key:"_readUntilEnoughDataOrDone",value:function(t,e){var i=this,r=e<=this._bufferOffset+kt(this._buffer);if(this._done||r){var o=this._getDataFromBuffer(t,e),n=null==o&&this._done;return Promise.resolve({value:o,done:n})}return this._reader.read().then((function(r){var o=r.value;return r.done?i._done=!0:void 0===i._buffer?i._buffer=o:i._buffer=function(t,e){if(t.concat)return t.concat(e);if(t instanceof Blob)return new Blob([t,e],{type:t.type});if(t.set){var i=new t.constructor(t.length+e.length);return i.set(t),i.set(e,t.length),i}throw new Error("Unknown data type")}(i._buffer,o),i._readUntilEnoughDataOrDone(t,e)}))}},{key:"_getDataFromBuffer",value:function(t,e){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var i=0===kt(this._buffer);return this._done&&i?null:this._buffer.slice(0,e-t)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])&&Ct(t.prototype,e),i&&Ct(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,i}();function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function At(){At=function(){return e};var t,e={},i=Object.prototype,r=i.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,i){return t[e]=i}}function u(t,e,i,r){var n=e&&e.prototype instanceof v?e:v,s=Object.create(n.prototype),a=new T(r||[]);return o(s,"_invoke",{value:E(t,i,a)}),s}function h(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p="suspendedStart",d="suspendedYield",m="executing",f="completed",g={};function v(){}function y(){}function b(){}var w={};l(w,s,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(_([])));x&&x!==i&&r.call(x,s)&&(w=x);var C=b.prototype=v.prototype=Object.create(w);function R(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function i(o,n,s,a){var c=h(t[o],t,n);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==Pt(u)&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(u).then((function(t){l.value=t,s(l)}),(function(t){return i("throw",t,s,a)}))}a(c.arg)}var n;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){i(t,r,e,o)}))}return n=n?n.then(o,o):o()}})}function E(e,i,r){var o=p;return function(n,s){if(o===m)throw Error("Generator is already running");if(o===f){if("throw"===n)throw s;return{value:t,done:!0}}for(r.method=n,r.arg=s;;){var a=r.delegate;if(a){var c=P(a,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var l=h(e,i,r);if("normal"===l.type){if(o=r.done?f:d,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=f,r.method="throw",r.arg=l.arg)}}}function P(e,i){var r=i.method,o=e.iterator[r];if(o===t)return i.delegate=null,"throw"===r&&e.iterator.return&&(i.method="return",i.arg=t,P(e,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var n=h(o,e.iterator,i.arg);if("throw"===n.type)return i.method="throw",i.arg=n.arg,i.delegate=null,g;var s=n.arg;return s?s.done?(i[e.resultName]=s.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):s:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function _(e){if(e||""===e){var i=e[s];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,n=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return n.next=n}}throw new TypeError(Pt(e)+" is not iterable")}return y.prototype=b,o(C,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,c,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},R(k.prototype),l(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,i,r,o,n){void 0===n&&(n=Promise);var s=new k(u(t,i,r,o),n);return e.isGeneratorFunction(i)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},R(C),l(C,c,"Generator"),l(C,s,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var r in e)i.push(r);return i.reverse(),function t(){for(;i.length;){var r=i.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=_,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function o(r,o){return a.type="throw",a.arg=e,i.next=r,o&&(i.method="next",i.arg=t),!!o}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var s=n?n.completion:{};return s.type=t,s.arg=e,n?(this.method="next",this.next=n.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),D(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var o=r.arg;D(i)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,i,r){return this.delegate={iterator:_(e),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function Dt(t,e,i,r,o,n,s){try{var a=t[n](s),c=a.value}catch(H){return void i(H)}a.done?e(c):Promise.resolve(c).then(r,o)}function Tt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_t(r.key),r)}}function _t(t){var e=function(t,e){if("object"!=Pt(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=Pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Pt(e)?e:e+""}var Ut=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"openFile",value:(r=At().mark((function t(e,i){var r;return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ft()||!e||void 0===e.uri){t.next=11;break}return t.prev=1,t.next=4,gt(e.uri);case 4:return r=t.sent,t.abrupt("return",new St(r));case 8:throw t.prev=8,t.t0=t.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(t.t0));case 11:if("function"!=typeof e.slice||void 0===e.size){t.next=13;break}return t.abrupt("return",Promise.resolve(new St(e)));case 13:if("function"!=typeof e.read){t.next=18;break}if(i=Number(i),Number.isFinite(i)){t.next=17;break}return t.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return t.abrupt("return",Promise.resolve(new Et(e,i)));case 18:return t.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return t.stop()}}),t,null,[[1,8]])})),o=function(){var t=this,e=arguments;return new Promise((function(i,o){var n=r.apply(t,e);function s(t){Dt(n,i,o,s,a,"next",t)}function a(t){Dt(n,i,o,s,a,"throw",t)}s(void 0)}))},function(t,e){return o.apply(this,arguments)})}],e&&Tt(t.prototype,e),i&&Tt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,i,r,o}();function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ot(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,It(r.key),r)}}function Nt(t,e,i){return e&&Ot(t.prototype,e),i&&Ot(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function It(t){var e=function(t,e){if("object"!=Mt(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=Mt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Mt(e)?e:e+""}var Ft=function(){return Nt((function t(){Lt(this,t)}),[{key:"createRequest",value:function(t,e){return new zt(t,e)}},{key:"getName",value:function(){return"XHRHttpStack"}}])}(),zt=function(){return Nt((function t(e,i){Lt(this,t),this._xhr=new XMLHttpRequest,this._xhr.open(e,i,!0),this._method=e,this._url=i,this._headers={}}),[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(t,e){this._xhr.setRequestHeader(t,e),this._headers[t]=e}},{key:"getHeader",value:function(t){return this._headers[t]}},{key:"setProgressHandler",value:function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(e){e.lengthComputable&&t(e.loaded)})}},{key:"send",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(i,r){t._xhr.onload=function(){i(new jt(t._xhr))},t._xhr.onerror=function(t){r(t)},t._xhr.send(e)}))}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}(),jt=function(){return Nt((function t(e){Lt(this,t),this._xhr=e}),[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(t){return this._xhr.getResponseHeader(t)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}();function Yt(t){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yt(t)}function Ht(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Bt(r.key),r)}}function Bt(t){var e=function(t,e){if("object"!=Yt(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=Yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Yt(e)?e:e+""}var qt=!1;try{qt="localStorage"in window;var Vt="tusSupport",Wt=localStorage.getItem(Vt);localStorage.setItem(Vt,Wt),null===Wt&&localStorage.removeItem(Vt)}catch(pe){if(pe.code!==pe.SECURITY_ERR&&pe.code!==pe.QUOTA_EXCEEDED_ERR)throw pe;qt=!1}var $t=qt,Xt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"findAllUploads",value:function(){var t=this._findEntries("tus::");return Promise.resolve(t)}},{key:"findUploadsByFingerprint",value:function(t){var e=this._findEntries("tus::".concat(t,"::"));return Promise.resolve(e)}},{key:"removeUpload",value:function(t){return localStorage.removeItem(t),Promise.resolve()}},{key:"addUpload",value:function(t,e){var i=Math.round(1e12*Math.random()),r="tus::".concat(t,"::").concat(i);return localStorage.setItem(r,JSON.stringify(e)),Promise.resolve(r)}},{key:"_findEntries",value:function(t){for(var e=[],i=0;i<localStorage.length;i++){var r=localStorage.key(i);if(0===r.indexOf(t))try{var o=JSON.parse(localStorage.getItem(r));o.urlStorageKey=r,e.push(o)}catch(n){}}return e}}],e&&Ht(t.prototype,e),i&&Ht(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,i}();function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Gt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,oe(r.key),r)}}function Zt(t,e,i){return e=Qt(e),function(t,e){if(e&&("object"===Kt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Jt()?Reflect.construct(e,i||[],Qt(t).constructor):e.apply(t,i))}function Jt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Jt=function(){return!!t})()}function Qt(t){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qt(t)}function te(t,e){return te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},te(t,e)}function ee(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function ie(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ee(Object(i),!0).forEach((function(e){re(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ee(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function re(t,e,i){return(e=oe(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function oe(t){var e=function(t,e){if("object"!=Kt(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=Kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Kt(e)?e:e+""}var ne=ie(ie({},mt.defaultOptions),{},{httpStack:new Ft,fileReader:new Ut,urlStorage:$t?new Xt:new d,fingerprint:function(t,e){return ft()?Promise.resolve(function(t,e){var i=t.exif?function(t){var e=0;if(0===t.length)return e;for(var i=0;i<t.length;i++){e=(e<<5)-e+t.charCodeAt(i),e&=e}return e}(JSON.stringify(t.exif)):"noexif";return["tus-rn",t.name||"noname",t.size||"nosize",i,e.endpoint].join("/")}(t,e)):Promise.resolve(["tus-br",t.name,t.type,t.size,t.lastModified,e.endpoint].join("-"))}}),se=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zt(this,e,[t,i=ie(ie({},ne),i)])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&te(t,e)}(e,t),i=e,o=[{key:"terminate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=ie(ie({},ne),e),mt.terminate(t,e)}}],(r=null)&&Gt(i.prototype,r),o&&Gt(i,o),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,o}(mt);"function"==typeof XMLHttpRequest&&"function"==typeof Blob&&Blob.prototype.slice;const ae="4.3.2";function ce(t){return(e,i)=>{if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova)||"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return ne.fingerprint(e,i);const r=["tus",t.id,i.endpoint].join("-");return Promise.resolve(r)}}const le={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},ue={limit:20,retryDelays:le.retryDelays,withCredentials:!1,allowedMetaFields:!0};class he extends r.A{static VERSION=ae;#H;requests;uploaders;uploaderEvents;constructor(t,e){if(super(t,{...ue,...e}),this.type="uploader",this.id=this.opts.id||"Tus",void 0===e?.allowedMetaFields&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in e)throw new Error("The `autoRetry` option was deprecated and has been removed.");this.requests=this.opts.rateLimitedQueue??new l(this.opts.limit),this.#H=this.opts.retryDelays?.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}resetUploaderReferences(t,e){const i=this.uploaders[t];i&&(i.abort(),e?.abort&&i.abort(!0),this.uploaders[t]=null),this.uploaderEvents[t]&&(this.uploaderEvents[t].remove(),this.uploaderEvents[t]=null)}#B(t){return this.resetUploaderReferences(t.id),new Promise(((e,i)=>{let r,c,l;const u={...this.opts,...t.tus||{}};"function"==typeof u.headers&&(u.headers=u.headers(t));const{onShouldRetry:h,onBeforeRequest:p,...d}=u,m={...le,...d};m.fingerprint=ce(t),m.onBeforeRequest=async e=>{let i;if(e.getUnderlyingObject().withCredentials=!!u.withCredentials,"function"==typeof p&&(i=p(e,t)),(0,n.A)(r,"shouldBeRequeued")){if(!r.shouldBeRequeued)return Promise.reject();let e;const o=new Promise((t=>{e=t}));return r=this.requests.run((()=>(t.isPaused&&r.abort(),e(),()=>{}))),void await Promise.all([o,i])}return i},m.onError=e=>{this.uppy.log(e);const o=null!=e.originalRequest?e.originalRequest.getUnderlyingObject():null;s(o)&&(e=new a.A(e,o)),this.resetUploaderReferences(t.id),r?.abort(),"function"==typeof u.onError&&u.onError(e),i(e)},m.onProgress=(e,i)=>{this.onReceiveUploadUrl(t,l.url),"function"==typeof u.onProgress&&u.onProgress(e,i);const r=this.uppy.getFile(t.id);this.uppy.emit("upload-progress",r,{uploadStarted:r.progress.uploadStarted??0,bytesUploaded:e,bytesTotal:i})},m.onSuccess=i=>{const o={uploadURL:l.url??void 0,status:200,body:{xhr:i.lastResponse.getUnderlyingObject()}};if(this.uppy.emit("upload-success",this.uppy.getFile(t.id),o),this.resetUploaderReferences(t.id),r.done(),l.url){const{name:t}=l.file;this.uppy.log(`Download ${t} from ${l.url}`)}"function"==typeof u.onSuccess&&u.onSuccess(i),e(l)};const f=t=>{const e=t?.originalResponse?.getStatus();if(429===e){if(!this.requests.isPaused){const t=this.#H?.next();if(null==t||t.done)return!1;this.requests.rateLimit(t.value)}}else{if(null!=e&&e>=400&&e<500&&409!==e&&423!==e)return!1;"undefined"!=typeof navigator&&!1===navigator.onLine&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener("online",(()=>{this.requests.resume()}),{once:!0})))}return r.abort(),r={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0};m.onShouldRetry=null!=h?(t,e)=>h(t,e,u,f):f;const g=(t,e,i)=>{(0,n.A)(t,e)&&!(0,n.A)(t,i)&&(t[i]=t[e])},v={},y=function(t,e){return!0===t?Object.keys(e):Array.isArray(t)?t:[]}(u.allowedMetaFields,t.meta);y.forEach((e=>{v[e]=String(t.meta[e])})),g(v,"type","filetype"),g(v,"name","filename"),m.metadata=v,l=new se(t.data,m),this.uploaders[t.id]=l;const b=new o(this.uppy);this.uploaderEvents[t.id]=b,c=()=>(t.isPaused||l.start(),()=>{}),l.findPreviousUploads().then((e=>{const i=e[0];i&&(this.uppy.log(`[Tus] Resuming upload of ${t.id} started at ${i.creationTime}`),l.resumeFromPreviousUpload(i)),r=this.requests.run(c)})),b.onFileRemove(t.id,(i=>{r.abort(),this.resetUploaderReferences(t.id,{abort:!!l.url}),e(`upload ${i} was removed`)})),b.onPause(t.id,(t=>{r.abort(),t?l.abort():r=this.requests.run(c)})),b.onPauseAll(t.id,(()=>{r.abort(),l.abort()})),b.onCancelAll(t.id,(()=>{r.abort(),this.resetUploaderReferences(t.id,{abort:!!l.url}),e(`upload ${t.id} was canceled`)})),b.onResumeAll(t.id,(()=>{r.abort(),t.error&&l.abort(),r=this.requests.run(c)}))})).catch((e=>{throw this.uppy.emit("upload-error",t,e),e}))}onReceiveUploadUrl(t,e){const i=this.uppy.getFile(t.id);i&&(i.tus&&i.tus.uploadUrl===e||(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(i.id,{tus:{...i.tus,uploadUrl:e}})))}#q(t){const e={...this.opts};return t.tus&&Object.assign(e,t.tus),"function"==typeof e.headers&&(e.headers=e.headers(t)),{...t.remote?.body,endpoint:e.endpoint,uploadUrl:e.uploadUrl,protocol:"tus",size:t.data.size,headers:e.headers,metadata:t.meta}}async#V(t){const e=function(t){return t.filter((t=>!(t=>"error"in t&&!!t.error)(t)))}(t),i=function(t){return t.filter((t=>!t.progress?.uploadStarted||!t.isRestored))}(e);this.uppy.emit("upload-start",i),await Promise.allSettled(e.map((t=>{if(t.isRemote){const e=()=>this.requests,i=new AbortController,r=e=>{e.id===t.id&&i.abort()};this.uppy.on("file-removed",r);const o=this.uppy.getRequestClientForFile(t).uploadRemoteFile(t,this.#q(t),{signal:i.signal,getQueue:e});return this.requests.wrapSyncFunction((()=>{this.uppy.off("file-removed",r)}),{priority:-1})(),o}return this.#B(t)})))}#W=async t=>{if(0===t.length)return void this.uppy.log("[Tus] No files to upload");0===this.opts.limit&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");const e=this.uppy.getFilesByIds(t);await this.#V(e)};install(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!0}}),this.uppy.addUploader(this.#W)}uninstall(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!1}}),this.uppy.removeUploader(this.#W)}}},9355:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(10201),o=i(5666),n=i(31837),s=i(3103);i(50172);const a="4.4.2",c={strings:{pluginNameUnsplash:"Unsplash"}};class l extends n.A{static VERSION=a;icon;provider;view;storage;files;hostname;constructor(t,e){if(super(t,e),this.type="acquirer",this.files=[],this.storage=this.opts.storage||o.HM,this.id=this.opts.id||"Unsplash",this.defaultLocale=c,this.i18nInit(),this.title=this.i18n("pluginNameUnsplash"),this.icon=()=>(0,r.Y)("svg",{className:"uppy-DashboardTab-iconUnsplash",viewBox:"0 0 32 32",height:"32",width:"32","aria-hidden":"true",children:(0,r.FD)("g",{fill:"currentcolor",children:[(0,r.Y)("path",{d:"M46.575 10.883v-9h12v9zm12 5h10v18h-32v-18h10v9h12z"}),(0,r.Y)("path",{d:"M13 12.5V8h6v4.5zm6 2.5h5v9H8v-9h5v4.5h6z"})]})}),!this.opts.companionUrl)throw new Error("Companion hostname is required, please consult https://uppy.io/docs/companion");this.hostname=this.opts.companionUrl,this.opts.companionAllowedHosts=(0,o.cP)(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new o.YL(t,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule,provider:"unsplash",pluginId:this.id})}install(){this.view=new s.un(this,{provider:this.provider,viewType:"unsplash",showFilter:!0,utmSource:this.opts.utmSource});const{target:t}=this.opts;t&&this.mount(t,this)}render(t){return this.view.render(t)}uninstall(){this.unmount()}}},68293:(t,e,i)=>{"use strict";i.d(e,{A:()=>g});var r=i(10201),o=i(5666),n=i(31837),s=i(19542),a=i(50172);const c="4.3.2",l={strings:{pluginNameUrl:"Link",import:"Import",enterUrlToImport:"Enter URL to import a file",failedToFetch:"Companion failed to fetch this URL, please make sure it\u2019s correct",enterCorrectUrl:"Incorrect URL: Please make sure you are entering a direct link to a file"}};var u=i(8423);class h extends a.uA{form=document.createElement("form");input;constructor(t){super(t),this.form.id=(0,u.A)()}componentDidMount(){this.input.value="",this.form.addEventListener("submit",this.#$),document.body.appendChild(this.form)}componentWillUnmount(){this.form.removeEventListener("submit",this.#$),document.body.removeChild(this.form)}#$=t=>{t.preventDefault();const{addFile:e}=this.props;e(this.input.value.trim())};render(){const{i18n:t}=this.props;return(0,r.FD)("div",{className:"uppy-Url",children:[(0,r.Y)("input",{className:"uppy-u-reset uppy-c-textInput uppy-Url-input",type:"text","aria-label":t("enterUrlToImport"),placeholder:t("enterUrlToImport"),ref:t=>{this.input=t},"data-uppy-super-focusable":!0,form:this.form.id}),(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Url-importButton",type:"submit",form:this.form.id,children:t("import")})]})}}const p=h;function d(t,e,i){const r=(0,s.A)(t.items);let o;switch(e){case"paste":if(r.some((t=>"file"===t.kind)))return;o=r.filter((t=>"string"===t.kind&&"text/plain"===t.type));break;case"drop":o=r.filter((t=>"string"===t.kind&&"text/uri-list"===t.type));break;default:throw new Error(`isDropOrPaste must be either 'drop' or 'paste', but it's ${e}`)}o.forEach((t=>{t.getAsString((t=>i(t)))}))}function m(){return(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:(0,r.Y)("path",{d:"M23.637 15.312l-2.474 2.464a3.582 3.582 0 01-.577.491c-.907.657-1.897.986-2.968.986a4.925 4.925 0 01-3.959-1.971c-.248-.329-.164-.902.165-1.149.33-.247.907-.164 1.155.164 1.072 1.478 3.133 1.724 4.618.656a.642.642 0 00.33-.328l2.473-2.463c1.238-1.313 1.238-3.366-.082-4.597a3.348 3.348 0 00-4.618 0l-1.402 1.395a.799.799 0 01-1.154 0 .79.79 0 010-1.15l1.402-1.394a4.843 4.843 0 016.843 0c2.062 1.805 2.144 5.007.248 6.896zm-8.081 5.664l-1.402 1.395a3.348 3.348 0 01-4.618 0c-1.319-1.23-1.319-3.365-.082-4.596l2.475-2.464.328-.328c.743-.492 1.567-.739 2.475-.657.906.165 1.648.574 2.143 1.314.248.329.825.411 1.155.165.33-.248.412-.822.165-1.15-.825-1.068-1.98-1.724-3.216-1.888-1.238-.247-2.556.082-3.628.902l-.495.493-2.474 2.464c-1.897 1.969-1.814 5.09.083 6.977.99.904 2.226 1.396 3.463 1.396s2.473-.492 3.463-1.395l1.402-1.396a.79.79 0 000-1.15c-.33-.328-.908-.41-1.237-.082z",fill:"#FF753E","fill-rule":"nonzero"})})}function f(t){const{pathname:e}=new URL(t);return e.substring(e.lastIndexOf("/")+1)}class g extends n.A{static VERSION=c;static requestClientId=g.name;icon;hostname;client;canHandleRootDrop;constructor(t,e){if(super(t,e),this.id=this.opts.id||"Url",this.type="acquirer",this.icon=()=>(0,r.Y)(m,{}),this.defaultLocale=l,this.i18nInit(),this.title=this.i18n("pluginNameUrl"),this.hostname=this.opts.companionUrl,!this.hostname)throw new Error("Companion hostname is required, please consult https://uppy.io/docs/companion");this.client=new o.R0(t,{pluginId:this.id,provider:"url",companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule}),this.uppy.registerRequestClient(g.requestClientId,this.client)}getMeta=t=>this.client.post("url/meta",{url:t});addFile=async(t,e)=>{if(t.startsWith("blob"))return;const i=function(t){return/^[a-z0-9]+:\/\//.test(t)?t:"http://"+t}(t);if(!function(t){return t?.startsWith("http://")||t?.startsWith("https://")}(i))return this.uppy.log(`[URL] Incorrect URL entered: ${i}`),void this.uppy.info(this.i18n("enterCorrectUrl"),"error",4e3);this.uppy.log(`[URL] Adding file from dropped/pasted url: ${i}`);try{const t=await this.getMeta(i),o={meta:e,source:this.id,name:t.name||f(i),type:t.type,data:{size:t.size},isRemote:!0,body:{url:i},remote:{companionUrl:this.opts.companionUrl,url:`${this.hostname}/url/get`,body:{fileId:i,url:i},requestClientId:g.requestClientId}};this.uppy.log("[Url] Adding remote file");try{return this.uppy.addFile(o)}catch(r){return r.isRestriction||this.uppy.log(r),r}}catch(r){return this.uppy.log(r),this.uppy.info({message:this.i18n("failedToFetch"),details:r},"error",4e3),r}};handleRootDrop=t=>{d(t.dataTransfer,"drop",(t=>{this.addFile(t)}))};handleRootPaste=t=>{d(t.clipboardData,"paste",(t=>{this.addFile(t)}))};render(){return(0,r.Y)(p,{i18n:this.i18n,addFile:this.addFile})}install(){const{target:t}=this.opts;t&&this.mount(t,this)}uninstall(){this.unmount()}}g.prototype.canHandleRootDrop=function(t){return(0,s.A)(t.dataTransfer.items).filter((t=>"string"===t.kind&&"text/uri-list"===t.type)).length>0}},52094:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});class r extends Error{cause;isNetworkError;request;constructor(t,e=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=t,this.isNetworkError=!0,this.request=e}}const o=r},79885:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});const r={__proto__:null,"audio/mp3":"mp3","audio/mp4":"mp4","audio/ogg":"ogg","audio/webm":"webm","image/gif":"gif","image/heic":"heic","image/heif":"heif","image/jpeg":"jpg","image/webp":"webp","image/png":"png","image/svg+xml":"svg","video/mp4":"mp4","video/ogg":"ogv","video/quicktime":"mov","video/webm":"webm","video/x-matroska":"mkv","video/x-msvideo":"avi"};function o(t){return[t]=t.split(";",1),r[t]||null}},61825:(t,e,i)=>{"use strict";function r(t,e){return Object.hasOwn(t,e)}i.d(e,{A:()=>r})},11441:(t,e,i)=>{"use strict";i.d(e,{A:()=>P});var r=i(10201),o=i(31837);var n=i(79885),s=i(32889),a=i(5574),c=i(50172);const l="4.3.2";function u(){return(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",fill:"#0097DC",width:"66",height:"55",viewBox:"0 0 66 55",children:(0,r.Y)("path",{d:"M57.3 8.433c4.59 0 8.1 3.51 8.1 8.1v29.7c0 4.59-3.51 8.1-8.1 8.1H8.7c-4.59 0-8.1-3.51-8.1-8.1v-29.7c0-4.59 3.51-8.1 8.1-8.1h9.45l4.59-7.02c.54-.54 1.35-1.08 2.16-1.08h16.2c.81 0 1.62.54 2.16 1.08l4.59 7.02h9.45zM33 14.64c-8.62 0-15.393 6.773-15.393 15.393 0 8.62 6.773 15.393 15.393 15.393 8.62 0 15.393-6.773 15.393-15.393 0-8.62-6.773-15.393-15.393-15.393zM33 40c-5.648 0-9.966-4.319-9.966-9.967 0-5.647 4.318-9.966 9.966-9.966s9.966 4.319 9.966 9.966C42.966 35.681 38.648 40 33 40z",fillRule:"evenodd"})})}const h=function({onDiscard:t,i18n:e}){return(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--discard",type:"button",title:e("discardRecordedFile"),"aria-label":e("discardRecordedFile"),onClick:t,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{width:"13",height:"13",viewBox:"0 0 13 13",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon",children:(0,r.FD)("g",{fill:"#FFF",fillRule:"evenodd",children:[(0,r.Y)("path",{d:"M.496 11.367L11.103.76l1.414 1.414L1.911 12.781z"}),(0,r.Y)("path",{d:"M11.104 12.782L.497 2.175 1.911.76l10.607 10.606z"})]})})})};function p({recording:t,onStartRecording:e,onStopRecording:i,i18n:o}){return t?(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button",type:"button",title:o("stopRecording"),"aria-label":o("stopRecording"),onClick:i,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100",children:(0,r.Y)("rect",{x:"15",y:"15",width:"70",height:"70"})})}):(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button",type:"button",title:o("startRecording"),"aria-label":o("startRecording"),onClick:e,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100",children:(0,r.Y)("circle",{cx:"50",cy:"50",r:"40"})})})}function d({recordingLengthSeconds:t}){const e=(i=t,`${Math.floor(i/60)}:${String(i%60).padStart(2,"0")}`);var i;return(0,r.Y)("span",{children:e})}function m({onSnapshot:t,i18n:e}){return(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--picture",type:"button",title:e("takePicture"),"aria-label":e("takePicture"),onClick:t,"data-uppy-super-focusable":!0,children:u()})}const f=function({onSubmit:t,i18n:e}){return(0,r.Y)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--submit",type:"button",title:e("submitRecordedFile"),"aria-label":e("submitRecordedFile"),onClick:t,"data-uppy-super-focusable":!0,children:(0,r.Y)("svg",{width:"12",height:"9",viewBox:"0 0 12 9",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon",children:(0,r.Y)("path",{fill:"#fff",fillRule:"nonzero",d:"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z"})})})};function g({currentDeviceId:t,videoSources:e,onChangeVideoSource:i}){return(0,r.Y)("div",{className:"uppy-Webcam-videoSource",children:(0,r.Y)("select",{className:"uppy-u-reset uppy-Webcam-videoSource-select",onChange:t=>{i(t.target.value)},children:e.map((e=>(0,r.Y)("option",{value:e.deviceId,selected:e.deviceId===t,children:e.label},e.deviceId)))})})}function v(t,e){return t.includes(e)}class y extends c.uA{videoElement;refs;componentDidMount(){const{onFocus:t}=this.props;t()}componentWillUnmount(){const{onStop:t}=this.props;t()}render(){const{src:t,recordedVideo:e,capturedSnapshot:i,recording:o,modes:n,supportsRecording:s,videoSources:a,showVideoSourceDropdown:c,showRecordingLength:l,onSubmit:u,i18n:y,mirror:b,onSnapshot:w,onStartRecording:S,onStopRecording:x,onDiscardRecordedMedia:C,recordingLengthSeconds:R}=this.props,k=!!e,E=!!i,P=k||E,A=!P&&s&&(v(n,"video-only")||v(n,"audio-only")||v(n,"video-audio")),D=!P&&v(n,"picture"),T=s&&l&&!k,_=c&&a&&a.length>1,U={playsInline:!0};return e?(U.muted=!1,U.controls=!0,U.src=e,this.videoElement&&(this.videoElement.srcObject=null)):(U.muted=!0,U.autoPlay=!0,U.srcObject=t),(0,r.FD)("div",{className:"uppy uppy-Webcam-container",children:[(0,r.Y)("div",{className:"uppy-Webcam-videoContainer",children:!i||o||e?(0,r.Y)("video",{ref:t=>this.videoElement=t,className:"uppy-Webcam-video  "+(b?"uppy-Webcam-video--mirrored":""),...U}):(0,r.Y)("div",{className:"uppy-Webcam-imageContainer",children:(0,r.Y)("img",{src:i,className:"uppy-Webcam-video",alt:"capturedSnapshot"})})}),(0,r.FD)("div",{className:"uppy-Webcam-footer",children:[(0,r.Y)("div",{className:"uppy-Webcam-videoSourceContainer",children:_?g(this.props):null}),(0,r.FD)("div",{className:"uppy-Webcam-buttonContainer",children:[D&&(0,r.Y)(m,{onSnapshot:w,i18n:y}),A&&(0,r.Y)(p,{recording:o,onStartRecording:S,onStopRecording:x,i18n:y}),(k||E)&&(0,r.Y)(f,{onSubmit:u,i18n:y}),(k||E)&&(0,r.Y)(h,{onDiscard:C,i18n:y})]}),(0,r.Y)("div",{className:"uppy-Webcam-recordingLength",children:T&&(0,r.Y)(d,{recordingLengthSeconds:R})})]})]})}}const b=y,w={strings:{pluginNameCamera:"Camera",noCameraTitle:"Camera Not Available",noCameraDescription:"In order to take pictures or record video, please connect a camera device",recordingStoppedMaxSize:"Recording stopped because the file size is about to exceed the limit",submitRecordedFile:"Submit recorded file",discardRecordedFile:"Discard recorded file",smile:"Smile!",takePicture:"Take a picture",startRecording:"Begin video recording",stopRecording:"Stop video recording",recordingLength:"Recording length %{recording_length}",allowAccessTitle:"Please allow access to your camera",allowAccessDescription:"In order to take pictures or record video with your camera, please allow camera access for this site."}};function S({icon:t,i18n:e,hasCamera:i}){return(0,r.FD)("div",{className:"uppy-Webcam-permissons",children:[(0,r.Y)("div",{className:"uppy-Webcam-permissonsIcon",children:t()}),(0,r.Y)("div",{className:"uppy-Webcam-title",children:e(i?"allowAccessTitle":"noCameraTitle")}),(0,r.Y)("p",{children:e(i?"allowAccessDescription":"noCameraDescription")})]})}function x(t){return"."===t[0]?s.A[t.slice(1)]:t}function C(t){return/^video\/[^*]+$/.test(t)}function R(t){return/^image\/[^*]+$/.test(t)}function k(t,e){return t.includes(e)}const E={onBeforeSnapshot:()=>Promise.resolve(),countdown:!1,modes:["video-audio","video-only","audio-only","picture"],mirror:!0,showVideoSourceDropdown:!1,preferredImageMimeType:null,preferredVideoMimeType:null,showRecordingLength:!1,mobileNativeCamera:(0,a.isMobile)({tablet:!0})};class P extends o.A{static VERSION=l;#X;mediaDevices;supportsUserMedia;protocol;capturedMediaFile;icon;webcamActive;stream=null;recorder=null;recordingChunks=null;recordingLengthTimer;captureInProgress=!1;constructor(t,e){super(t,{...E,...e}),this.mediaDevices=navigator.mediaDevices,this.supportsUserMedia=!!this.mediaDevices,this.protocol=location.protocol.match(/https/i)?"https":"http",this.id=this.opts.id||"Webcam",this.type="acquirer",this.capturedMediaFile=null,this.icon=()=>(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:(0,r.Y)("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383",fillRule:"nonzero"})}),this.defaultLocale=w,this.i18nInit(),this.title=this.i18n("pluginNameCamera"),this.#X=this.opts.mirror,this.install=this.install.bind(this),this.setPluginState=this.setPluginState.bind(this),this.render=this.render.bind(this),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.takeSnapshot=this.takeSnapshot.bind(this),this.startRecording=this.startRecording.bind(this),this.stopRecording=this.stopRecording.bind(this),this.discardRecordedMedia=this.discardRecordedMedia.bind(this),this.submit=this.submit.bind(this),this.oneTwoThreeSmile=this.oneTwoThreeSmile.bind(this),this.focus=this.focus.bind(this),this.changeVideoSource=this.changeVideoSource.bind(this),this.webcamActive=!1,this.opts.countdown&&(this.opts.onBeforeSnapshot=this.oneTwoThreeSmile),this.setPluginState({hasCamera:!1,cameraReady:!1,cameraError:null,recordingLengthSeconds:0,videoSources:[],currentDeviceId:null,capturedSnapshot:null})}getStatus(){const{recordedVideo:t,capturedSnapshot:e,isRecording:i,cameraReady:r,cameraError:o}=this.getPluginState();return i?"recording":null!=t||null!=e?"captured":r?"ready":o?"error":"init"}setOptions(t){super.setOptions({...t,videoConstraints:{...this.opts.videoConstraints,...t?.videoConstraints}})}hasCameraCheck(){return this.mediaDevices?this.mediaDevices.enumerateDevices().then((t=>t.some((t=>"videoinput"===t.kind)))):Promise.resolve(!1)}isAudioOnly(){return 1===this.opts.modes.length&&"audio-only"===this.opts.modes[0]}getConstraints(t=null){const e=-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("audio-only"),i=!this.isAudioOnly()&&(-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("video-only")||-1!==this.opts.modes.indexOf("picture")),r={...this.opts.videoConstraints||{},...null!=t&&{deviceId:t}};return{audio:e,video:!!i&&r}}start(t=null){if(!this.supportsUserMedia)return Promise.reject(new Error("Webcam access not supported"));this.webcamActive=!0,this.opts.mirror&&(this.#X=!0);const e=this.getConstraints(t?.deviceId);this.hasCameraCheck().then((i=>(this.setPluginState({hasCamera:i}),this.mediaDevices.getUserMedia(e).then((e=>{this.stream=e;let i=null;const r=this.isAudioOnly()?e.getAudioTracks():e.getVideoTracks();t&&t.deviceId?r.forEach((e=>{e.getSettings().deviceId===t.deviceId&&(i=e.getSettings().deviceId)})):i=r[0].getSettings().deviceId,this.updateVideoSources(),this.setPluginState({currentDeviceId:i,cameraReady:!0})})).catch((t=>{this.setPluginState({cameraReady:!1,cameraError:t}),this.uppy.info(t.message,"error")})))))}getMediaRecorderOptions(){const t={};if(MediaRecorder.isTypeSupported){const{restrictions:e}=this.uppy.opts;let i=[];this.opts.preferredVideoMimeType?i=[this.opts.preferredVideoMimeType]:e.allowedFileTypes&&(i=e.allowedFileTypes.map(x).filter(C));const r=t=>MediaRecorder.isTypeSupported(t)&&(0,n.A)(t),o=i.filter(r);o.length>0&&(t.mimeType=o[0])}return t}startRecording(){this.recorder=new MediaRecorder(this.stream,this.getMediaRecorderOptions()),this.recordingChunks=[];let t=!1;this.recorder.addEventListener("dataavailable",(e=>{this.recordingChunks.push(e.data);const{restrictions:i}=this.uppy.opts;if(this.recordingChunks.length>1&&null!=i.maxFileSize&&!t){const e=this.recordingChunks.reduce(((t,e)=>t+e.size),0),r=3*((e-this.recordingChunks[0].size)/(this.recordingChunks.length-1));e>Math.max(0,i.maxFileSize-r)&&(t=!0,this.uppy.info(this.i18n("recordingStoppedMaxSize"),"warning",4e3),this.stopRecording())}})),this.recorder.start(500),this.opts.showRecordingLength&&(this.recordingLengthTimer=setInterval((()=>{const t=this.getPluginState().recordingLengthSeconds;this.setPluginState({recordingLengthSeconds:t+1})}),1e3)),this.setPluginState({isRecording:!0})}stopRecording(){return new Promise((t=>{this.recorder.addEventListener("stop",(()=>{t()})),this.recorder.stop(),this.opts.showRecordingLength&&(clearInterval(this.recordingLengthTimer),this.setPluginState({recordingLengthSeconds:0}))})).then((()=>(this.setPluginState({isRecording:!1}),this.getVideo()))).then((t=>{try{this.capturedMediaFile=t,this.setPluginState({recordedVideo:URL.createObjectURL(t.data)}),this.#X=!1}catch(e){e.isRestriction||this.uppy.log(e)}})).then((()=>{this.recordingChunks=null,this.recorder=null}),(t=>{throw this.recordingChunks=null,this.recorder=null,t}))}discardRecordedMedia(){const{recordedVideo:t,capturedSnapshot:e}=this.getPluginState();t&&URL.revokeObjectURL(t),e&&URL.revokeObjectURL(e),this.setPluginState({recordedVideo:null,capturedSnapshot:null}),this.opts.mirror&&(this.#X=!0),this.capturedMediaFile=null}submit(){try{this.capturedMediaFile&&this.uppy.addFile(this.capturedMediaFile)}catch(t){t.isRestriction||this.uppy.log(t,"error")}}async stop(){if(this.stream){const t=this.stream.getAudioTracks(),e=this.stream.getVideoTracks();t.concat(e).forEach((t=>t.stop()))}this.recorder&&await new Promise((t=>{this.recorder.addEventListener("stop",t,{once:!0}),this.recorder.stop(),this.opts.showRecordingLength&&clearInterval(this.recordingLengthTimer)})),this.recordingChunks=null,this.recorder=null,this.webcamActive=!1,this.stream=null,this.setPluginState({recordedVideo:null,capturedSnapshot:null,isRecording:!1,recordingLengthSeconds:0})}getVideoElement(){return this.el.querySelector(".uppy-Webcam-video")}oneTwoThreeSmile(){return new Promise(((t,e)=>{let i=this.opts.countdown;const r=setInterval((()=>{if(!this.webcamActive)return clearInterval(r),this.captureInProgress=!1,e(new Error("Webcam is not active"));i?(this.uppy.info(`${i}...`,"warning",800),i--):(clearInterval(r),this.uppy.info(this.i18n("smile"),"success",1500),setTimeout((()=>t()),1500))}),1e3)}))}async takeSnapshot(){if(!this.captureInProgress){this.captureInProgress=!0;try{await this.opts.onBeforeSnapshot()}catch(t){const e="object"==typeof t?t.message:t;throw this.uppy.info(e,"error",5e3),new Error(`onBeforeSnapshot: ${e}`)}try{const t=await this.getImage();this.capturedMediaFile=t;const e=URL.createObjectURL(t.data);this.setPluginState({capturedSnapshot:e}),this.captureInProgress=!1}catch(e){this.captureInProgress=!1,e.isRestriction||this.uppy.log(e)}}}getImage(){const t=this.getVideoElement();if(!t)return Promise.reject(new Error("No video element found, likely due to the Webcam tab being closed."));const e=t.videoWidth,i=t.videoHeight,r=document.createElement("canvas");r.width=e,r.height=i;r.getContext("2d").drawImage(t,0,0);const{restrictions:o}=this.uppy.opts;let s=[];this.opts.preferredImageMimeType?s=[this.opts.preferredImageMimeType]:o.allowedFileTypes&&(s=o.allowedFileTypes.map(x).filter(R));const a=s[0]||"image/jpeg",c=(0,n.A)(a)||"jpg",l=`cam-${Date.now()}.${c}`;return function(t,e,i){return new Promise((r=>{t.toBlob(r,e,i)}))}(r,a).then((t=>({source:this.id,name:l,data:new Blob([t],{type:a}),type:a})))}getVideo(){const t=this.recordingChunks.find((t=>t.type?.length>0)).type,e=(0,n.A)(t);if(!e)return Promise.reject(new Error(`Could not retrieve recording: Unsupported media type "${t}"`));const i=`webcam-${Date.now()}.${e}`,r=new Blob(this.recordingChunks,{type:t}),o={source:this.id,name:i,data:new Blob([r],{type:t}),type:t};return Promise.resolve(o)}focus(){this.opts.countdown&&setTimeout((()=>{this.uppy.info(this.i18n("smile"),"success",1500)}),1e3)}changeVideoSource(t){this.stop(),this.start({deviceId:t})}updateVideoSources(){this.mediaDevices.enumerateDevices().then((t=>{this.setPluginState({videoSources:t.filter((t=>"videoinput"===t.kind))})}))}render(){this.webcamActive||this.start();const t=this.getPluginState();return t.cameraReady&&t.hasCamera?(0,r.Y)(b,{...t,onChangeVideoSource:this.changeVideoSource,onSnapshot:this.takeSnapshot,onStartRecording:this.startRecording,onStopRecording:this.stopRecording,onDiscardRecordedMedia:this.discardRecordedMedia,onSubmit:this.submit,onFocus:this.focus,onStop:this.stop,i18n:this.i18n,modes:this.opts.modes,showRecordingLength:this.opts.showRecordingLength,showVideoSourceDropdown:this.opts.showVideoSourceDropdown,supportsRecording:"function"==typeof MediaRecorder&&!!MediaRecorder.prototype&&"function"==typeof MediaRecorder.prototype.start,recording:t.isRecording,mirror:this.#X,src:this.stream}):(0,r.Y)(S,{icon:u,i18n:this.i18n,hasCamera:t.hasCamera})}install(){const{mobileNativeCamera:t,modes:e,videoConstraints:i}=this.opts,{target:r}=this.opts;t&&r?this.getTargetPlugin(r)?.setOptions({showNativeVideoCameraButton:k(e,"video-only")||k(e,"video-audio"),showNativePhotoCameraButton:k(e,"picture"),nativeCameraFacingMode:i?.facingMode}):(this.setPluginState({cameraReady:!1,recordingLengthSeconds:0}),r&&this.mount(r,this),this.mediaDevices&&(this.updateVideoSources(),this.mediaDevices.ondevicechange=()=>{if(this.updateVideoSources(),this.stream){let t=!0;const{videoSources:e,currentDeviceId:i}=this.getPluginState();e.forEach((e=>{i===e.deviceId&&(t=!1)})),t&&(this.stop(),this.start())}}))}uninstall(){this.stop(),this.unmount()}onUnmount(){this.stop()}}},49172:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(10201),o=i(5666),n=i(31837),s=i(3103);i(50172);const a="3.3.2",c={strings:{pluginNameZoom:"Zoom"}};class l extends n.A{static VERSION=a;icon;provider;view;storage;files;rootFolderId=null;constructor(t,e){super(t,e),this.type="acquirer",this.files=[],this.storage=this.opts.storage||o.HM,this.id=this.opts.id||"Zoom",this.icon=()=>(0,r.Y)("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:(0,r.Y)("path",{d:"M24.5 11.125l-2.75 2.063c-.473.353-.75.91-.75 1.5v3.124c0 .59.277 1.147.75 1.5l2.75 2.063a.938.938 0 001.5-.75v-8.75a.938.938 0 00-1.5-.75zm-4.75 9.5c0 1.035-.84 1.875-1.875 1.875H9.75A3.75 3.75 0 016 18.75v-6.875C6 10.84 6.84 10 7.875 10H16a3.75 3.75 0 013.75 3.75v6.875z",fill:"#2E8CFF","fill-rule":"evenodd"})}),this.opts.companionAllowedHosts=(0,o.cP)(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new o.Kq(t,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"zoom",pluginId:this.id,supportsRefreshToken:!1}),this.defaultLocale=c,this.i18nInit(),this.title=this.i18n("pluginNameZoom"),this.render=this.render.bind(this)}install(){this.view=new s.gi(this,{provider:this.provider});const{target:t}=this.opts;t&&this.mount(t,this)}uninstall(){this.view.tearDown(),this.unmount()}render(t){return this.view.render(t)}}}}]);