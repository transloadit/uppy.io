"use strict";(globalThis.webpackChunkuppy_io=globalThis.webpackChunkuppy_io||[]).push([[687],{27588:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>c,default:()=>m,frontMatter:()=>d,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"sources/ai-image","title":"AI image generator","description":"The @uppy/image-generator plugin lets users generate images from text prompts","source":"@site/docs/sources/ai-image.mdx","sourceDirName":"sources","slug":"/ai-image","permalink":"/docs/ai-image","draft":false,"unlisted":false,"editUrl":"https://github.com/transloadit/uppy.io/blob/main/docs/sources/ai-image.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"slug":"/ai-image"},"sidebar":"tutorialSidebar","previous":{"title":"File input","permalink":"/docs/file-input"},"next":{"title":"Transloadit","permalink":"/docs/transloadit"}}');var r=t(74848),i=t(28453),a=t(11470),o=t(19365),l=t(65171);const d={sidebar_position:4,slug:"/ai-image"},c="AI image generator",p={},h=[{value:"When should I use this?",id:"when-should-i-use-this",level:2},{value:"Install",id:"install",level:2},{value:"Use",id:"use",level:2},{value:"1. Client-side Uppy setup",id:"1-client-side-uppy-setup",level:3},{value:"2. Server-side: signing Transloadit parameters (Node.js)",id:"2-server-side-signing-transloadit-parameters-nodejs",level:3},{value:"API",id:"api",level:2},{value:"Options",id:"options",level:3},{value:"<code>id</code>",id:"id",level:4},{value:"<code>target</code>",id:"target",level:4},{value:"<code>assemblyOptions</code>",id:"assemblyoptions",level:4}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"ai-image-generator",children:"AI image generator"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"@uppy/image-generator"})," plugin lets users generate images from text prompts\nusing\n",(0,r.jsxs)(n.a,{href:"https://transloadit.com/docs/robots/image-generate/",children:["Transloadit\u2019s \ud83e\udd16 ",(0,r.jsx)(n.code,{children:"/image/generate"})," Robot"]}),".\nUnder the hood it asks your backend for signed Transloadit parameters, sends\nthose to Transloadit, and then lets users pick the generated images as if they\nwere regular files."]}),"\n",(0,r.jsxs)(n.p,{children:["You can learn more about the underlying AI service and common use cases in\nTransloadit\u2019s blog post\n",(0,r.jsx)(n.a,{href:"https://transloadit.com/blog/2025/04/ai-image-generation/",children:"\u201cGenerate stunning images from text using AI\u201d"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["The plugin focuses on wiring Uppy into Transloadit\u2019s AI image generation. It\ndoes ",(0,r.jsx)(n.strong,{children:"not"})," manage your Transloadit Templates for you \u2014 instead, you send\n",(0,r.jsx)(n.code,{children:"steps"})," at runtime from your server, similar to the \u201coverruling templates at\nruntime\u201d flow described\n",(0,r.jsx)(n.a,{href:"https://transloadit.com/docs/topics/templates/#overruling-templates-at-runtime",children:"in the Transloadit docs"}),"."]})}),"\n",(0,r.jsx)(n.h2,{id:"when-should-i-use-this",children:"When should I use this?"}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"@uppy/image-generator"})," when you want users to generate images on the fly\ninstead of uploading existing files. Typical examples:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Product mockups or marketing visuals where users describe the scene instead of\nuploading photos."}),"\n",(0,r.jsx)(n.li,{children:"Illustrations for documents, blog posts, or educational content."}),"\n",(0,r.jsx)(n.li,{children:"Quick concept art, avatars, or backgrounds that are generated as part of your\napp\u2019s flow."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"install",children:"Install"}),"\n",(0,r.jsxs)(a.A,{children:[(0,r.jsx)(o.A,{value:"npm",label:"NPM",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"npm install @uppy/image-generator\n"})})}),(0,r.jsx)(o.A,{value:"yarn",label:"Yarn",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"yarn add @uppy/image-generator\n"})})}),(0,r.jsx)(o.A,{value:"cdn",label:"CDN",children:(0,r.jsx)(l.A,{children:"\n        import { Uppy, Dashboard, ImageGenerator } from \"{{UPPY_JS_URL}}\"\n\n        const uppy = new Uppy()\n        uppy.use(Dashboard, { inline: true, target: 'body' })\n        uppy.use(ImageGenerator, {\n          assemblyOptions: async (prompt) => {\n            const res = await fetch(`/assembly-options?prompt=${encodeURIComponent(prompt)}`)\n            return res.json()\n          },\n        })\n      "})})]}),"\n",(0,r.jsx)(n.h2,{id:"use",children:"Use"}),"\n",(0,r.jsxs)(n.p,{children:["The integration has ",(0,r.jsx)(n.strong,{children:"two parts"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Client-side Uppy configuration"}),", where you register the plugin and provide\nan ",(0,r.jsx)(n.code,{children:"assemblyOptions"})," callback."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"A server-side endpoint"})," that returns a signed ",(0,r.jsx)(n.code,{children:"{ params, signature }"})," pair\nfor Transloadit."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"1-client-side-uppy-setup",children:"1. Client-side Uppy setup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",metastring:"{3,7,11,17} showLineNumbers",children:"import Uppy from '@uppy/core';\nimport Dashboard from '@uppy/dashboard';\nimport ImageGenerator from '@uppy/image-generator';\n\nimport '@uppy/core/css/style.min.css';\nimport '@uppy/dashboard/css/style.min.css';\nimport '@uppy/image-generator/css/style.min.css';\n\nconst uppy = new Uppy();\n\nuppy.use(Dashboard, { inline: true, target: 'body' }).use(ImageGenerator, {\n\t// Called every time the user submits a new prompt\n\tassemblyOptions: async (prompt) => {\n\t\tconst res = await fetch(\n\t\t\t`/assembly-options?prompt=${encodeURIComponent(prompt)}`,\n\t\t);\n\n\t\tif (!res.ok) {\n\t\t\tthrow new Error('Failed to load Transloadit options');\n\t\t}\n\n\t\t// Should resolve to: { params, signature }\n\t\treturn res.json();\n\t},\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:"When the user enters a prompt in the Image Generator view, Uppy:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Calls your ",(0,r.jsx)(n.code,{children:"assemblyOptions(prompt)"})," function."]}),"\n",(0,r.jsxs)(n.li,{children:["Expects it to resolve with a ",(0,r.jsx)(n.code,{children:"{ params, signature }"})," object."]}),"\n",(0,r.jsxs)(n.li,{children:["Uses those values to start a Transloadit Assembly that runs the \ud83e\udd16\n",(0,r.jsx)(n.code,{children:"/image/generate"})," Robot."]}),"\n",(0,r.jsx)(n.li,{children:"Displays the generated images so users can pick which ones to add to their\nupload."}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.p,{children:["Because we send ",(0,r.jsx)(n.code,{children:"steps"})," directly from the browser, ",(0,r.jsx)(n.strong,{children:"you must use signature\nauthentication"})," on your server to keep your Transloadit secret key safe. The\n",(0,r.jsx)(n.code,{children:"assemblyOptions"})," callback only ever sees the final ",(0,r.jsx)(n.code,{children:"{ params, signature }"}),"\npair."]}),(0,r.jsxs)(n.p,{children:["For language-specific examples (PHP, Ruby, Go, etc.), see\n",(0,r.jsx)(n.a,{href:"https://transloadit.com/docs/api/authentication/",children:"Transloadit\u2019s authentication docs"}),"."]})]}),"\n",(0,r.jsx)(n.h3,{id:"2-server-side-signing-transloadit-parameters-nodejs",children:"2. Server-side: signing Transloadit parameters (Node.js)"}),"\n",(0,r.jsx)(n.p,{children:"Below is a Node.js example that:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Signs Transloadit ",(0,r.jsx)(n.code,{children:"params"})," using your ",(0,r.jsx)(n.code,{children:"TRANSLOADIT_KEY"})," and\n",(0,r.jsx)(n.code,{children:"TRANSLOADIT_SECRET"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Sends a single \ud83e\udd16 ",(0,r.jsx)(n.code,{children:"/image/generate"})," step."]}),"\n",(0,r.jsxs)(n.li,{children:["Returns ",(0,r.jsx)(n.code,{children:"{ params, signature }"})," to the browser."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",metastring:"showLineNumbers",children:"import crypto from 'node:crypto';\n\nfunction utcDateString(ms) {\n\treturn new Date(ms)\n\t\t.toISOString()\n\t\t.replace(/-/g, '/')\n\t\t.replace(/T/, ' ')\n\t\t.replace(/\\.\\d+Z$/, '+00:00');\n}\n\nexport function createAiImageAssemblyOptions(prompt) {\n\t// Expire 1 hour from now (value in milliseconds)\n\tconst expires = utcDateString(Date.now() + 1 * 60 * 60 * 1000);\n\n\tconst authKey = process.env.TRANSLOADIT_KEY;\n\tconst authSecret = process.env.TRANSLOADIT_SECRET;\n\n\tconst params = JSON.stringify({\n\t\tauth: {\n\t\t\tkey: authKey,\n\t\t\texpires,\n\t\t},\n\t\t// Must not contain any more steps; the only step here should be /image/generate\n\t\tsteps: {\n\t\t\tgenerated_image: {\n\t\t\t\t// You can name this step however you like\n\t\t\t\trobot: '/image/generate',\n\t\t\t\tresult: true, // required so the generated files are returned\n\n\t\t\t\t// These are up to you; see the /image/generate docs for all options\n\t\t\t\taspect_ratio: '2:3',\n\t\t\t\tmodel: 'flux-1.1-pro-ultra',\n\n\t\t\t\t// The text prompt coming from the browser (required)\n\t\t\t\tprompt,\n\n\t\t\t\t// How many variants to generate\n\t\t\t\tnum_outputs: 2,\n\t\t\t},\n\t\t},\n\t});\n\n\tconst signatureBytes = crypto\n\t\t.createHmac('sha384', authSecret)\n\t\t.update(Buffer.from(params, 'utf-8'));\n\n\t// Prefix the hash with the algorithm so Transloadit knows how to verify it\n\tconst signature = `sha384:${signatureBytes.digest('hex')}`;\n\n\treturn { params, signature };\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"You can now expose this logic via a small HTTP endpoint:"}),"\n",(0,r.jsxs)(n.p,{children:["For a complete overview of all parameters (such as ",(0,r.jsx)(n.code,{children:"format"}),", ",(0,r.jsx)(n.code,{children:"height"}),", ",(0,r.jsx)(n.code,{children:"width"}),",\n",(0,r.jsx)(n.code,{children:"seed"}),", ",(0,r.jsx)(n.code,{children:"style"}),", and ",(0,r.jsx)(n.code,{children:"aspect_ratio"}),") and supported models, see the\n",(0,r.jsxs)(n.a,{href:"https://transloadit.com/docs/robots/image-generate/",children:[(0,r.jsx)(n.code,{children:"/image/generate"})," Robot documentation"]}),".\nThe blog post\n",(0,r.jsx)(n.a,{href:"https://transloadit.com/blog/2025/04/ai-image-generation/",children:(0,r.jsx)(n.code,{children:"Generate stunning images from text using AI"})}),"\nalso has more guidance on crafting prompts and choosing models."]}),"\n",(0,r.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,r.jsx)(n.h3,{id:"options",children:"Options"}),"\n",(0,r.jsx)(n.h4,{id:"id",children:(0,r.jsx)(n.code,{children:"id"})}),"\n",(0,r.jsxs)(n.p,{children:["A unique identifier for this plugin (",(0,r.jsx)(n.code,{children:"string"}),", default: ",(0,r.jsx)(n.code,{children:"'ImageGenerator'"}),")."]}),"\n",(0,r.jsx)(n.h4,{id:"target",children:(0,r.jsx)(n.code,{children:"target"})}),"\n",(0,r.jsxs)(n.p,{children:["DOM element, CSS selector, or plugin to place the Image Generator view into\n(",(0,r.jsx)(n.code,{children:"string"}),", ",(0,r.jsx)(n.code,{children:"Element"}),", ",(0,r.jsx)(n.code,{children:"Function"}),", or ",(0,r.jsx)(n.code,{children:"UIPlugin"}),", default:\n",(0,r.jsx)(n.a,{href:"/docs/dashboard",children:(0,r.jsx)(n.code,{children:"Dashboard"})}),")."]}),"\n",(0,r.jsx)(n.h4,{id:"assemblyoptions",children:(0,r.jsx)(n.code,{children:"assemblyOptions"})}),"\n",(0,r.jsxs)(n.p,{children:["Callback that returns Transloadit parameters and signature for a given prompt\n(",(0,r.jsx)(n.code,{children:"(prompt: string) => Promise<{ params, signature }>"}),"; ",(0,r.jsx)(n.strong,{children:"required"}),")."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"uppy.use(ImageGenerator, {\n\tassemblyOptions: async (prompt) => {\n\t\tconst res = await fetch(\n\t\t\t`/assembly-options?prompt=${encodeURIComponent(prompt)}`,\n\t\t);\n\t\treturn res.json(); // { params, signature }\n\t},\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:"This gives you full control over:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Which Transloadit account / key to use."}),"\n",(0,r.jsx)(n.li,{children:"Which AI model, aspect ratio, and number of outputs to request."}),"\n",(0,r.jsxs)(n.li,{children:["How you structure your ",(0,r.jsx)(n.code,{children:"steps"})," (as long as they use \ud83e\udd16 ",(0,r.jsx)(n.code,{children:"/image/generate"}),")."]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},65171:(e,n,t)=>{t.d(n,{A:()=>d});var s=t(96540),r=t(88149),i=t(27293),a=t(4476),o=t(74848);const{rE:l}=a;function d({children:e,uppyCssName:n="uppy.min.css",uppyJsName:t="uppy.min.mjs"}){let a=[];s.Children.toArray(e).forEach(e=>{a=[...a,...String(e).trim().split("\n").map(e=>e.trim())]});const d=a.map(e=>`  ${e}`).join("\n"),c=`https://releases.transloadit.com/uppy/v${l}/${t}`,p=`\x3c!-- 1. Add CSS to \`<head>\` --\x3e\n<link href="https://releases.transloadit.com/uppy/v${l}/${n}" rel="stylesheet">\n\n\x3c!-- 2. Initialize --\x3e\n<div id="uppy"></div>\n\n<script type="module">\n${d.replace(/{{UPPY_JS_URL}}/g,c)}\n<\/script>\n`;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.A,{type:"caution",children:[(0,o.jsx)("p",{children:"The bundle consists of most Uppy plugins, so this method is not recommended for production, as your users will have to download all plugins when you are likely using only a few."}),(0,o.jsx)("p",{children:"It can be useful to speed up your development environment, so don't hesitate to use it to get you started."})]}),(0,o.jsx)(r.A,{language:"html",children:p})]})}}}]);