"use strict";(self.webpackChunkuppy_io=self.webpackChunkuppy_io||[]).push([[3734],{47338:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>h,contentTitle:()=>a,default:()=>g,frontMatter:()=>d,metadata:()=>c,toc:()=>p});var s=n(74848),i=n(28453),o=n(11470),t=n(19365),l=n(65171);const d={sidebar_position:11},a="Golden Retriever",c={id:"golden-retriever",title:"Golden Retriever",description:"The @uppy/golden-retriever plugin saves selected files in your browser cache,",source:"@site/docs/golden-retriever.mdx",sourceDirName:".",slug:"/golden-retriever",permalink:"/docs/golden-retriever",draft:!1,unlisted:!1,editUrl:"https://github.com/transloadit/uppy/blob/main/docs/golden-retriever.mdx",tags:[],version:"current",sidebarPosition:11,frontMatter:{sidebar_position:11},sidebar:"tutorialSidebar",previous:{title:"Internationalisation",permalink:"/docs/locales"},next:{title:"Compressor",permalink:"/docs/compressor"}},h={},p=[{value:"When should I use this?",id:"when-should-i-use-this",level:2},{value:"Install",id:"install",level:2},{value:"Use",id:"use",level:2},{value:"Enabling Service Worker",id:"enabling-service-worker",level:3},{value:"API",id:"api",level:2},{value:"Options",id:"options",level:3},{value:"<code>id</code>",id:"id",level:4},{value:"<code>expires</code>",id:"expires",level:4},{value:"<code>serviceWorker</code>",id:"serviceworker",level:4}];function u(e){const r={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h1,{id:"golden-retriever",children:"Golden Retriever"}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"@uppy/golden-retriever"})," plugin saves selected files in your browser cache,\nso that if the browser crashes, or the user accidentally closes the tab, Uppy\ncan restore everything and continue uploading as if nothing happened. You can\nread more about it\n",(0,s.jsx)(r.a,{href:"https://uppy.io/blog/2017/07/golden-retriever/",children:"on our blog"}),"."]}),"\n",(0,s.jsx)(r.p,{children:"The Golden Retriever uses three methods of browser data storage:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"LocalStorage"})," to store file metadata and Uppy state only."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"IndexedDB"})," for small files, usually under 5MiB."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Service Worker"})," (",(0,s.jsx)(r.em,{children:"optional"}),") for ",(0,s.jsx)(r.em,{children:"all"})," files because, unlike ",(0,s.jsx)(r.code,{children:"IndexedDB"}),",\n",(0,s.jsx)(r.code,{children:"Service Worker"})," can keep references to large files. Service Worker storage is\n",(0,s.jsx)(r.em,{children:"quite"})," temporary though, and doesn\u2019t persist across browser crashes or\nrestarts. It works well, however, for accidental refreshes or closed tabs."]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["Upon restore, the plugin first restores state from ",(0,s.jsx)(r.code,{children:"LocalStorage"})," and then\nchecks both file storages \u2014 ",(0,s.jsx)(r.code,{children:"IndexedDB"})," and ",(0,s.jsx)(r.code,{children:"ServiceWorker"})," \u2014 merging the\nresults."]}),"\n",(0,s.jsx)(r.p,{children:"If restore is unsuccessful for certain files, they will be marked as \u201cghosts\u201d in\nthe Dashboard UI, and a message + button offering to re-select those files will\nbe displayed."}),"\n",(0,s.jsxs)(r.p,{children:["Checkout the\n",(0,s.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Storage_API/Storage_quotas_and_eviction_criteria#other_web_technologies",children:"storage quotas"}),"\non MDN to see how much data can be stored depending on the device and browser."]}),"\n",(0,s.jsx)(r.h2,{id:"when-should-i-use-this",children:"When should I use this?"}),"\n",(0,s.jsx)(r.p,{children:"When you want extra insurance for the user-selected files. If you feel like\nusers might spend some time picking files, tweaking descriptions etc, and will\nnot appreciate having to do it over again if something crashes. Another use case\nmight be when you think user might want to pick a few files, navigate away to do\nsomething else in your app or otherwise, and then come back to the same\nselection."}),"\n",(0,s.jsx)(r.h2,{id:"install",children:"Install"}),"\n",(0,s.jsxs)(o.A,{children:[(0,s.jsx)(t.A,{value:"npm",label:"NPM",default:!0,children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"npm install @uppy/golden-retriever\n"})})}),(0,s.jsx)(t.A,{value:"yarn",label:"Yarn",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"yarn add @uppy/golden-retriever\n"})})}),(0,s.jsx)(t.A,{value:"cdn",label:"CDN",children:(0,s.jsx)(l.A,{children:'\n        import { Uppy, GoldenRetriever } from "{{UPPY_JS_URL}}"\n        new Uppy().use(GoldenRetriever)\n      '})})]}),"\n",(0,s.jsx)(r.h2,{id:"use",children:"Use"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",metastring:"{7} showLineNumbers",children:"import Uppy from '@uppy/core';\nimport Dashboard from '@uppy/dashboard';\nimport GoldenRetriever from '@uppy/golden-retriever';\n\nnew Uppy()\n  .use(Dashboard, {inline:true, target: '#dashboard')\n  .use(GoldenRetriever);\n"})}),"\n",(0,s.jsxs)(r.p,{children:["By default, Golden Retriever will only use the ",(0,s.jsx)(r.code,{children:"IndexedDB"})," storage, which is\ngood enough for files up to 5 MiB. ",(0,s.jsx)(r.code,{children:"Service Worker"})," is optional and requires\nsetup."]}),"\n",(0,s.jsx)(r.h3,{id:"enabling-service-worker",children:"Enabling Service Worker"}),"\n",(0,s.jsx)(r.p,{children:"With the Service Worker storage, Golden Retriever will be able to temporary\nstore references to large files."}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Bundle your own service worker ",(0,s.jsx)(r.code,{children:"sw.js"})," file with Uppy GoldenRetriever\u2019s\nservice worker."]}),"\n",(0,s.jsx)(r.admonition,{type:"tip",children:(0,s.jsxs)(r.p,{children:["For Webpack, check out\n",(0,s.jsx)(r.a,{href:"https://github.com/oliviertassinari/serviceworker-webpack-plugin",children:"serviceworker-webpack-plugin"}),"."]})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",metastring:'title="sw.js"',children:"import('@uppy/golden-retriever/lib/ServiceWorker');\n"})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"Register it in your app\u2019s entry point:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"// you app.js entry point\nuppy.use(GoldenRetriever, { serviceWorker: true });\n\nif ('serviceWorker' in navigator) {\n\tnavigator.serviceWorker\n\t\t.register('/sw.js') // path to your bundled service worker with GoldenRetriever service worker\n\t\t.then((registration) => {\n\t\t\tconsole.log(\n\t\t\t\t'ServiceWorker registration successful with scope: ',\n\t\t\t\tregistration.scope,\n\t\t\t);\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.log(`Registration failed with ${error}`);\n\t\t});\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Voil\xe0, that\u2019s it. Happy retrieving!"}),"\n",(0,s.jsx)(r.h2,{id:"api",children:"API"}),"\n",(0,s.jsx)(r.h3,{id:"options",children:"Options"}),"\n",(0,s.jsx)(r.h4,{id:"id",children:(0,s.jsx)(r.code,{children:"id"})}),"\n",(0,s.jsxs)(r.p,{children:["A unique identifier for this plugin (",(0,s.jsx)(r.code,{children:"string"}),", default: ",(0,s.jsx)(r.code,{children:"'GoldenRetriever'"}),")."]}),"\n",(0,s.jsx)(r.h4,{id:"expires",children:(0,s.jsx)(r.code,{children:"expires"})}),"\n",(0,s.jsxs)(r.p,{children:["How long to store metadata and files for. Used for ",(0,s.jsx)(r.code,{children:"LocalStorage"})," and\n",(0,s.jsx)(r.code,{children:"IndexedDB"})," (",(0,s.jsx)(r.code,{children:"number"}),", default: ",(0,s.jsx)(r.code,{children:"24 * 60 * 60 * 1000"})," // 24 hours)."]}),"\n",(0,s.jsx)(r.h4,{id:"serviceworker",children:(0,s.jsx)(r.code,{children:"serviceWorker"})}),"\n",(0,s.jsxs)(r.p,{children:["Whether to enable ",(0,s.jsx)(r.code,{children:"Service Worker"})," storage (",(0,s.jsx)(r.code,{children:"boolean"}),", default: ",(0,s.jsx)(r.code,{children:"false"}),")."]})]})}function g(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},65171:(e,r,n)=>{n.d(r,{A:()=>a});var s=n(96540),i=n(21432),o=n(27293),t=n(4476),l=n(74848);const{version:d}=t;function a(e){let{children:r,uppyCssName:n="uppy.min.css",uppyJsName:t="uppy.min.mjs"}=e,a=[];s.Children.toArray(r).forEach((e=>{a=[...a,...String(e).trim().split("\n").map((e=>e.trim()))]}));const c=a.map((e=>`  ${e}`)).join("\n"),h=`https://releases.transloadit.com/uppy/v${d}/${t}`,p=`\x3c!-- 1. Add CSS to \`<head>\` --\x3e\n<link href="https://releases.transloadit.com/uppy/v${d}/${n}" rel="stylesheet">\n\n\x3c!-- 2. Initialize --\x3e\n<div id="uppy"></div>\n\n<script type="module">\n${c.replace(/{{UPPY_JS_URL}}/g,h)}\n<\/script>\n`;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(o.A,{type:"caution",children:[(0,l.jsx)("p",{children:"The bundle consists of most Uppy plugins, so this method is not recommended for production, as your users will have to download all plugins when you are likely using only a few."}),(0,l.jsx)("p",{children:"It can be useful to speed up your development environment, so don't hesitate to use it to get you started."})]}),(0,l.jsx)(i.A,{language:"html",children:p})]})}}}]);