"use strict";(self.webpackChunkuppy_io=self.webpackChunkuppy_io||[]).push([[1311],{84501:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>p,frontMatter:()=>i,metadata:()=>d,toc:()=>a});var s=o(74848),r=o(28453);const i={},t="Migration guides",d={id:"guides/migration-guides",title:"Migration guides",description:"These cover all the major Uppy versions and how to migrate to them.",source:"@site/docs/guides/migration-guides.md",sourceDirName:"guides",slug:"/guides/migration-guides",permalink:"/docs/guides/migration-guides",draft:!1,unlisted:!1,editUrl:"https://github.com/transloadit/uppy.io/blob/main/docs/guides/migration-guides.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Custom stores",permalink:"/docs/guides/custom-stores"},next:{title:"Uppy core",permalink:"/docs/uppy"}},l={},a=[{value:"Migrate from Companion 5.x to 6.x",id:"migrate-from-companion-5x-to-6x",level:2},{value:"Migrate from Uppy 4.x to 5.x",id:"migrate-from-uppy-4x-to-5x",level:2},{value:"@uppy/informer merged into @uppy/dashboard",id:"uppyinformer-merged-into-uppydashboard",level:3},{value:"@uppy/progress-bar deprecated",id:"uppyprogress-bar-deprecated",level:3},{value:"@uppy/drag-drop and @uppy/file-input deprecated",id:"uppydrag-drop-and-uppyfile-input-deprecated",level:3},{value:"Export maps for all packages",id:"export-maps-for-all-packages",level:3},{value:"Changed imports for <code>@uppy/react</code>, <code>@uppy/vue</code>, and <code>@uppy/svelte</code>",id:"changed-imports-for-uppyreact-uppyvue-and-uppysvelte",level:4},{value:"@uppy/status-bar merged into @uppy/dashboard",id:"uppystatus-bar-merged-into-uppydashboard",level:3},{value:"Migrate from Companion 4.x to 5.x",id:"migrate-from-companion-4x-to-5x",level:2},{value:"<code>@uppy/companion-client</code>",id:"uppycompanion-client",level:3},{value:"Migrate from Uppy 3.x to 4.x",id:"migrate-from-uppy-3x-to-4x",level:2},{value:"TypeScript rewrite",id:"typescript-rewrite",level:3},{value:"<code>@uppy/aws-s3</code> and <code>@uppy/aws-s3-multipart</code>",id:"uppyaws-s3-and-uppyaws-s3-multipart",level:3},{value:"<code>@uppy/core</code>",id:"uppycore",level:3},{value:"<code>@uppy/xhr-upload</code>",id:"uppyxhr-upload",level:3},{value:"<code>@uppy/transloadit</code>",id:"uppytransloadit",level:3},{value:"CDN",id:"cdn",level:3},{value:"Miscellaneous",id:"miscellaneous",level:3},{value:"<code>@uppy/angular</code>",id:"uppyangular",level:3},{value:"<code>@uppy/react</code>",id:"uppyreact",level:3},{value:"<code>@uppy/svelte</code>",id:"uppysvelte",level:3},{value:"<code>@uppy/vue</code>",id:"uppyvue",level:3},{value:"Migrate from Robodog to Uppy plugins",id:"migrate-from-robodog-to-uppy-plugins",level:2},{value:"Migrate from Uppy 2.x to 3.x",id:"migrate-from-uppy-2x-to-3x",level:2},{value:"Uppy is pure ESM",id:"uppy-is-pure-esm",level:3},{value:"Robodog is deprecated",id:"robodog-is-deprecated",level:3},{value:"<code>@uppy/core</code>",id:"uppycore-1",level:3},{value:"Remove <code>AggregateError</code> polyfill.",id:"remove-aggregateerror-polyfill",level:4},{value:"Remove <code>reset()</code> method.",id:"remove-reset-method",level:4},{value:"Remove backwards compatible exports (static properties on <code>Uppy</code>)`",id:"remove-backwards-compatible-exports-static-properties-on-uppy",level:4},{value:"<code>uppy.validateRestrictions()</code> now returns a <code>RestrictionError</code>",id:"uppyvalidaterestrictions-now-returns-a-restrictionerror",level:4},{value:"<code>@uppy/transloadit</code>",id:"uppytransloadit-1",level:3},{value:"<code>@uppy/aws-s3-multipart</code>",id:"uppyaws-s3-multipart",level:3},{value:"Make <code>headers</code> inside the return value of <code>prepareUploadParts</code> part-indexed too.",id:"make-headers-inside-the-return-value-of-prepareuploadparts-part-indexed-too",level:4},{value:"Remove <code>client</code> getter and setter.",id:"remove-client-getter-and-setter",level:4},{value:"<code>@uppy/tus/</code>, <code>@uppy/aws-s3</code>, <code>@uppy/xhr-upload</code>",id:"uppytus-uppyaws-s3-uppyxhr-upload",level:3},{value:"<code>@uppy/react</code>",id:"uppyreact-1",level:3},{value:"Uppy dependencies have become peer dependencies",id:"uppy-dependencies-have-become-peer-dependencies",level:4},{value:"Don\u2019t expose <code>validProps</code> on the exported components.",id:"dont-expose-validprops-on-the-exported-components",level:4},{value:"<code>@uppy/svelte</code>",id:"uppysvelte-1",level:3},{value:"<code>@uppy/vue</code>",id:"uppyvue-1",level:3},{value:"<code>@uppy/store-redux</code>",id:"uppystore-redux",level:3},{value:"<code>@uppy/thumbnail-generator</code>",id:"uppythumbnail-generator",level:3},{value:"Known issues",id:"known-issues",level:3},{value:"Migrate from Companion 3.x to 4.x",id:"migrate-from-companion-3x-to-4x",level:2},{value:"Minimum required Node.js version is v14.20.0",id:"minimum-required-nodejs-version-is-v14200",level:3},{value:"<code>companion.app()</code> returns <code>{ app, emitter }</code> instead of <code>app</code>",id:"companionapp-returns--app-emitter--instead-of-app",level:3},{value:"Removed <code>searchProviders</code> wrapper object inside <code>providerOptions</code>",id:"removed-searchproviders-wrapper-object-inside-provideroptions",level:3},{value:"Moved the <code>s3</code> options out of <code>providerOptions</code>",id:"moved-the-s3-options-out-of-provideroptions",level:3},{value:"Removed compatibility for legacy Custom Provider implementations",id:"removed-compatibility-for-legacy-custom-provider-implementations",level:3},{value:"Default to no ACL for AWS S3",id:"default-to-no-acl-for-aws-s3",level:3},{value:"<code>protocol</code> sent from Uppy in any <code>get</code> request is now required (before it would default to Multipart).",id:"protocol-sent-from-uppy-in-any-get-request-is-now-required-before-it-would-default-to-multipart",level:3},{value:"<code>emitSuccess</code> and <code>emitError</code> are now private methods on the <code>Uploader</code> class.",id:"emitsuccess-and-emiterror-are-now-private-methods-on-the-uploader-class",level:3},{value:"Removed <code>chunkSize</code> backwards compatibility for AWS S3 Multipart",id:"removed-chunksize-backwards-compatibility-for-aws-s3-multipart",level:3},{value:"Removed backwards compatibility for <code>/metrics</code> endpoint",id:"removed-backwards-compatibility-for-metrics-endpoint",level:3},{value:"Migrate from Uppy 1.x to 2.x",id:"migrate-from-uppy-1x-to-2x",level:2},{value:"New bundle requires manual polyfilling",id:"new-bundle-requires-manual-polyfilling",level:3},{value:"Use <code>BasePlugin</code> or <code>UIPlugin</code> instead of <code>Plugin</code>",id:"use-baseplugin-or-uiplugin-instead-of-plugin",level:3},{value:"Use the latest Preact for your Uppy plugins",id:"use-the-latest-preact-for-your-uppy-plugins",level:3},{value:"Set plugin titles from locales",id:"set-plugin-titles-from-locales",level:3},{value:"Initialize Uppy with the <code>new</code> keyword",id:"initialize-uppy-with-the-new-keyword",level:3},{value:"Rename <code>allowMultipleUploads</code> to <code>allowMultipleUploadBatches</code>",id:"rename-allowmultipleuploads-to-allowmultipleuploadbatches",level:3},{value:"New default limits for @uppy/xhr-upload and @uppy/tus",id:"new-default-limits-for-uppyxhr-upload-and-uppytus",level:3},{value:"TypeScript changes",id:"typescript-changes",level:3},{value:"Event types",id:"event-types",level:4},{value:"Changes to pre-signing URLs for @uppy/aws-s3-multipart",id:"changes-to-pre-signing-urls-for-uppyaws-s3-multipart",level:3},{value:"Removed the <code>.run</code> method from @uppy/core",id:"removed-the-run-method-from-uppycore",level:3},{value:"Removed <code>resume</code> and <code>removeFingerprintOnSuccess</code> options from @uppy/tus",id:"removed-resume-and-removefingerprintonsuccess-options-from-uppytus",level:3},{value:"That\u2019s it!",id:"thats-it",level:3},{value:"Migrate from Companion 1.x to 2.x",id:"migrate-from-companion-1x-to-2x",level:2},{value:"Prerequisite",id:"prerequisite",level:3},{value:"ProviderOptions",id:"provideroptions",level:3},{value:"OAuth Redirect URIs",id:"oauth-redirect-uris",level:3},{value:"New Redirect URIs",id:"new-redirect-uris",level:4}];function c(e){const n={a:"a",admonition:"admonition",code:"code",div:"div",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",time:"time",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"migration-guides",children:"Migration guides"}),"\n",(0,s.jsx)(n.p,{children:"These cover all the major Uppy versions and how to migrate to them."}),"\n",(0,s.jsx)(n.h2,{id:"migrate-from-companion-5x-to-6x",children:"Migrate from Companion 5.x to 6.x"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Option ",(0,s.jsx)(n.code,{children:"companionAllowedHosts"})," no longer wrapped in Regex start/end characters\n(",(0,s.jsx)(n.code,{children:"^"})," and ",(0,s.jsx)(n.code,{children:"$"}),"). You now need to provide these yourself if you want an exact\nmatch."]}),"\n",(0,s.jsxs)(n.li,{children:["Backwards compat token decryption removed: old Uppy auth tokens (created\nbefore\n",(0,s.jsx)(n.a,{href:"https://github.com/transloadit/uppy/releases/tag/uppy%404.16.0",children:"uppy%404.16.0"}),"\n06d9a7c689e5123d41b38191074eb8bbd4ff5325) will become invalid and users who\nhave these old toknes will have to re-authenticate."]}),"\n",(0,s.jsxs)(n.li,{children:["Removed ",(0,s.jsx)(n.code,{children:"token"})," param from ",(0,s.jsx)(n.code,{children:"Provider"})," class methods: ",(0,s.jsx)(n.code,{children:"list()"}),", ",(0,s.jsx)(n.code,{children:"download()"}),",\n",(0,s.jsx)(n.code,{children:"logout()"}),", ",(0,s.jsx)(n.code,{children:"thumbnail()"}),". Please use: ",(0,s.jsx)(n.code,{children:"providerUserSession"}),".",(0,s.jsx)(n.code,{children:"accessToken"}),"\ninstead."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"migrate-from-uppy-4x-to-5x",children:"Migrate from Uppy 4.x to 5.x"}),"\n",(0,s.jsx)(n.h3,{id:"uppyinformer-merged-into-uppydashboard",children:"@uppy/informer merged into @uppy/dashboard"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"@uppy/informer"})," plugin has been merged into ",(0,s.jsx)(n.code,{children:"@uppy/dashboard"})," to reduce\nbundle size and improve maintainability. The ",(0,s.jsx)(n.code,{children:"@uppy/informer"})," package is no\nlonger maintained as a standalone package and should be removed from your\ndependencies."]}),"\n",(0,s.jsx)(n.h3,{id:"uppyprogress-bar-deprecated",children:"@uppy/progress-bar deprecated"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"@uppy/progress-bar"})," plugin has been deprecated as it provided minimal\nfunctionality that can be replicated with Uppy\u2019s built-in state management."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import ProgressBar from '@uppy/progress-bar';\n\nuppy.use(ProgressBar, { target: '#progress' });\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"After:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Custom progress bar using Uppy state\nuppy.on('upload-progress', (file, progress) => {\n\tconst progressElement = document.getElementById('progress');\n\tprogressElement.style.width = `${progress.percentage}%`;\n\tprogressElement.textContent = `${progress.percentage}%`;\n});\n\n// Or listen to total progress\nuppy.on('progress', (progress) => {\n\tconst progressElement = document.getElementById('progress');\n\tprogressElement.style.width = `${progress}%`;\n\tprogressElement.textContent = `${progress}%`;\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Migration steps:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Remove ",(0,s.jsx)(n.code,{children:"@uppy/progress-bar"})," from your dependencies"]}),"\n",(0,s.jsxs)(n.li,{children:["Create a custom progress indicator using Uppy\u2019s ",(0,s.jsx)(n.code,{children:"progress"})," or\n",(0,s.jsx)(n.code,{children:"upload-progress"})," events."]}),"\n",(0,s.jsx)(n.li,{children:"Style your progress bar according to your design system."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"uppydrag-drop-and-uppyfile-input-deprecated",children:"@uppy/drag-drop and @uppy/file-input deprecated"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"@uppy/drag-drop"})," and ",(0,s.jsx)(n.code,{children:"@uppy/file-input"})," plugins have been deprecated in\nfavor of more flexible, headless hooks. These hooks provide the same\nfunctionality but with maximum customization freedom."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import DragDrop from '@uppy/drag-drop';\nimport FileInput from '@uppy/file-input';\n\nuppy\n\t.use(DragDrop, { target: '#drag-drop' })\n\t.use(FileInput, { target: '#file-input' });\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"After:"})}),"\n",(0,s.jsx)(n.p,{children:"Example is for React but the same components and hooks exist for Vue and Svelte."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import { Dropzone } from '@uppy/react';\n\nfunction Component() {\n\treturn <Dropzone />;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Or with hooks"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'import clsx from \'clsx\';\nimport { useDropzone } from \'@uppy/react\';\n\ntype DropzoneProps = {\n\tnote?: string;\n\tnoClick?: boolean;\n};\n\nexport function Dropzone({ note, noClick }: DropzoneProps) {\n\tconst { getRootProps, getInputProps } = useDropzone({ noClick });\n\n\treturn (\n\t\t<div data-uppy-element="dropzone" role="presentation">\n\t\t\t<input\n\t\t\t\t{...getInputProps()}\n\t\t\t\ttabIndex={-1}\n\t\t\t\tname="uppy-dropzone-file-input"\n\t\t\t\tclassName="hidden"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\t{...getRootProps()}\n\t\t\t\ttabIndex={0}\n\t\t\t\tclassName={clsx(\n\t\t\t\t\t\'border-2 border-dashed border-gray-300\',\n\t\t\t\t\t\'rounded-lg p-6 bg-gray-50\',\n\t\t\t\t\t\'transition-colors duration-200\',\n\t\t\t\t\t{\n\t\t\t\t\t\t\'cursor-pointer hover:bg-blue-50\': !noClick,\n\t\t\t\t\t},\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<div className="flex flex-col items-center justify-center h-full space-y-3">\n\t\t\t\t\t<p className="text-gray-600">Drop files here or click to add them</p>\n\t\t\t\t</div>\n\t\t\t\t{note ?\n\t\t\t\t\t<div className="text-sm text-gray-500">{note}</div>\n\t\t\t\t:\tnull}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Alternative: Use Dashboard"})}),"\n",(0,s.jsx)(n.p,{children:"Showing the \u201cvanilla\u201d JS version, Dashboard is also exported for all frameworks."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// If you want a complete UI solution, use Dashboard instead\nimport Dashboard from '@uppy/dashboard';\n\nuppy.use(Dashboard, {\n\ttarget: '#uppy-dashboard',\n\tinline: true,\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Migration steps:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Remove ",(0,s.jsx)(n.code,{children:"@uppy/drag-drop"})," and ",(0,s.jsx)(n.code,{children:"@uppy/file-input"})," from your dependencies"]}),"\n",(0,s.jsxs)(n.li,{children:["Choose one of these approaches:\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use the framework-specific hooks (",(0,s.jsx)(n.code,{children:"@uppy/react"}),", ",(0,s.jsx)(n.code,{children:"@uppy/vue"}),",\n",(0,s.jsx)(n.code,{children:"@uppy/svelte"}),") for maximum flexibility"]}),"\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"@uppy/dashboard"})," for a complete, ready-to-use UI solution"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Replace your existing components with custom implementations using the hooks\nor Dashboard"}),"\n",(0,s.jsxs)(n.li,{children:["See ",(0,s.jsx)(n.a,{href:"../examples/",children:"examples/"})," for complete implementation examples"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"export-maps-for-all-packages",children:"Export maps for all packages"}),"\n",(0,s.jsx)(n.p,{children:"All packages now have export maps. This is a breaking change in two cases:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["The css imports have changed from ",(0,s.jsx)(n.code,{children:"@uppy[package]/css/style.min.css"})," to\n",(0,s.jsx)(n.code,{children:"@uppy[package]/css/style.min.css"})]}),"\n",(0,s.jsxs)(n.li,{children:["You were importing something that was not exported from the root, for\ninstance ",(0,s.jsx)(n.code,{children:"@uppy/core/lib/foo.js"}),". You can now only import things we\nexplicitly exported."]}),"\n"]}),"\n",(0,s.jsxs)(n.h4,{id:"changed-imports-for-uppyreact-uppyvue-and-uppysvelte",children:["Changed imports for ",(0,s.jsx)(n.code,{children:"@uppy/react"}),", ",(0,s.jsx)(n.code,{children:"@uppy/vue"}),", and ",(0,s.jsx)(n.code,{children:"@uppy/svelte"})]}),"\n",(0,s.jsx)(n.p,{children:"Some components, like Dashboard, require a peer dependency to work but since all\ncomponents were exported from a single file you were forced to install all peer\ndependencies. Even if you never imported, for instance, the status bar\ncomponent."}),"\n",(0,s.jsxs)(n.p,{children:["Every component that requires a peer dependency has now been moved to a subpath,\nsuch as ",(0,s.jsx)(n.code,{children:"@uppy/react/dashboard"}),", so you only need to install the peer\ndependencies you need."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Example for ",(0,s.jsx)(n.code,{children:"@uppy/react"}),":"]})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"import { Dashboard, StatusBar } from '@uppy/react';\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Now:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"import Dashboard from '@uppy/react/dashboard';\nimport StatusBar from '@uppy/react/status-bar';\n"})}),"\n",(0,s.jsx)(n.h3,{id:"uppystatus-bar-merged-into-uppydashboard",children:"@uppy/status-bar merged into @uppy/dashboard"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"@uppy/status-bar"})," package has been merged into ",(0,s.jsx)(n.code,{children:"@uppy/dashboard"}),". The\nplugin gave a false promise of flexibility as a standalone plugin but was always\nbuilt tightly coupled for ",(0,s.jsx)(n.code,{children:"@uppy/dashboard"}),". With the new headless components\nand hooks, we want go all in those components and remove the confusing,\ninflexible ones."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Migration steps:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Remove ",(0,s.jsx)(n.code,{children:"@uppy/status-bar"})," from your dependencies"]}),"\n",(0,s.jsx)(n.li,{children:"Replace StatusBar usage with Dashboard"}),"\n",(0,s.jsx)(n.li,{children:"Move all StatusBar options directly to Dashboard options"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"All StatusBar configuration options are now available as Dashboard options:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hideProgressDetails"})," - Hide detailed progress information"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hideUploadButton"})," - Hide the upload button"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hideAfterFinish"})," - Hide status bar after upload completion"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hideRetryButton"})," - Hide the retry button"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hidePauseResumeButton"})," - Hide pause/resume controls"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hideCancelButton"})," - Hide the cancel button"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"doneButtonHandler"})," - Custom handler for the done button"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Before - separate StatusBar plugin\nimport StatusBar from '@uppy/status-bar';\nuppy.use(StatusBar, {\n\ttarget: '#status-bar',\n\thideProgressDetails: true,\n\thideUploadButton: false,\n\thideAfterFinish: true,\n});\n\n// After - use Dashboard with StatusBar options\nimport Dashboard from '@uppy/dashboard';\nuppy.use(Dashboard, {\n\ttarget: '#dashboard',\n\thideProgressDetails: false,\n\thideUploadButton: false,\n\thideAfterFinish: true,\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"migrate-from-companion-4x-to-5x",children:"Migrate from Companion 4.x to 5.x"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"End-of-Life versions of Node.js are no longer supported (use latest 18.x LTS,\n20.x LTS, or 22.x current)."}),"\n",(0,s.jsxs)(n.li,{children:["Setting the ",(0,s.jsx)(n.code,{children:"corsOrigin"})," (",(0,s.jsx)(n.code,{children:"COMPANION_CLIENT_ORIGINS"}),") option is now required.\nYou should define the list of origins you expect your app to be served from,\notherwise it can be impersonated from a different origin you don\u2019t control.\nSet it to ",(0,s.jsx)(n.code,{children:"true"})," if you don\u2019t care about impersonating. If you\u2019re using\nCompanion as an express middleware, do ",(0,s.jsx)(n.strong,{children:"not"})," use the ",(0,s.jsx)(n.code,{children:"cors"})," module in your\nproject, because Companion already includes it. Use the ",(0,s.jsx)(n.code,{children:"corsOrigins"}),"\nCompanion option to customise CORS behavior."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"COMPANION_REDIS_EXPRESS_SESSION_PREFIX"})," now defaults to ",(0,s.jsx)(n.code,{children:"companion-session:"}),"\n(before ",(0,s.jsx)(n.code,{children:"sess:"}),"). To revert keep backwards compatibility, set the environment\nvariable ",(0,s.jsx)(n.code,{children:"COMPANION_REDIS_EXPRESS_SESSION_PREFIX=sess:"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The URL endpoint (used by the ",(0,s.jsx)(n.code,{children:"Url"}),"/",(0,s.jsx)(n.code,{children:"Link"})," plugin) is now turned off by\ndefault and must be explicitly enabled with\n",(0,s.jsx)(n.code,{children:"COMPANION_ENABLE_URL_ENDPOINT=true"})," or ",(0,s.jsx)(n.code,{children:"enableUrlEndpoint: true"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The option ",(0,s.jsx)(n.code,{children:"streamingUpload"})," / ",(0,s.jsx)(n.code,{children:"COMPANION_STREAMING_UPLOAD"})," now defaults to\n",(0,s.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The option ",(0,s.jsx)(n.code,{children:"getKey(req, filename, metadata)"})," has changed signature to\n",(0,s.jsx)(n.code,{children:"getKey({ filename, metadata, req })"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The option ",(0,s.jsx)(n.code,{children:"bucket(req, metadata)"})," has changed signature to\n",(0,s.jsx)(n.code,{children:"bucketOrFn({ req, metadata, filename })"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Custom provider breaking changes. If you have not implemented a custom\nprovider, you should not be affected.\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The static ",(0,s.jsx)(n.code,{children:"getExtraConfig"})," property has been renamed to\n",(0,s.jsx)(n.code,{children:"getExtraGrantConfig"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The static ",(0,s.jsx)(n.code,{children:"authProvider"})," property has been renamed to ",(0,s.jsx)(n.code,{children:"oauthProvider"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Endpoint ",(0,s.jsx)(n.code,{children:"GET /s3/params"})," now returns ",(0,s.jsx)(n.code,{children:'{ method: "POST" }'})," instead of\n",(0,s.jsx)(n.code,{children:'{ method: "post" }'}),". This will not affect most people."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"access-control-allow-headers"})," is no longer included in\n",(0,s.jsx)(n.code,{children:"Access-Control-Expose-Headers"}),", and ",(0,s.jsx)(n.code,{children:"uppy-versions"})," is no longer an allowed\nheader. We are not aware of any issues this might cause."]}),"\n",(0,s.jsxs)(n.li,{children:["Internal refactoring (probably won\u2019t affect you)\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getProtectedGot"})," parameter ",(0,s.jsx)(n.code,{children:"blockLocalIPs"})," changed to ",(0,s.jsx)(n.code,{children:"allowLocalIPs"}),"\n(inverted boolean)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getURLMeta"})," 2nd (boolean) argument inverted."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"getProtectedHttpAgent"})," parameter ",(0,s.jsx)(n.code,{children:"blockLocalIPs"})," changed to ",(0,s.jsx)(n.code,{children:"allowLocalIPs"}),"\n(inverted boolean)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"downloadURL"})," 2nd (boolean) argument inverted."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"StreamHttpJsonError"})," renamed to ",(0,s.jsx)(n.code,{children:"HttpError"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Removed the ",(0,s.jsx)(n.code,{children:"oauthOrigin"})," option, as well as the (undocumented) option\n",(0,s.jsx)(n.code,{children:"clients"}),". Use ",(0,s.jsx)(n.code,{children:"corsOrigin"})," instead."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"uppycompanion-client",children:(0,s.jsx)(n.code,{children:"@uppy/companion-client"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Unless you built a custom provider, you don\u2019t use ",(0,s.jsx)(n.code,{children:"@uppy/companion-client"}),"\ndirectly but through provider plugins such as ",(0,s.jsx)(n.code,{children:"@uppy/google-drive"}),". In which\ncase you don\u2019t have to do anything."]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"supportsRefreshToken"})," now defaults to ",(0,s.jsx)(n.code,{children:"false"})," instead of ",(0,s.jsx)(n.code,{children:"true"}),". If you have\nimplemented a custom provider, this might affect you."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Socket"})," class is no longer in use and has been removed. Unless you used this\nclass you don\u2019t need to do anything."]}),"\n",(0,s.jsxs)(n.li,{children:["Remove deprecated options ",(0,s.jsx)(n.code,{children:"serverUrl"})," and ",(0,s.jsx)(n.code,{children:"serverPattern"})," (they were merely\ndefined in Typescript, not in use)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RequestClient"})," methods ",(0,s.jsx)(n.code,{children:"get"}),", ",(0,s.jsx)(n.code,{children:"post"}),", ",(0,s.jsx)(n.code,{children:"delete"})," no longer accepts a boolean as\nthe third argument. Instead, pass ",(0,s.jsx)(n.code,{children:"{ skipPostResponse: true | false }"}),". This\nwon\u2019t affect you unless you\u2019ve been using ",(0,s.jsx)(n.code,{children:"RequestClient"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"When pausing uploads, the WebSocket towards companion will no longer be\nclosed. This allows paused uploads to be cancelled, but once a file has been\npaused it will still occupy its place in the concurrency queue."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"migrate-from-uppy-3x-to-4x",children:"Migrate from Uppy 3.x to 4.x"}),"\n",(0,s.jsx)(n.h3,{id:"typescript-rewrite",children:"TypeScript rewrite"}),"\n",(0,s.jsx)(n.p,{children:"Almost all plugins have been completely rewritten in TypeScript! This means you\nmay run into type error all over the place, but the types now accurately show\nUppy\u2019s state and files."}),"\n",(0,s.jsx)(n.p,{children:"There are too many small changes to cover, so you have to upgrade and see where\nTypeScript complains."}),"\n",(0,s.jsxs)(n.p,{children:["One important thing to note are the new generics on ",(0,s.jsx)(n.code,{children:"@uppy/core"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import Uppy from '@uppy/core';\n// xhr-upload is for uploading to your own backend.\nimport XHRUpload from '@uppy/xhr-upload';\n\n// Your own metadata on files\ntype Meta = { myCustomMetadata: string };\n// The response from your server\ntype Body = { someThingMyBackendReturns: string };\n\nconst uppy = new Uppy<Meta, Body>().use(XHRUpload, {\n\tendpoint: '/upload',\n});\n\nconst id = uppy.addFile({\n\tname: 'example.jpg',\n\tdata: new Blob(),\n\tmeta: { myCustomMetadata: 'foo' },\n});\n\n// This is now typed\nconst { myCustomMetadata } = uppy.getFile(id).meta;\n\nawait uppy.upload();\n\n// This is strictly typed too\nconst { someThingMyBackendReturns } = uppy.getFile(id).response.body!;\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"uppyaws-s3-and-uppyaws-s3-multipart",children:[(0,s.jsx)(n.code,{children:"@uppy/aws-s3"})," and ",(0,s.jsx)(n.code,{children:"@uppy/aws-s3-multipart"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"@uppy/aws-s3"})," and ",(0,s.jsx)(n.code,{children:"@uppy/aws-s3-multipart"})," have been combined into a single\nplugin. You should now only use ",(0,s.jsx)(n.code,{children:"@uppy/aws-s3"})," with the new option,\n",(0,s.jsx)(n.a,{href:"/docs/aws-s3-multipart/#shouldusemultipartfile",children:(0,s.jsx)(n.code,{children:"shouldUseMultipart()"})}),", to\nallow you to switch between regular and multipart uploads. You can read more\nabout this in the\n",(0,s.jsx)(n.a,{href:"https://uppy.io/docs/aws-s3-multipart/#when-should-i-use-it",children:"plugin docs"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Remove deprecated ",(0,s.jsx)(n.code,{children:"prepareUploadParts"})," option."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Companion\u2019s options (",(0,s.jsx)(n.code,{children:"companionUrl"}),", ",(0,s.jsx)(n.code,{children:"companionHeaders"}),", and\n",(0,s.jsx)(n.code,{children:"companionCookieRules"}),") are renamed to more generic names (",(0,s.jsx)(n.code,{children:"endpoint"}),",\n",(0,s.jsx)(n.code,{children:"headers"}),", and ",(0,s.jsx)(n.code,{children:"cookieRules"}),")."]}),"\n",(0,s.jsxs)(n.p,{children:["Using Companion with the ",(0,s.jsx)(n.code,{children:"@uppy/aws-s3"})," plugin only makes sense if you already\nneed Companion for remote providers (such as Google Drive). When using your\nown backend, you can let Uppy do all the heavy lifting on the client which it\nwould normally do for Companion, so you don\u2019t have to implement that yourself."]}),"\n",(0,s.jsxs)(n.p,{children:["As long as you return the JSON for the expected endpoints (see our\n",(0,s.jsx)(n.a,{href:"https://github.com/transloadit/uppy/blob/main/examples/aws-nodejs/index.js",children:"server example"}),"),\nyou only need to set ",(0,s.jsx)(n.code,{children:"endpoint"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["If you are using Companion, rename the options. If you have a lot of\nclient-side complexity (",(0,s.jsx)(n.code,{children:"createMultipartUpload"}),", ",(0,s.jsx)(n.code,{children:"signPart"}),", etc), consider\nletting Uppy do this for you."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"uppycore",children:(0,s.jsx)(n.code,{children:"@uppy/core"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"close()"})," method has been renamed to ",(0,s.jsx)(n.code,{children:"destroy()"})," to more accurately\nreflect you can not recover from it without creating a new ",(0,s.jsx)(n.code,{children:"Uppy"})," instance."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"clearUploadedFiles()"})," method has been renamed to ",(0,s.jsx)(n.code,{children:"clear()"})," as a\nconvenience method to clear all the state. This can be useful when a user\nnavigates away and you want to clear the state on success."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bytesUploaded"}),", in ",(0,s.jsx)(n.code,{children:"file.progress.bytesUploaded"}),", is now always a ",(0,s.jsx)(n.code,{children:"boolean"}),",\ninstead of a ",(0,s.jsx)(n.code,{children:"boolean"})," or ",(0,s.jsx)(n.code,{children:"number"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"uppyxhr-upload",children:(0,s.jsx)(n.code,{children:"@uppy/xhr-upload"})}),"\n",(0,s.jsxs)(n.p,{children:["Before the plugin had the options ",(0,s.jsx)(n.code,{children:"getResponseData"}),", ",(0,s.jsx)(n.code,{children:"getResponseError"}),",\n",(0,s.jsx)(n.code,{children:"validateStatus"})," and ",(0,s.jsx)(n.code,{children:"responseUrlFieldName"}),". These were inflexible and too\nspecific. Now we have hooks similar to ",(0,s.jsx)(n.code,{children:"@uppy/tus"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"onBeforeRequest"})," to manipulate the request before it is sent."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"shouldRetry"})," to determine if a request should be retried. By default 3\nretries with exponential backoff. After three attempts it will throw an error,\nregardless of whether you returned ",(0,s.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"onAfterResponse"})," called after a successful response but before Uppy resolves\nthe upload."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Checkout the ",(0,s.jsx)(n.a,{href:"/docs/xhr-upload/",children:"docs"})," for more info."]}),"\n",(0,s.jsx)(n.h3,{id:"uppytransloadit",children:(0,s.jsx)(n.code,{children:"@uppy/transloadit"})}),"\n",(0,s.jsxs)(n.p,{children:["The options ",(0,s.jsx)(n.code,{children:"signature"}),", ",(0,s.jsx)(n.code,{children:"params"}),", ",(0,s.jsx)(n.code,{children:"fields"}),", and ",(0,s.jsx)(n.code,{children:"getAssemblyOptions"})," have been\nremoved in favor of ",(0,s.jsx)(n.a,{href:"/docs/transloadit/#assemblyoptions",children:(0,s.jsx)(n.code,{children:"assemblyOptions"})}),",\nwhich can be an object or an (async) function returning an object."]}),"\n",(0,s.jsxs)(n.p,{children:["When using ",(0,s.jsx)(n.code,{children:"assemblyOptions()"})," as a function, it is now called only once for all\nfiles, instead of per file. Before ",(0,s.jsx)(n.code,{children:"@uppy/transloadit"})," was trying to be too\nsmart, creating multiple assemblies in which each assembly has files with\nidentical ",(0,s.jsx)(n.code,{children:"fields"}),". This was done so you can use ",(0,s.jsx)(n.code,{children:"fields"})," dynamically in your\ntemplate per file, instead of per assembly."]}),"\n",(0,s.jsxs)(n.p,{children:["Now we sent all metadata of a file inside the tus upload (which\n",(0,s.jsx)(n.code,{children:"@uppy/transloadit"})," uses under the hood) and make it accessible in your\nTransloadit template as ",(0,s.jsx)(n.code,{children:"file_user_meta"}),". You should use ",(0,s.jsx)(n.code,{children:"fields"})," for global\nvalues in your template and ",(0,s.jsx)(n.code,{children:"file_user_meta"})," for per file values."]}),"\n",(0,s.jsxs)(n.p,{children:["Another benefit of running ",(0,s.jsx)(n.code,{children:"assemblyOptions()"})," only once, is that when\ngenerating a\n",(0,s.jsx)(n.a,{href:"https://transloadit.com/docs/topics/signature-authentication/",children:"secret"})," on your\nserver (which you should), a network request is made only once for all files,\ninstead of per file."]}),"\n",(0,s.jsx)(n.h3,{id:"cdn",children:"CDN"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"We no longer build and serve the legacy build, made for IE11, on our CDN."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"miscellaneous",children:"Miscellaneous"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["All uploaders plugins now consistently use\n",(0,s.jsx)(n.a,{href:"/docs/xhr-upload/#allowedmetafields",children:(0,s.jsx)(n.code,{children:"allowedMetaFields"})}),". Before there were\ninconsistencies between plugins."]}),"\n",(0,s.jsxs)(n.li,{children:["All plugin ",(0,s.jsx)(n.code,{children:"titles"})," (what you see in the Dashboard when you open a plugin) are\nnow set from the ",(0,s.jsx)(n.code,{children:"locale"})," option. See the\n",(0,s.jsx)(n.a,{href:"/docs/locales/#overriding-locale-strings-for-a-specific-plugin",children:"docs"})," on how\nto overide a string."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"uppyangular",children:(0,s.jsx)(n.code,{children:"@uppy/angular"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Upgrade to Angular 18.x (17.x is still supported too) and to TS 5.4"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"uppyreact",children:(0,s.jsx)(n.code,{children:"@uppy/react"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Remove deprecated ",(0,s.jsx)(n.code,{children:"useUppy"})]}),"\n",(0,s.jsxs)(n.li,{children:["You can no longer set ",(0,s.jsx)(n.code,{children:"inline"})," on the ",(0,s.jsx)(n.code,{children:"Dashboard"})," component, use ",(0,s.jsx)(n.code,{children:"Dashboard"}),"\nor ",(0,s.jsx)(n.code,{children:"DashboardModal"})," components respectively."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"uppysvelte",children:(0,s.jsx)(n.code,{children:"@uppy/svelte"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Make Svelte 5 the peer dependency"}),"\n",(0,s.jsx)(n.li,{children:"Remove UMD output"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"uppyvue",children:(0,s.jsx)(n.code,{children:"@uppy/vue"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Migrate to Composition API with TypeScript & drop Vue 2 support"}),"\n",(0,s.jsx)(n.li,{children:"Drop Vue 2 support"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"migrate-from-robodog-to-uppy-plugins",children:"Migrate from Robodog to Uppy plugins"}),"\n",(0,s.jsx)(n.p,{children:"Uppy is flexible and extensible through plugins. But the integration code could\nsometimes be daunting. This is what brought Robodog to life. An alternative with\nthe same features, but with a more ergonomic and minimal API."}),"\n",(0,s.jsx)(n.p,{children:"But, it didn\u2019t come with its own set of new problems:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"It tries to do the exact same, but it looks like a different product."}),"\n",(0,s.jsx)(n.li,{children:"It\u2019s confusing for users whether they want to use Robodog or Uppy directly."}),"\n",(0,s.jsx)(n.li,{children:"Robodog is more ergonomic because it\u2019s limited. When you hit such a limit, you\nneed to refactor everything to Uppy with plugins."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["This has now led us to deprecating Robodog and embrace Uppy for its strong\nsuits; modularity and flexibility. At the same time, we also introduced\nsomething to take away some repetitive integration code:\n",(0,s.jsx)(n.a,{href:"/docs/remote-sources",children:(0,s.jsx)(n.code,{children:"@uppy/remote-sources"})}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["To mimic the Robodog implementation with all its features, you can use the code\nsnippet below. But chances are Robodog did more than you need so feel free to\nremove things or go through the ",(0,s.jsx)(n.a,{href:"/docs/companion/",children:"list of plugins"})," and install\nand use the ones you need."]}),"\n",(0,s.jsxs)(n.p,{children:["You can also checkout how we migrated the Robodog example ourselves in this\n",(0,s.jsx)(n.a,{href:"https://github.com/transloadit/uppy/commit/089aaed615c77bafaf905e291b6b4e82aaeb2f6f",children:"commit"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import Uppy from '@uppy/core';\nimport Dashboard from '@uppy/dashboard';\nimport RemoteSources from '@uppy/remote-sources';\nimport Webcam from '@uppy/webcam';\nimport ScreenCapture from '@uppy/screen-capture';\nimport GoldenRetriever from '@uppy/golden-retriever';\nimport ImageEditor from '@uppy/image-editor';\nimport Audio from '@uppy/audio';\nimport Transloadit, {\n\tCOMPANION_URL,\n\tCOMPANION_ALLOWED_HOSTS,\n} from '@uppy/transloadit';\n\nimport '@uppy/core/css/style.css';\nimport '@uppy/dashboard/css/style.css';\nimport '@uppy/audio/css/style.css';\nimport '@uppy/screen-capture/css/style.css';\nimport '@uppy/image-editor/css/style.css';\n\nnew Uppy()\n\t.use(Dashboard, {\n\t\tinline: true,\n\t\ttarget: '#app',\n\t\tshowProgressDetails: true,\n\t\tproudlyDisplayPoweredByUppy: true,\n\t})\n\t.use(RemoteSources, {\n\t\tcompanionUrl: COMPANION_URL,\n\t\tcompanionAllowedHosts: COMPANION_ALLOWED_HOSTS,\n\t})\n\t.use(Webcam, {\n\t\tshowVideoSourceDropdown: true,\n\t\tshowRecordingLength: true,\n\t})\n\t.use(Audio, {\n\t\tshowRecordingLength: true,\n\t})\n\t.use(ScreenCapture)\n\t.use(ImageEditor)\n\t.use(Transloadit, {\n\t\tservice: 'https://api2.transloadit.com',\n\t\tasync getAssemblyOptions(file) {\n\t\t\t// This is where you configure your auth key, auth secret, and template ID\n\t\t\t// /uppy/docs/transloadit/#getAssemblyOptions-file\n\t\t\t//\n\t\t\t// It is important to set the secret in production:\n\t\t\t// https://transloadit.com/docs/topics/signature-authentication/\n\t\t\tconst response = await fetch('/some-endpoint');\n\t\t\treturn response.json();\n\t\t},\n\t});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"migrate-from-uppy-2x-to-3x",children:"Migrate from Uppy 2.x to 3.x"}),"\n",(0,s.jsx)(n.h3,{id:"uppy-is-pure-esm",children:"Uppy is pure ESM"}),"\n",(0,s.jsxs)(n.p,{children:["Following the footsteps of many packages, we now only ship Uppy core and its\nplugins as\n",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules",children:"ECMAScript Modules"}),"\n(ESM). On Uppy 2.x, we were shipping CommonJS."]}),"\n",(0,s.jsx)(n.p,{children:"If are already using ESM yourself, or are using the CDN builds, nothing changes\nfor you!"}),"\n",(0,s.jsxs)(n.p,{children:["If you are using CommonJS, you might need to add some tooling for everything to\nwork, or you might want to refactor your codebase to ESM \u2013 refer to the\n",(0,s.jsx)(n.a,{href:"https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c",children:"Pure ESM package"}),"\ngist for added information and help on how to do that."]}),"\n",(0,s.jsx)(n.h3,{id:"robodog-is-deprecated",children:"Robodog is deprecated"}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"#Migrate-from-Robodog-to-Uppy-plugins",children:"Robodog migration guide"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"uppycore-1",children:(0,s.jsx)(n.code,{children:"@uppy/core"})}),"\n",(0,s.jsxs)(n.h4,{id:"remove-aggregateerror-polyfill",children:["Remove ",(0,s.jsx)(n.code,{children:"AggregateError"})," polyfill."]}),"\n",(0,s.jsxs)(n.p,{children:["It\u2019s supported by most modern browsers and\n",(0,s.jsx)(n.a,{href:"https://github.com/transloadit/uppy/pull/3532#discussion_r818602636",children:"can be polyfilled by the user"}),"\nif needed."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate: install a ",(0,s.jsx)(n.code,{children:"AggregateError"})," polyfill or use ",(0,s.jsx)(n.code,{children:"core-js"}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"remove-reset-method",children:["Remove ",(0,s.jsx)(n.code,{children:"reset()"})," method."]}),"\n",(0,s.jsxs)(n.p,{children:["It\u2019s a duplicate of ",(0,s.jsx)(n.code,{children:"cancelAll"}),", but with a less intention revealing name."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate: use ",(0,s.jsx)(n.code,{children:"cancelAll"}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"remove-backwards-compatible-exports-static-properties-on-uppy",children:["Remove backwards compatible exports (static properties on ",(0,s.jsx)(n.code,{children:"Uppy"}),")`"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Uppy"}),", ",(0,s.jsx)(n.code,{children:"UIPlugin"}),", ",(0,s.jsx)(n.code,{children:"BasePlugin"}),", and ",(0,s.jsx)(n.code,{children:"debugLogger"})," used to also be accessible\non the ",(0,s.jsx)(n.code,{children:"Uppy"})," export. This has now been removed due to the transition to ESM."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate: import the ",(0,s.jsx)(n.code,{children:"Uppy"})," class by default and/or use named exports for\neverything else."]}),"\n",(0,s.jsxs)(n.h4,{id:"uppyvalidaterestrictions-now-returns-a-restrictionerror",children:[(0,s.jsx)(n.code,{children:"uppy.validateRestrictions()"})," now returns a ",(0,s.jsx)(n.code,{children:"RestrictionError"})]}),"\n",(0,s.jsxs)(n.p,{children:["This method used to return ",(0,s.jsx)(n.code,{children:"{ result: false, reason: err.message }"}),", but that\nfelt strange as it tries to mimic an error. Instead it now return a\n",(0,s.jsx)(n.code,{children:"RestrictionError"}),", which is extended ",(0,s.jsx)(n.code,{children:"Error"})," class."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate: check the return value, if it\u2019s defined you have an error, otherwise\nall went well. Note that the error is ",(0,s.jsx)(n.code,{children:"return"}),"\u2019ed, it\u2019s not ",(0,s.jsx)(n.code,{children:"throw"}),"\u2019n, so you\ndon\u2019t have to ",(0,s.jsx)(n.code,{children:"catch"})," it."]}),"\n",(0,s.jsx)(n.h3,{id:"uppytransloadit-1",children:(0,s.jsx)(n.code,{children:"@uppy/transloadit"})}),"\n",(0,s.jsxs)(n.p,{children:["Remove export of ",(0,s.jsx)(n.code,{children:"ALLOWED_COMPANION_PATTERN"}),", ",(0,s.jsx)(n.code,{children:"COMPANION"}),", and\n",(0,s.jsx)(n.code,{children:"COMPANION_PATTERN"})," in favor of ",(0,s.jsx)(n.code,{children:"COMPANION_URL"})," and ",(0,s.jsx)(n.code,{children:"COMPANION_ALLOWED_HOSTS"}),".\nThis is to have more intention revealing names, ",(0,s.jsx)(n.code,{children:"COMPANION"})," sounds like the\nCompanion instance, ",(0,s.jsx)(n.code,{children:"COMPANION_URL"})," makes it more clear that it\u2019s a URL."]}),"\n",(0,s.jsx)(n.p,{children:"These are properties can now be imported and used for remote sources plugins\nwhen using Transloadit:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { COMPANION_URL, COMPANION_ALLOWED_HOSTS } from '@uppy/transloadit';\n\n// ...\nuppy.use(Dropbox, {\n\tcompanionUrl: COMPANION_URL,\n\tcompanionAllowedHosts: COMPANION_ALLOWED_HOSTS,\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"uppyaws-s3-multipart",children:(0,s.jsx)(n.code,{children:"@uppy/aws-s3-multipart"})}),"\n",(0,s.jsxs)(n.h4,{id:"make-headers-inside-the-return-value-of-prepareuploadparts-part-indexed-too",children:["Make ",(0,s.jsx)(n.code,{children:"headers"})," inside the return value of ",(0,s.jsx)(n.a,{href:"/docs/aws-s3-multipart/#prepareUploadParts-file-partData",children:(0,s.jsx)(n.code,{children:"prepareUploadParts"})})," part-indexed too."]}),"\n",(0,s.jsxs)(n.p,{children:["This is to allow custom headers to be set per part. See this\n",(0,s.jsx)(n.a,{href:"https://github.com/transloadit/uppy/issues/3881",children:"issue"})," for details."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate: make headers part indexed like ",(0,s.jsx)(n.code,{children:"presignedUrls"}),":\n",(0,s.jsx)(n.code,{children:'{ "headers": { "1": { "Content-MD5": "foo" } }}'}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"remove-client-getter-and-setter",children:["Remove ",(0,s.jsx)(n.code,{children:"client"})," getter and setter."]}),"\n",(0,s.jsx)(n.p,{children:"It\u2019s internal usage only."}),"\n",(0,s.jsx)(n.p,{children:"To migrate: use exposed options only."}),"\n",(0,s.jsxs)(n.h3,{id:"uppytus-uppyaws-s3-uppyxhr-upload",children:[(0,s.jsx)(n.code,{children:"@uppy/tus/"}),", ",(0,s.jsx)(n.code,{children:"@uppy/aws-s3"}),", ",(0,s.jsx)(n.code,{children:"@uppy/xhr-upload"})]}),"\n",(0,s.jsxs)(n.p,{children:["Rename ",(0,s.jsx)(n.code,{children:"metaFields"})," option to ",(0,s.jsx)(n.code,{children:"allowedMetaFields"}),". Counter intuitively,\n",(0,s.jsx)(n.code,{children:"metaFields"})," is for ",(0,s.jsx)(n.em,{children:"filtering"})," which ",(0,s.jsx)(n.code,{children:"metaFields"})," to send along with the\nrequest, not for adding extra meta fields to a request. As a lot of people were\nconfused by this, and the name overlaps with the\n",(0,s.jsxs)(n.a,{href:"/docs/dashboard/#metaFields",children:[(0,s.jsx)(n.code,{children:"metaFields"})," option from Dashboard"]}),", we renamed\nit."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate: use ",(0,s.jsx)(n.code,{children:"allowedMetaFields"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"uppyreact-1",children:(0,s.jsx)(n.code,{children:"@uppy/react"})}),"\n",(0,s.jsx)(n.h4,{id:"uppy-dependencies-have-become-peer-dependencies",children:"Uppy dependencies have become peer dependencies"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"@uppy/dashboard"}),", ",(0,s.jsx)(n.code,{children:"@uppy/drag-drop"}),", ",(0,s.jsx)(n.code,{children:"@uppy/file-input"}),", ",(0,s.jsx)(n.code,{children:"@uppy/progress-bar"}),",\nand ",(0,s.jsx)(n.code,{children:"@uppy/status-bar"})," are now peer dependencies. This means you don\u2019t install\nall these packages if you only need one."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate: install only the packages you need. If you use the Dashboard\ncomponent, you need ",(0,s.jsx)(n.code,{children:"@uppy/dashboard"}),", and so onwards."]}),"\n",(0,s.jsxs)(n.h4,{id:"dont-expose-validprops-on-the-exported-components",children:["Don\u2019t expose ",(0,s.jsx)(n.code,{children:"validProps"})," on the exported components."]}),"\n",(0,s.jsx)(n.p,{children:"It\u2019s internal usage only."}),"\n",(0,s.jsx)(n.p,{children:"To migrate: use exposed options only."}),"\n",(0,s.jsx)(n.h3,{id:"uppysvelte-1",children:(0,s.jsx)(n.code,{children:"@uppy/svelte"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"@uppy/dashboard"}),", ",(0,s.jsx)(n.code,{children:"@uppy/drag-drop"}),", ",(0,s.jsx)(n.code,{children:"@uppy/progress-bar"}),", and\n",(0,s.jsx)(n.code,{children:"@uppy/status-bar"})," are now peer dependencies. This means you don\u2019t install all\nthese packages if you only need one."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate: install only the packages you need. If you use the Dashboard\ncomponent, you need ",(0,s.jsx)(n.code,{children:"@uppy/dashboard"}),", and so onwards."]}),"\n",(0,s.jsx)(n.h3,{id:"uppyvue-1",children:(0,s.jsx)(n.code,{children:"@uppy/vue"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"@uppy/dashboard"}),", ",(0,s.jsx)(n.code,{children:"@uppy/drag-drop"}),", ",(0,s.jsx)(n.code,{children:"@uppy/file-input"}),", ",(0,s.jsx)(n.code,{children:"@uppy/progress-bar"}),",\nand ",(0,s.jsx)(n.code,{children:"@uppy/status-bar"})," are now peer dependencies. This means you don\u2019t install\nall these packages if you only need one."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate: install only the packages you need. If you use the Dashboard\ncomponent, you need ",(0,s.jsx)(n.code,{children:"@uppy/dashboard"}),", and so onwards."]}),"\n",(0,s.jsx)(n.h3,{id:"uppystore-redux",children:(0,s.jsx)(n.code,{children:"@uppy/store-redux"})}),"\n",(0,s.jsxs)(n.p,{children:["Remove backwards compatible exports (static properties on ",(0,s.jsx)(n.code,{children:"ReduxStore"}),").\nExports, such as ",(0,s.jsx)(n.code,{children:"reducer"}),", used to also be accessible on the ",(0,s.jsx)(n.code,{children:"ReduxStore"}),"\nexport. This has now been removed due to the transition to ESM."]}),"\n",(0,s.jsx)(n.p,{children:"To migrate: use named imports."}),"\n",(0,s.jsx)(n.h3,{id:"uppythumbnail-generator",children:(0,s.jsx)(n.code,{children:"@uppy/thumbnail-generator"})}),"\n",(0,s.jsxs)(n.p,{children:["Remove ",(0,s.jsx)(n.code,{children:"rotateImage"}),", ",(0,s.jsx)(n.code,{children:"protect"}),", and ",(0,s.jsx)(n.code,{children:"canvasToBlob"})," from the plugin prototype.\nThey are internal usage only."]}),"\n",(0,s.jsx)(n.p,{children:"To migrate: use exposed options only."}),"\n",(0,s.jsx)(n.h3,{id:"known-issues",children:"Known issues"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.a,{href:"https://github.com/transloadit/uppy/issues/4057",children:[(0,s.jsx)(n.code,{children:"ERESOLVE could not resolve"})," on npm install"]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/transloadit/uppy/issues/4069",children:"@uppy/svelte reports a broken dependency with the Vite bundler"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"migrate-from-companion-3x-to-4x",children:"Migrate from Companion 3.x to 4.x"}),"\n",(0,s.jsx)(n.h3,{id:"minimum-required-nodejs-version-is-v14200",children:"Minimum required Node.js version is v14.20.0"}),"\n",(0,s.jsxs)(n.p,{children:["Aligning with the Node.js\n",(0,s.jsx)(n.a,{href:"https://nodejs.org/en/about/releases/",children:"Long Term Support (LTS) schedule"})," and to\nuse modern syntax features."]}),"\n",(0,s.jsxs)(n.h3,{id:"companionapp-returns--app-emitter--instead-of-app",children:[(0,s.jsx)(n.code,{children:"companion.app()"})," returns ",(0,s.jsx)(n.code,{children:"{ app, emitter }"})," instead of ",(0,s.jsx)(n.code,{children:"app"})]}),"\n",(0,s.jsxs)(n.p,{children:["Companion 3.x provides the emitter as ",(0,s.jsx)(n.code,{children:"companionEmitter"})," on ",(0,s.jsx)(n.code,{children:"app"}),". As of 4.x, an\nobject is returned with an ",(0,s.jsx)(n.code,{children:"app"})," property (express middleware) and an ",(0,s.jsx)(n.code,{children:"emitter"}),"\nproperty (event emitter). This provides more flexibility in the future and\nfollows best practices."]}),"\n",(0,s.jsxs)(n.h3,{id:"removed-searchproviders-wrapper-object-inside-provideroptions",children:["Removed ",(0,s.jsx)(n.code,{children:"searchProviders"})," wrapper object inside ",(0,s.jsx)(n.code,{children:"providerOptions"})]}),"\n",(0,s.jsxs)(n.p,{children:["To use ",(0,s.jsx)(n.a,{href:"/docs/unsplash",children:(0,s.jsx)(n.code,{children:"@uppy/unsplash"})}),", you had to configure Unsplash in\nCompanion inside ",(0,s.jsx)(n.code,{children:"providerOptions.searchProviders"}),". This is redundant, Unsplash\nis a provider as well so we removed the wrapper object."]}),"\n",(0,s.jsxs)(n.h3,{id:"moved-the-s3-options-out-of-provideroptions",children:["Moved the ",(0,s.jsx)(n.code,{children:"s3"})," options out of ",(0,s.jsx)(n.code,{children:"providerOptions"})]}),"\n",(0,s.jsxs)(n.p,{children:["To use AWS S3 for storage, you configured the ",(0,s.jsx)(n.code,{children:"s3"})," object inside\n",(0,s.jsx)(n.code,{children:"providerOptions"}),". But as S3 is not a provider but a destination. To avoid\nconfusion we moved the ",(0,s.jsx)(n.code,{children:"s3"})," settings to the root settings object."]}),"\n",(0,s.jsx)(n.h3,{id:"removed-compatibility-for-legacy-custom-provider-implementations",children:"Removed compatibility for legacy Custom Provider implementations"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/docs/companion/#Adding-custom-providers",children:"Custom Provider"})," implementations must\nuse the Promise API. The callback API is no longer supported."]}),"\n",(0,s.jsx)(n.h3,{id:"default-to-no-acl-for-aws-s3",children:"Default to no ACL for AWS S3"}),"\n",(0,s.jsxs)(n.p,{children:["Default to no\n",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html",children:"ACL"}),"\nfor S3 uploads. Before the default was ",(0,s.jsx)(n.code,{children:"public-read"})," but AWS now discourages\nACLs. The environment variable ",(0,s.jsx)(n.code,{children:"COMPANION_AWS_DISABLE_ACL"})," is also removed,\ninstead Companion only uses ",(0,s.jsx)(n.code,{children:"COMPANION_AWS_ACL"}),"."]}),"\n",(0,s.jsxs)(n.h3,{id:"protocol-sent-from-uppy-in-any-get-request-is-now-required-before-it-would-default-to-multipart",children:[(0,s.jsx)(n.code,{children:"protocol"})," sent from Uppy in any ",(0,s.jsx)(n.code,{children:"get"})," request is now required (before it would default to Multipart)."]}),"\n",(0,s.jsxs)(n.p,{children:["If you use any official Uppy plugins, then no migration is needed. For custom\nplugins that talk to Companion, make to send along the ",(0,s.jsx)(n.code,{children:"protocol"})," header with a\nvalue of ",(0,s.jsx)(n.code,{children:"multipart"}),", ",(0,s.jsx)(n.code,{children:"s3Multipart"}),", or ",(0,s.jsx)(n.code,{children:"tus"}),"."]}),"\n",(0,s.jsxs)(n.h3,{id:"emitsuccess-and-emiterror-are-now-private-methods-on-the-uploader-class",children:[(0,s.jsx)(n.code,{children:"emitSuccess"})," and ",(0,s.jsx)(n.code,{children:"emitError"})," are now private methods on the ",(0,s.jsx)(n.code,{children:"Uploader"})," class."]}),"\n",(0,s.jsx)(n.p,{children:"It\u2019s unlikely you\u2019re using this, but it\u2019s technically a breaking change. In\ngeneral, don\u2019t depend on implicitly internal methods, use exposed APIs instead."}),"\n",(0,s.jsxs)(n.h3,{id:"removed-chunksize-backwards-compatibility-for-aws-s3-multipart",children:["Removed ",(0,s.jsx)(n.code,{children:"chunkSize"})," backwards compatibility for AWS S3 Multipart"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"chunkSize"})," option will now be used as ",(0,s.jsx)(n.code,{children:"partSize"})," in AWS multipart. Before only\nvalid values would be respected. Invalid values would be ignored. Now any value\nwill be passed on to the AWS SDK, possibly throwing an error on invalid values."]}),"\n",(0,s.jsxs)(n.h3,{id:"removed-backwards-compatibility-for-metrics-endpoint",children:["Removed backwards compatibility for ",(0,s.jsx)(n.code,{children:"/metrics"})," endpoint"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"metrics"})," option is a boolean flag to tell Companion whether to provide an\nendpoint ",(0,s.jsx)(n.code,{children:"/metrics"})," with Prometheus metrics. Metrics will now always be served\nunder ",(0,s.jsx)(n.code,{children:"options.server.path"}),". Before v4.x, it would always be served under the\nroot."]}),"\n",(0,s.jsxs)(n.p,{children:["For example: if ",(0,s.jsx)(n.code,{children:"{ options: { metrics: true, server: { path: '/companion' }}}"}),",\nmetrics will now be served under ",(0,s.jsx)(n.code,{children:"/companion/metrics"}),". In v3.x, the metrics\nwould be served under ",(0,s.jsx)(n.code,{children:"/metrics"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"migrate-from-uppy-1x-to-2x",children:"Migrate from Uppy 1.x to 2.x"}),"\n",(0,s.jsx)(n.h3,{id:"new-bundle-requires-manual-polyfilling",children:"New bundle requires manual polyfilling"}),"\n",(0,s.jsxs)(n.p,{children:["With 2.0, following in the footsteps of Microsoft, we are dropping support for\nIE11. As a result, we are able to remove all built-in polyfills, and the new\nbundle size is ",(0,s.jsx)(n.strong,{children:"25% smaller"}),"! If you want your app to still support older\nbrowsers (such as IE11), you may need to add the following polyfills to your\nbundle:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/mo/abortcontroller-polyfill",children:"abortcontroller-polyfill"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/zloirock/core-js",children:"core-js"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/mozdevs/mediaDevices-getUserMedia-polyfill",children:"md-gum-polyfill"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/que-etc/resize-observer-polyfill",children:"resize-observer-polyfill"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/github/fetch",children:"whatwg-fetch"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If you\u2019re using a bundler, you need import these before Uppy:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import 'core-js';\nimport 'whatwg-fetch';\nimport 'abortcontroller-polyfill/dist/polyfill-patch-fetch';\n// Order matters here: AbortController needs fetch, which needs Promise (provided by core-js).\n\nimport 'md-gum-polyfill';\nimport ResizeObserver from 'resize-observer-polyfill';\n\nwindow.ResizeObserver ??= ResizeObserver;\n\nexport { default } from '@uppy/core';\nexport * from '@uppy/core';\n"})}),"\n",(0,s.jsx)(n.p,{children:"If you\u2019re using Uppy from a CDN, we now provide two bundles: one for up-to-date\nbrowsers that do not include polyfills and use modern syntax, and one for legacy\nbrowsers. When migrating, be mindful about the types of browsers you want to\nsupport:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'\x3c!-- Modern browsers (recommended) --\x3e\n<script src="https://releases.transloadit.com/uppy/v3.17.0/uppy.min.js"><\/script>\n\n\x3c!-- Legacy browsers (IE11+) --\x3e\n<script\n\tnomodule\n\tsrc="https://releases.transloadit.com/uppy/v3.17.0/uppy.legacy.min.js"\n><\/script>\n<script type="module">\n\timport \'https://releases.transloadit.com/uppy/v3.17.0/uppy.min.js\';\n<\/script>\n'})}),"\n",(0,s.jsx)(n.p,{children:"Please note that while you may be able to get 2.0 to work in IE11 this way, we\ndo not officially support it anymore."}),"\n",(0,s.jsxs)(n.h3,{id:"use-baseplugin-or-uiplugin-instead-of-plugin",children:["Use ",(0,s.jsx)(n.code,{children:"BasePlugin"})," or ",(0,s.jsx)(n.code,{children:"UIPlugin"})," instead of ",(0,s.jsx)(n.code,{children:"Plugin"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/docs/uppy/",children:(0,s.jsx)(n.code,{children:"@uppy/core"})})," used to provide a ",(0,s.jsx)(n.code,{children:"Plugin"})," class for creating plugins. This\nwas used for any official plugin, but also for users who want to create their\nown custom plugin. But, ",(0,s.jsx)(n.code,{children:"Plugin"})," always came bundled with Preact, even if the\nplugin itself didn\u2019t add any UI elements."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Plugin"})," has been replaced with ",(0,s.jsx)(n.code,{children:"BasePlugin"})," and ",(0,s.jsx)(n.code,{children:"UIPlugin"}),". ",(0,s.jsx)(n.code,{children:"BasePlugin"})," is the\nminimum you need to create a plugin and ",(0,s.jsx)(n.code,{children:"UIPlugin"})," adds Preact for rendering\nuser interfaces."]}),"\n",(0,s.jsxs)(n.p,{children:["You can import them from ",(0,s.jsx)(n.a,{href:"/docs/uppy/",children:(0,s.jsx)(n.code,{children:"@uppy/core"})}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { BasePlugin, UIPlugin } from '@uppy/core';\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," some bundlers will include ",(0,s.jsx)(n.code,{children:"UIPlugin"})," (and thus Preact) if you import\nfrom ",(0,s.jsx)(n.code,{children:"@uppy/core"}),". To make sure this does not happen, you can import ",(0,s.jsx)(n.code,{children:"Uppy"})," and\n",(0,s.jsx)(n.code,{children:"BasePlugin"})," directly:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import Uppy from '@uppy/core/lib/Uppy.js';\nimport BasePlugin from '@uppy/core/lib/BasePlugin.js';\n"})}),"\n",(0,s.jsx)(n.h3,{id:"use-the-latest-preact-for-your-uppy-plugins",children:"Use the latest Preact for your Uppy plugins"}),"\n",(0,s.jsxs)(n.p,{children:["Official plugins have already been upgraded. If you are using any custom\nplugins, upgrade Preact to the latest version. At the time of writing this is\n",(0,s.jsx)(n.code,{children:"10.5.13"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"set-plugin-titles-from-locales",children:"Set plugin titles from locales"}),"\n",(0,s.jsxs)(n.p,{children:["Titles for plugins used to be set with the ",(0,s.jsx)(n.code,{children:"title"})," property in the plugin\noptions, but all other strings are set in ",(0,s.jsx)(n.code,{children:"locale"}),". This has now been aligned.\nYou should set your plugin title from the ",(0,s.jsx)(n.code,{children:"locale"})," property."]}),"\n",(0,s.jsx)(n.p,{children:"Before"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import Webcam from '@uppy/webcam';\n\nuppy.use(Webcam, {\n\ttitle: 'Some title',\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:"After"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import Webcam from '@uppy/webcam';\n\nuppy.use(Webcam, {\n\tlocale: {\n\t\tstrings: {\n\t\t\ttitle: 'Some title',\n\t\t},\n\t},\n});\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"initialize-uppy-with-the-new-keyword",children:["Initialize Uppy with the ",(0,s.jsx)(n.code,{children:"new"})," keyword"]}),"\n",(0,s.jsxs)(n.p,{children:["The default export ",(0,s.jsx)(n.code,{children:"Uppy"})," is no longer callable as a function. This means you\nconstruct the ",(0,s.jsx)(n.code,{children:"Uppy"})," instance using the ",(0,s.jsx)(n.code,{children:"new"})," keyword."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import Uppy from '@uppy/core';\n\nconst uppy = new Uppy(); // correct.\n\nconst otherUppy = Uppy(); // incorrect, will throw.\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"rename-allowmultipleuploads-to-allowmultipleuploadbatches",children:["Rename ",(0,s.jsx)(n.code,{children:"allowMultipleUploads"})," to ",(0,s.jsx)(n.code,{children:"allowMultipleUploadBatches"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/docs/uppy/#allowmultipleuploadbatches",children:(0,s.jsx)(n.code,{children:"allowMultipleUploadBatches"})})," means\nallowing several calls to ",(0,s.jsx)(n.a,{href:"/docs/uppy/#upload",children:(0,s.jsx)(n.code,{children:".upload()"})}),", in other words, a\nuser can add more files after already having uploaded some."]}),"\n",(0,s.jsx)(n.p,{children:"We have renamed this to be more intention revealing that this is about uploads,\nand not whether a user can choose multiple files for one upload."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const uppy = new Uppy({\n\tallowMultipleUploadBatches: true,\n});\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"new-default-limits-for-uppyxhr-upload-and-uppytus",children:["New default limits for ",(0,s.jsx)(n.a,{href:"/docs/xhr-upload/",children:(0,s.jsx)(n.code,{children:"@uppy/xhr-upload"})})," and ",(0,s.jsx)(n.a,{href:"/docs/tus/",children:(0,s.jsx)(n.code,{children:"@uppy/tus"})})]}),"\n",(0,s.jsxs)(n.p,{children:["The default limit has been changed from ",(0,s.jsx)(n.code,{children:"0"})," to ",(0,s.jsx)(n.code,{children:"5"}),". Setting this to ",(0,s.jsx)(n.code,{children:"0"})," means no\nlimit on concurrent uploads."]}),"\n",(0,s.jsx)(n.p,{children:"You can change the limit on the Tus and XHR plugin options."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"uppy.use(Tus, {\n\t// ...\n\tlimit: 10,\n});\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"uppy.use(XHRUpload, {\n\t// ...\n\tlimit: 10,\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"typescript-changes",children:"TypeScript changes"}),"\n",(0,s.jsxs)(n.p,{children:["Uppy used to have loose types by default and strict types as an opt-in. The\ndefault export was a function that returned the ",(0,s.jsx)(n.code,{children:"Uppy"})," class, and the types came\nbundled with the default export (",(0,s.jsx)(n.code,{children:"Uppy.SomeType"}),")."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import Uppy from '@uppy/core';\nimport Tus from '@uppy/tus';\n\nconst uppy = Uppy<Uppy.StrictTypes>();\n\nuppy.use(Tus, {\n\tinvalidOption: null, // this will make the compilation fail!\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:"Uppy is now strictly typed by default and loose types have been removed."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// ...\n\nconst uppy = new Uppy();\n\nuppy.use(Tus, {\n\tinvalidOption: null, // this will make the compilation fail!\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:"Uppy types are now individual exports and should be imported separately."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import type { PluginOptions, UIPlugin, PluginTarget } from '@uppy/core';\n"})}),"\n",(0,s.jsx)(n.h4,{id:"event-types",children:"Event types"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/docs/uppy/",children:(0,s.jsx)(n.code,{children:"@uppy/core"})})," provides an ",(0,s.jsx)(n.a,{href:"/docs/uppy/#uppy-on-39-event-39-action",children:(0,s.jsx)(n.code,{children:".on"})}),"\nmethod to listen to ",(0,s.jsx)(n.a,{href:"/docs/uppy/#Events",children:"events"}),". The types for these events\nwere loose and allowed for invalid events to be passed, such as\n",(0,s.jsx)(n.code,{children:"uppy.on('upload-errrOOOoooOOOOOrrrr')"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Before:\n\ntype Meta = { myCustomMetadata: string };\n\n// Invalid event\nuppy.on<Meta>('upload-errrOOOoooOOOOOrrrr', () => {\n\t// ...\n});\n\n// After:\n\n// Normal event signature\nuppy.on('complete', (result) => {\n\tconst successResults = result.successful;\n});\n\n// Custom signature\ntype Meta = { myCustomMetadata: string };\n\n// Notice how the custom type has now become the second argument\nuppy.on<'complete', Meta>('complete', (result) => {\n\t// The passed type is now merged into the `meta` types.\n\tconst meta = result.successful[0].meta.myCustomMetadata;\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Plugins that add their own events can merge with existing ones in ",(0,s.jsx)(n.code,{children:"@uppy/core"}),"\nwith ",(0,s.jsx)(n.code,{children:"declare module '@uppy/core' { ... }"}),". This is a TypeScript pattern called\n",(0,s.jsx)(n.a,{href:"https://www.typescriptlang.org/docs/handbook/declaration-merging.html#module-augmentation",children:"module augmentation"}),".\nFor instance, when using ",(0,s.jsx)(n.a,{href:"/docs/dashboard/",children:(0,s.jsx)(n.code,{children:"@uppy/dashboard"})}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"uppy.on('dashboard:file-edit-start', (file) => {\n\tconst fileName = file.name;\n});\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"changes-to-pre-signing-urls-for-uppyaws-s3-multipart",children:["Changes to pre-signing URLs for ",(0,s.jsx)(n.a,{href:"/docs/aws-s3-multipart/",children:(0,s.jsx)(n.code,{children:"@uppy/aws-s3-multipart"})})]}),"\n",(0,s.jsxs)(n.p,{children:["See the Uppy 2.0.0 announcement post about the batch\n",(0,s.jsx)(n.a,{href:"/blog/2021/08/2.0/#Batch-pre-signing-URLs-for-AWS-S3-Multipart",children:"pre-signing URLs change"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"prepareUploadPart"})," has been renamed to\n",(0,s.jsx)(n.a,{href:"/docs/aws-s3-multipart/#prepareUploadParts-file-partData",children:(0,s.jsx)(n.code,{children:"prepareUploadParts"})}),"\n(plural). See the documentation link on how to use this function."]}),"\n",(0,s.jsxs)(n.h3,{id:"removed-the-run-method-from-uppycore",children:["Removed the ",(0,s.jsx)(n.code,{children:".run"})," method from ",(0,s.jsx)(n.a,{href:"/docs/uppy/",children:(0,s.jsx)(n.code,{children:"@uppy/core"})})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".run"})," method on the ",(0,s.jsx)(n.code,{children:"Uppy"})," instance has been removed. This method was\nalready obsolete and only logged a warning. As of this major version, it no\nlonger exists."]}),"\n",(0,s.jsxs)(n.h3,{id:"removed-resume-and-removefingerprintonsuccess-options-from-uppytus",children:["Removed ",(0,s.jsx)(n.code,{children:"resume"})," and ",(0,s.jsx)(n.code,{children:"removeFingerprintOnSuccess"})," options from ",(0,s.jsx)(n.a,{href:"/docs/tus/",children:(0,s.jsx)(n.code,{children:"@uppy/tus"})})]}),"\n",(0,s.jsx)(n.p,{children:"Tus will now by default try to resume uploads if the upload has been started in\nthe past."}),"\n",(0,s.jsxs)(n.p,{children:["This also means tus will store some data in localStorage for each upload, which\nwill automatically be removed on success. Making ",(0,s.jsx)(n.code,{children:"removeFingerprintOnSuccess"}),"\nobsolete too."]}),"\n",(0,s.jsx)(n.h3,{id:"thats-it",children:"That\u2019s it!"}),"\n",(0,s.jsxs)(n.p,{children:["Uppy 1.0 will continue to receive bug fixes for three more months (until\n",(0,s.jsx)(n.time,{dateTime:"2021-12-01",children:"1 December 2021"}),"), security fixes for one more\nyear (until ",(0,s.jsx)(n.time,{dateTime:"2022-09-01",children:"1 September 2022"}),"), but no more\nnew features after today. Exceptions are unlikely, but ",(0,s.jsx)(n.em,{children:"can"})," be made \u2013 to\naccommodate those with commercial support contracts, for example."]}),"\n",(0,s.jsxs)(n.p,{children:["We hope you\u2019ll waste no time in taking Uppy 2.0 out for a walk. When you do,\nplease let us know what you thought of it on\n",(0,s.jsx)(n.a,{href:"https://www.reddit.com/r/javascript/comments/penbr7/uppy_file_uploader_20_smaller_and_faster_modular/",children:"Reddit"}),",\n",(0,s.jsx)(n.a,{href:"https://news.ycombinator.com/item?id=28359287",children:"HN"}),", ProductHunt, or\n",(0,s.jsx)(n.a,{href:"https://twitter.com/uppy_io/status/1432399270846603264",children:"Twitter"}),". We\u2019re howling\nat the moon to hear from you!"]}),"\n",(0,s.jsx)(n.h2,{id:"migrate-from-companion-1x-to-2x",children:"Migrate from Companion 1.x to 2.x"}),"\n",(0,s.jsx)(n.h3,{id:"prerequisite",children:"Prerequisite"}),"\n",(0,s.jsxs)(n.p,{children:["Since v2, you now need to be running ",(0,s.jsx)(n.code,{children:"node.js >= v10.20.1"})," to use Companion."]}),"\n",(0,s.jsx)(n.h3,{id:"provideroptions",children:"ProviderOptions"}),"\n",(0,s.jsxs)(n.p,{children:["In v2 the ",(0,s.jsx)(n.code,{children:"google"})," and ",(0,s.jsx)(n.code,{children:"microsoft"})," ",(0,s.jsx)(n.a,{href:"/docs/companion/#Options",children:"providerOptions"}),"\nhave been changed to ",(0,s.jsx)(n.code,{children:"drive"})," and ",(0,s.jsx)(n.code,{children:"onedrive"})," respectively."]}),"\n",(0,s.jsx)(n.h3,{id:"oauth-redirect-uris",children:"OAuth Redirect URIs"}),"\n",(0,s.jsx)(n.p,{children:"On your Providers\u2019 respective developer platforms, the OAuth redirect URIs that\nyou should supply has now changed from:"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"http(s)://$COMPANION_HOST_NAME/connect/$AUTH_PROVIDER/callback"})," in v1"]}),"\n",(0,s.jsx)(n.p,{children:"to:"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"http(s)://$COMPANION_HOST_NAME/$PROVIDER_NAME/redirect"})," in v2"]}),"\n",(0,s.jsx)(n.h4,{id:"new-redirect-uris",children:"New Redirect URIs"}),"\n",(0,s.jsxs)(n.div,{className:"table-responsive",children:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Provider"}),(0,s.jsx)(n.th,{children:"New Redirect URI"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Dropbox"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://$COMPANION_HOST_NAME/dropbox/redirect"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Google Drive"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://$COMPANION_HOST_NAME/drive/redirect"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Google Photos"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://$COMPANION_HOST_NAME/googlephotos/redirect"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"OneDrive"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://$COMPANION_HOST_NAME/onedrive/redirect"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Box"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://$YOUR_COMPANION_HOST_NAME/box/redirect"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Facebook"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://$COMPANION_HOST_NAME/facebook/redirect"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Instagram"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://$COMPANION_HOST_NAME/instagram/redirect"})})]})]})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>t,x:()=>d});var s=o(96540);const r={},i=s.createContext(r);function t(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);