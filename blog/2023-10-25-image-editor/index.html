<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Scaling Images on Rotation | Uppy</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://uppy.io/blog/2023-10-25-image-editor/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:domain" content="uppy.io"><meta data-rh="true" name="twitter:title" content="Uppy"><meta data-rh="true" name="twitter:description" content="Sleek, modular open source JavaScript file uploader"><meta data-rh="true" property="og:title" content="Scaling Images on Rotation | Uppy"><meta data-rh="true" name="description" content="We recently released an ‚Äúimage scaling on rotation‚Äù feature for Uppy‚Äôs"><meta data-rh="true" property="og:description" content="We recently released an ‚Äúimage scaling on rotation‚Äù feature for Uppy‚Äôs"><meta data-rh="true" property="og:image" content="https://uppy.io/img/blog/3.4-3.13/single-file-mode.jpg"><meta data-rh="true" name="twitter:image" content="https://uppy.io/img/blog/3.4-3.13/single-file-mode.jpg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-12-08T00:00:00.000Z"><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://uppy.io/blog/2023-10-25-image-editor/"><link data-rh="true" rel="alternate" href="https://uppy.io/blog/2023-10-25-image-editor/" hreflang="en"><link data-rh="true" rel="alternate" href="https://uppy.io/blog/2023-10-25-image-editor/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Q65IKQHNN5-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://uppy.io/blog/2023-10-25-image-editor","mainEntityOfPage":"https://uppy.io/blog/2023-10-25-image-editor","url":"https://uppy.io/blog/2023-10-25-image-editor","headline":"Scaling Images on Rotation","name":"Scaling Images on Rotation","description":"We recently released an ‚Äúimage scaling on rotation‚Äù feature for Uppy‚Äôs","datePublished":"2023-12-08T00:00:00.000Z","author":[{"@type":"Person","name":"Evgenia Karunus","email":"lakesare@gmail.com","image":"https://github.com/lakesare.png"},{"@type":"Person","name":"Tim Koschuetzki","email":"tim@transloadit.com","image":"https://github.com/tim-kos.png"}],"image":{"@type":"ImageObject","@id":"https://uppy.io/img/blog/3.4-3.13/single-file-mode.jpg","url":"https://uppy.io/img/blog/3.4-3.13/single-file-mode.jpg","contentUrl":"https://uppy.io/img/blog/3.4-3.13/single-file-mode.jpg","caption":"title image for the blog post: Scaling Images on Rotation"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://uppy.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Uppy RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Uppy Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Uppy" href="/opensearch.xml">

<meta name="google-site-verification" content="JxARoHXoCI8bD07pLV_u3z6xpuWNcSIZIcHEytyCkUc">
<script src="https://plausible.io/js/script.js" async defer="defer" data-domain="uppy.io"></script>
<script src="https://buttons.github.io/buttons.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.ace1aa52.css">
<script src="/assets/js/runtime~main.c876da70.js" defer="defer"></script>
<script src="/assets/js/main.9c387641.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><p class="header_wuUL"><a href="/blog/uppy-4.0/">Uppy 4.0 is here: TypeScript rewrite, Google Photos, React hooks, and much more.</a></p><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Uppy Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Uppy Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Uppy</b></a><a class="navbar__item navbar__link" href="/docs/quick-start/">Docs</a><a class="navbar__item navbar__link" href="/examples/">Examples</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a><a href="https://github.com/transloadit/uppy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://community.transloadit.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://transloadit.com/open-source/support/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/uppy-4.0/">New Uppy 4.0 major: TypeScript rewrite, Google Photos, React hooks, and much more</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/07/3.13-3.21/">üéÑ Uppy 3.13 to 3.21: Typescript Saga: the beginning, Image Editor improvements, Dashboard auto-install</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2023-10-25-image-editor/">Scaling Images on Rotation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/07/3.3-3.13/">Uppy 3.3 to 3.13: conditional S3 multipart, signing on the client, speedy handling of 10k files and much much more</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023-05-new-website/">New Uppy.io and docs</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Scaling Images on Rotation</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-12-08T00:00:00.000Z">December 8, 2023</time> ¬∑ <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="mailto:lakesare@gmail.com" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/lakesare.png" alt="Evgenia Karunus"></a><div class="avatar__intro"><div class="avatar__name"><a href="mailto:lakesare@gmail.com" target="_blank" rel="noopener noreferrer"><span>Evgenia Karunus</span></a></div></div></div></div><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="mailto:tim@transloadit.com" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/tim-kos.png" alt="Tim Koschuetzki"></a><div class="avatar__intro"><div class="avatar__name"><a href="mailto:tim@transloadit.com" target="_blank" rel="noopener noreferrer"><span>Tim Koschuetzki</span></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>We recently released an ‚Äúimage scaling on rotation‚Äù feature for Uppy‚Äôs
<a href="https://uppy.io/docs/image-editor/" target="_blank" rel="noopener noreferrer">Image Editor</a>, an often-requested feature
that we‚Äôre super proud to be able to announce.</p>
<p>In this blog post, we‚Äôll be taking a peek behind the curtain, as we take a
detailed look into the development of this feature, and our thought-process
approaching it.</p>
<p>Before we start though, take a look below at a comparison between how Uppy‚Äôs
Image Editor used to handle image rotations, and how it handles them now.</p>

  
  
  <table textalign:="">
  <thead>
  <tr>
    <th colspan="{2}">
      Rotation
    </th>
  </tr><tr>
    <th>Without scaling</th>
    <th>With scaling</th>
  </tr>
  </thead><tbody>
  <tr>
  <td>
    <video controls="" muted="" autoplay="">
      <source src="/img/blog/2023-10-25-image-editor/without-scaling.mov" type="video/mp4">
    </video>
  </td><td>
    <video controls="" muted="" autoplay="">
      <source src="/img/blog/2023-10-25-image-editor/with-scaling.mov" type="video/mp4">
    </video>
  </td>
  </tr>
  </tbody></table>
<p>Without further ado, let‚Äôs dive into some of the finer technical details, so you
can follow along and implement this feature into your own image editor.</p>
<p>The above UI is present in many image editors - for example, the default image
editors on iOS and Android both employ it. Often users expect this behaviour
too, leading to some confusion when their images are left with ugly corners
after a rotation.</p>
<p>We implemented this in Uppy‚Äôs Image Editor last week, and the solution turned
out to be non-trivial. Since this is a pretty ubiquitous task to solve for all
image editors, we decided to release our solution to the world and write out a
post about it, instead of keeping it hidden away as part of internal notes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-steps">3 Steps<a class="hash-link" aria-label="Direct link to 3 Steps" title="Direct link to 3 Steps" href="/blog/2023-10-25-image-editor/#3-steps">‚Äã</a></h2>
<p>There are <strong>3 steps</strong> to our scaling implementation:</p>
<ol>
<li>Ask your designer what scaling on rotation should look like</li>
<li>Find the <code>.scale()</code> function</li>
<li>Calculating the geometry</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-trust-your-designer">1. Trust your designer<a class="hash-link" aria-label="Direct link to 1. Trust your designer" title="Direct link to 1. Trust your designer" href="/blog/2023-10-25-image-editor/#1-trust-your-designer">‚Äã</a></h3>
<p>When I first approached this task, my gut-instinct was to go for the ‚Äúrotated
rectangle inscribed within another rectangle‚Äù solution so that the largest-area
inscription possible is achieved. This route turned out to be an unpleasant user
experience, so take this as an important lesson in trusting your designer, and
consulting them first on what the user might want.</p>
<p>Alternatively, you can choose to trust our designer‚Äôs advice by:</p>
<ul>
<li>always rotating the image around the center of the image (intersection of the
diagonals)</li>
<li>just enlarging the image to remove any empty corners</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-find-the-scale-function">2. Find the <code>.scale()</code> function<a class="hash-link" aria-label="Direct link to 2-find-the-scale-function" title="Direct link to 2-find-the-scale-function" href="/blog/2023-10-25-image-editor/#2-find-the-scale-function">‚Äã</a></h3>
<p>To enlarge the image in a way that covers empty corners, we first need a scaling
function. Uppy uses <a href="https://github.com/fengyuanchen/cropperjs" target="_blank" rel="noopener noreferrer">cropperjs v1.x</a>
as an image editing library, which exposes the <code>cropper.scale(scalingFactor)</code>
function. Most image editing libraries are likely to have a similar function,
but of course feel free to code one yourself if you feel up to the challenge.</p>
<p>Importantly, the scaling function should
<a href="https://en.wikipedia.org/wiki/Scaling_(geometry)#Uniform_scaling" target="_blank" rel="noopener noreferrer">uniformly enlarge</a>
the image <em>around its center</em>, where the <code>scalingFactor</code> is determined by
<code>desiredHeight/oldHeight</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-calculate-the-geometry">3. Calculate the geometry<a class="hash-link" aria-label="Direct link to 3. Calculate the geometry" title="Direct link to 3. Calculate the geometry" href="/blog/2023-10-25-image-editor/#3-calculate-the-geometry">‚Äã</a></h3>
<p>Now, we want to draw our before-rotation &amp; after-rotation shapes on the same
picture, and apply some trigonometry. If you need to brush up on the mathematics
behind this, we recommend watching the following Khan Academy lessons on
<a href="https://www.khanacademy.org/test-prep/praxis-math/praxis-math-lessons/gtp--praxis-math--lessons--geometry/a/gtp--praxis-math--article--angles--lesson" target="_blank" rel="noopener noreferrer">how angles work</a>
and
<a href="https://www.khanacademy.org/math/geometry/hs-geo-trig/hs-geo-trig-ratios-intro/a/finding-trig-ratios-in-right-triangles" target="_blank" rel="noopener noreferrer">how sines and cosines work</a>,
as these cover everything you‚Äôll need to follow along.</p>
<p>In the images below, we see what happens on rotation by default. To remove the
empty corners, the user would have to drag around the edges of the cropbox. What
we can do instead is scale the image (in the directions shown by the &lt;span
style={{ color: <code>rgb(127, 194, 65)</code> }}&gt;green arrows) so that these
corners disappear.</p>

  
  <table background:="">
  <thead>
  <tr><th colspan="{2}">What happens on rotation</th></tr>
  </thead><tbody>
  <tr>
  <td width="50%">
    <img decoding="async" loading="lazy" maxwidth:="" src="/img/blog/2023-10-25-image-editor/1a.jpg" class="img_ev3q">
  </td><td width="50%">
    <img decoding="async" loading="lazy" maxwidth:="" src="/img/blog/2023-10-25-image-editor/1b.jpg" class="img_ev3q">
  </td>
  </tr>
  </tbody></table>
<p>So, to cover up these checkered corners, we will need to scale the image. If we
cover up the larger corner, the smaller corner will get covered up
automatically, so our code takes the form of
<code>scale(Math.max(scalingFactor1, scalingFactor2))</code>. These two scaling factors are
calculated very similarly, so we‚Äôll only focus on calculating only one of them
in this tutorial (although the full solution is given in the conclusion).</p>
<p>In the images below, the &lt;span style={{ color: <code>rgb(127, 194, 65)</code> }}&gt;green
rectangle represents the desired dimensions of our image after it‚Äôs
scaled. Our scaling function (and hopefully yours) is defined in such a way that
if we have the image of height <code>h</code>, and we want to scale it up to height <code>H</code>, we
need to execute <code>.scale(H/h)</code>. Since we already know <code>h</code>, as it‚Äôs the height of
our image, we only need to find <code>H</code> to complete our scaling function.</p>

  
  <table background:="">
  <thead>
  <tr><th colspan="{2}">We want to find H</th></tr>
  </thead><tbody>
  <tr>
  <td width="50%">
    <img decoding="async" loading="lazy" src="/img/blog/2023-10-25-image-editor/2a.jpg" class="img_ev3q">
  </td><td width="50%">
    <img decoding="async" loading="lazy" src="/img/blog/2023-10-25-image-editor/2b.jpg" class="img_ev3q">
  </td>
  </tr>
  </tbody></table>
<p>For the rest of the tutorial, the following steps are then automatic - as we
know all the angles in the image, we know the image‚Äôs width and height, and we
know to find <code>H</code>.</p>
<p padding:="">The easiest way to go about it, is to first annotate the image with all the
relevant angles. We‚Äôll be using <span color:="">blue </span> for the rotation angle
 <code>Œ±</code>, and <span color:="">pink </span>
for <code>90 - Œ±</code>:</p>

  <table background:="" textalign:="">
  <thead display:="" width:="">
  <tr><th>Color all angles</th></tr>
  </thead><tbody display:="" width:="">
  <tr>
  <td>
    <img decoding="async" loading="lazy" width:="" src="/img/blog/2023-10-25-image-editor/3.jpg" class="img_ev3q">
  </td>
  </tr>
  </tbody></table>
<p>We can then find <code>H</code>, by adding the two outer sides of these triangles.</p>

  
  <table background:="">
  <thead>
  <tr><th colspan="{2}">Add two triangle sides: H = sin(Œ± - 90) * h + sin(Œ±) * w</th></tr>
  </thead><tbody>
  <tr>
  <td width="50%">
    <img decoding="async" loading="lazy" src="/img/blog/2023-10-25-image-editor/4a.jpg" class="img_ev3q">
  </td><td width="50%">
    <img decoding="async" loading="lazy" src="/img/blog/2023-10-25-image-editor/4b.jpg" class="img_ev3q">
  </td>
  </tr>
  </tbody></table>
<p>So, now we have our desired <code>H</code>! We know one of our scaling factors is <code>H/h</code>.
Now, we just need to find our other scaling factor, which is <code>W/w</code>. This follows
a similar process, and you can find the calculations as part of the full
solution below.</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scalingFactor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scalingFactor1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scalingFactor2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">h</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">W</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">sin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Œ± </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> h </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Œ±</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">sin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Œ±</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> h </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Œ± </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> w</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" href="/blog/2023-10-25-image-editor/#conclusion">‚Äã</a></h2>
<p>In Uppy, our code ended up looking like this:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getScalingFactor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">w</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> h</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> rotationAngle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> Œ± </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">toRadians</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rotationAngle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> scalingFactor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">sin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Œ±</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> w </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">cos</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Œ±</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">sin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Œ±</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> h </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">cos</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Œ±</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> scalingFactor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cropper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getImageData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> scaleFactor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getScalingFactor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">width</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">height</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rotationAngle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cropper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">scale</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scaleFactor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can see the full version
<a href="https://github.com/transloadit/uppy/blob/12e08ada02b9080bd5e1d19526bdf8a2010e62a1/packages/%40uppy/image-editor/src/utils/getScaleFactorThatRemovesDarkCorners.js" target="_blank" rel="noopener noreferrer">on GitHub</a>.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Bonus content: our founder‚Äôs (Tim Koschuetzki) initial scribbled notes with the solution</summary><div><div class="collapsibleContent_i85q">
  <!-- -->
  <img decoding="async" loading="lazy" src="/img/blog/2023-10-25-image-editor/tim.jpg" class="img_ev3q">
</div></div></details></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_Wr5y"><ul class="footer_ZfVL"><li><a href="https://twitter.com/uppy_io" target="_blank" rel="noopener">Twitter</a></li><li><a href="https://uppy.io/blog/atom.xml" target="_blank" rel="noopener">RSS feed</a></li><li><a href="https://github.com/transloadit/uppy" target="_blank" rel="noopener">GitHub</a></li></ul></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2023/07/3.13-3.21/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">üéÑ Uppy 3.13 to 3.21: Typescript Saga: the beginning, Image Editor improvements, Dashboard auto-install</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2023/07/3.3-3.13/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Uppy 3.3 to 3.13: conditional S3 multipart, signing on the client, speedy handling of 10k files and much much more</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/blog/2023-10-25-image-editor/#3-steps">3 Steps</a><ul><li><a class="table-of-contents__link toc-highlight" href="/blog/2023-10-25-image-editor/#1-trust-your-designer">1. Trust your designer</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023-10-25-image-editor/#2-find-the-scale-function">2. Find the <code>.scale()</code> function</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023-10-25-image-editor/#3-calculate-the-geometry">3. Calculate the geometry</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023-10-25-image-editor/#conclusion">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer_J6tW"><p><img class="IndexFooter-logo" title="Uppy" alt="Uppy" src="/img/logo.svg"></p><p>Released under the<!-- --> <a href="http://opensource.org/licenses/MIT" target="_blank" rel="noreferrer noopener">MIT License</a> <!-- -->‚ãÖ <a href="/privacy-policy/">Privacy Policy</a> ‚ãÖ<!-- --> <a href="https://github.com/transloadit/uppy/blob/main/.github/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">Contributing</a></p><p>¬© 2023<!-- --> <a href="https://transloadit.com" target="_blank" rel="noopener noreferrer">Transloadit</a></p></footer></div>
</body>
</html>