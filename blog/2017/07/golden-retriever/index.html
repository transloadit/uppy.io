<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">The Golden Retriever: Making uploads survive browser crashes | Uppy</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://uppy.io/blog/2017/07/golden-retriever/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:domain" content="uppy.io"><meta data-rh="true" name="twitter:title" content="Uppy"><meta data-rh="true" name="twitter:description" content="Sleek, modular open source JavaScript file uploader"><meta data-rh="true" property="og:title" content="The Golden Retriever: Making uploads survive browser crashes | Uppy"><meta data-rh="true" name="description" content="TL;DR: We&#x27;re on a mission to improve file uploading on the web. We released"><meta data-rh="true" property="og:description" content="TL;DR: We&#x27;re on a mission to improve file uploading on the web. We released"><meta data-rh="true" property="og:image" content="http://uppy.io/img/blog/golden-retriever/uppy-team-kong.jpg"><meta data-rh="true" name="twitter:image" content="http://uppy.io/img/blog/golden-retriever/uppy-team-kong.jpg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2017-07-31T00:00:00.000Z"><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://uppy.io/blog/2017/07/golden-retriever/"><link data-rh="true" rel="alternate" href="https://uppy.io/blog/2017/07/golden-retriever/" hreflang="en"><link data-rh="true" rel="alternate" href="https://uppy.io/blog/2017/07/golden-retriever/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Q65IKQHNN5-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://uppy.io/blog/2017/07/golden-retriever","mainEntityOfPage":"https://uppy.io/blog/2017/07/golden-retriever","url":"https://uppy.io/blog/2017/07/golden-retriever","headline":"The Golden Retriever: Making uploads survive browser crashes","name":"The Golden Retriever: Making uploads survive browser crashes","description":"TL;DR: We're on a mission to improve file uploading on the web. We released","datePublished":"2017-07-31T00:00:00.000Z","author":{"@type":"Person","name":"Artur Paikin","email":"artur@transloadit.com","image":"https://github.com/arturi.png"},"image":{"@type":"ImageObject","@id":"http://uppy.io/img/blog/golden-retriever/uppy-team-kong.jpg","url":"http://uppy.io/img/blog/golden-retriever/uppy-team-kong.jpg","contentUrl":"http://uppy.io/img/blog/golden-retriever/uppy-team-kong.jpg","caption":"title image for the blog post: The Golden Retriever: Making uploads survive browser crashes"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://uppy.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Uppy RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Uppy Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Uppy" href="/opensearch.xml">

<meta name="google-site-verification" content="JxARoHXoCI8bD07pLV_u3z6xpuWNcSIZIcHEytyCkUc">
<script src="https://plausible.io/js/script.js" async defer="defer" data-domain="uppy.io"></script>
<script src="https://buttons.github.io/buttons.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.1a478289.css">
<script src="/assets/js/runtime~main.4efeff58.js" defer="defer"></script>
<script src="/assets/js/main.f8cdfd99.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><p class="header_wuUL"><a href="/blog/uppy-5.0/">Uppy 5.0 is here with headless components and hooks</a></p><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Uppy Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Uppy Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Uppy</b></a><a class="navbar__item navbar__link" href="/docs/quick-start/">Docs</a><a class="navbar__item navbar__link" href="/examples/">Examples</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a><a href="https://github.com/transloadit/uppy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://community.transloadit.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://transloadit.com/open-source/support/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1"><article><header><h1 class="title_f1Hy">The Golden Retriever: Making uploads survive browser crashes</h1><div class="container_mt6G margin-vert--md"><time datetime="2017-07-31T00:00:00.000Z">July 31, 2017</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="mailto:artur@transloadit.com" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/arturi.png" alt="Artur Paikin"></a><div class="avatar__intro"><div class="avatar__name"><a href="mailto:artur@transloadit.com" target="_blank" rel="noopener noreferrer"><span>Artur Paikin</span></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><strong>TL;DR:</strong> We&#x27;re on a mission to improve file uploading on the web. We released
<a href="https://tus.io" target="_blank" rel="noopener noreferrer">tus</a>: the open protocol for resumable file uploads, as well as
Uppy: the next open source file uploader for web browsers. Uppy uses tus, which
makes it resilient to poor network conditions and crashing servers. Today we’re
launching an Uppy feature that also makes it resilient to browser crashes, which
we believe is an industry first. We’re sharing a quick
<a href="/blog/2017/07/golden-retriever/#demo">demo</a> video, a bit of
<a href="/blog/2017/07/golden-retriever/#uppy">background</a>,
<a href="/blog/2017/07/golden-retriever/#how">how</a> exactly we achieved this, and how you
can <a href="/blog/2017/07/golden-retriever/#try">try</a> it yourself.</p>
<p>***</p>
<p>Don’t you just hate it when you’re about to share the perfect photos from your
trip to Iceland, and halfway through, your cat jumps on the keyboard and trashes
your browser? Or the battery in your laptop dies? Or you accidentally close the
tab or navigate away? We hate that too!</p>
<p>If action games have had checkpoints since 1687 — why can’t file uploaders?
Well, as it turns out, they can! We found a way to get those Iceland pics into
the hands of your loved ones with near-zero levels of frustration, even after a
dreaded Blue Screen of Death! (if that is still a thing ;)</p>
<p><a name="demo"></a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="demo">Demo<a class="hash-link" aria-label="Direct link to Demo" title="Direct link to Demo" href="/blog/2017/07/golden-retriever/#demo">​</a></h2>
<p>First off, let’s show you a demo 📹 of Uppy surviving a browser crash and
picking up right where we left it:</p>
<figure class="wide"><video alt="Demo video showing the Golden Retriever file restoring plugin in action" controls=""><source src="/img/blog/golden-retriever/uppy-golden-retriever-crash-demo-2.mp4" type="video/mp4">Your browser does not support the video tag, you can <a href="https://uppy.io/img/blog/golden-retriever/uppy-golden-retriever-crash-demo-2.mp4" target="_blank" rel="noopener noreferrer">download the video</a> to watch it.</video></figure>
<p><a name="uppy"></a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="uppy">Uppy?<a class="hash-link" aria-label="Direct link to Uppy?" title="Direct link to Uppy?" href="/blog/2017/07/golden-retriever/#uppy">​</a></h2>
<p>For those of you who are new here, Uppy is the next-gen open source file
uploader for the web. It is made by Transloadit and thus it works great with
their uploading &amp; encoding platform — but it also works great without! Simply
add Uppy JavaScript to your website, deploy your own tusd/Node.js/Apache/Nginx
server, and be on your way. Add
<a href="https://github.com/transloadit/uppy-server" target="_blank" rel="noopener noreferrer">uppy-server</a>, and your users will
be able to pick files from remote sources like Dropbox and Instagram. Uppy’s
focus is on the modern web, and we go through extreme lengths to achieve the
smoothest of user experiences, and the most durable of reliabilities. 🙃</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hacking-trip">Hacking trip<a class="hash-link" aria-label="Direct link to Hacking trip" title="Direct link to Hacking trip" href="/blog/2017/07/golden-retriever/#hacking-trip">​</a></h2>
<p>Our core team is spread across three continents and five cities, and most of us
have never met in person, with the majority of communication happening in GitHub
and Slack. Just last week, we got together in Berlin for a crazy week of pink
limo rides, Indian food and Mario Kart 64. More on that on the
<a href="https://transloadit.com/blog/2017/08/team-meetup-2017/" target="_blank" rel="noopener noreferrer">Transloadit blog</a>.</p>
<figure class="wide">
  <img decoding="async" loading="lazy" src="/img/blog/golden-retriever/uppy-team-kong.jpg" class="img_ev3q">
</figure>
<p>While enjoying some world-famous-in-Germany “Flammkuchen”, we were thinking
about even more ways to make file uploading better (yes, we really can’t stop
thinking about that). We then sat together in one room for a few days of hacking
and came up with something neat.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-golden-retriever">The Golden Retriever<a class="hash-link" aria-label="Direct link to The Golden Retriever" title="Direct link to The Golden Retriever" href="/blog/2017/07/golden-retriever/#the-golden-retriever">​</a></h2>
<p>Uppy has a new friend to play with. Meet the Golden Retriever, our file recovery
plugin:</p>
<center><img decoding="async" loading="lazy" src="/img/blog/golden-retriever/catch-fail-2.gif" alt="Golden Retriever failing to catch something" title="Good try, girl!" class="img_ev3q"></center>
<p>As you can see, we’re not yet fully done with training her, but we’re getting
there! 😄</p>
<p>But wait, we can hear you think, didn&#x27;t <a href="https://tus.io" target="_blank" rel="noopener noreferrer">tus.io</a> already make
resumable uploads possible? Yes indeed, and it does an awesome job at recovering
from poor network conditions. However, if your browser suddenly decided to
crash, Uppy would have no idea about what it was doing before, and you would
have to re-select and edit your files all over.</p>
<center><img decoding="async" loading="lazy" src="/img/blog/golden-retriever/no-idea-dog-3.gif" alt="Dog has no idea what he is doing" title="Keep trying, buddy!" class="img_ev3q"></center>
<p>For those cases, our Golden Retriever now comes to the rescue! It saves Uppy’s
memory (state) in browser cache with every move you make. This means that when
Uppy suddenly crashes for whatever reason, our plugin will be able to retrieve
this memory upon restart, and offer to resume where you left off. Sounds simple
enough right? So why hasn&#x27;t anybody attempted this before?</p>
<p>As it turns out, it’s tricky. For one thing, no other competing file uploader
uses tus, and resuming uploads without standardized and scrutinized components
is really leaving you with more problems than you’re trying to solve in the
first place. But with tus, we are standing on the shoulders of a giant and need
not worry about the resumability aspect of the transmission.</p>
<p>So then it becomes all about remembering what was going on with file selection
and uploading right before the crash. One of the big issues here is that because
of security reasons, Uppy is no longer allowed to access the selected files on
your disk after a crash. Reasonable of course, but this meant that we had to
deploy a number of workarounds that — while it may cause our inner purist some
upset - combined, now amount to a pretty sweet user experience for the majority
of cases. And in the end, that is what Uppy is all about: pleasing and
delighting its users.</p>
<p><a name="how"></a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-how-it-works">👻 How it works<a class="hash-link" aria-label="Direct link to 👻 How it works" title="Direct link to 👻 How it works" href="/blog/2017/07/golden-retriever/#-how-it-works">​</a></h2>
<p>If you really want to know...</p>
<p>Because we cannot access the files that we were uploading from disk, we cache
them inside the browser.</p>
<p>It all started with
<a href="https://github.com/transloadit/uppy/issues/237" target="_blank" rel="noopener noreferrer">a prototype</a> by
<a href="https://github.com/richardwillars" target="_blank" rel="noopener noreferrer">Richard Willars</a>, which used a Service
Worker to store files and states. Service Workers are great for when you close a
tab, but when the browser dies, so does the Service Worker (in most cases).
Also: iOS does not support it yet. So, we looked at Local Storage, which is
almost universally available and <em>can</em> survive a browser crash, but can&#x27;t be
used to store blobs. We also considered IndexedDB, which <em>can</em> store blobs, but
is less available and has severe limits on how much you can or should store in
it.</p>
<p>Since all of these technologies came with specific drawbacks, which one should
we pick?</p>
<p>Why, all of them, of course! By combining the three, they cover each other’s
disadvantages with their own advantages. Here&#x27;s what goes where:</p>
<ul>
<li>Local Storage stores all files state, without blobs (the actual data of the
file), and restores this meta information on boot.</li>
<li>Service Worker stores references to all file blobs in memory. This should
persist when navigating away from a page or closing the browser tab, but will
likely get destroyed after a browser crash / quit.</li>
<li>IndexedDB stores all files that can reasonably be stored there, up to 10 MB
per file and 300 MB in total (we are still debating reasonable limits). This
persists until either the browser or Uppy decides to do a cleanup.</li>
</ul>
<p>Now when Uppy starts, we restore all meta information from Local Storage to get
an idea of what was going on. For the blobs, we try to recover data from both
the Service Worker and IndexedDB. This goes a long way into supporting many
disastrous scenarios out there.</p>
<p>In some cases (very large files or a complete browser crash), we won’t be able
to recover the file, but we do have valuable information about it, such as the
name and a preview.</p>
<p>Our current idea is that we could present the user with “ghost files” for these
edge cases, and ask them to re-add such files. Here’s an early mockup, but we
would love more feedback on this:</p>
<img decoding="async" loading="lazy" src="/img/blog/golden-retriever/desktop-ghost.png" alt="Design mockup with ghosts" title="Design mockup with ghosts" class="img_ev3q">
<p>For the remaining cases, if an upload was already in progress before the
crash/refresh, and especially if it was resumable (via <a href="https://tus.io" target="_blank" rel="noopener noreferrer">tus</a>,
for example), Golden Retriever just picks up from where it all went south. Our
Golden Retriever will also clean up after herself: when files are successfully
uploaded, or you decide to delete them, they will be removed from all
“permanent” storages.</p>
<p><a name="try"></a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-give-it-a-try-in-alpha">🚦 Give it a try in alpha<a class="hash-link" aria-label="Direct link to 🚦 Give it a try in alpha" title="Direct link to 🚦 Give it a try in alpha" href="/blog/2017/07/golden-retriever/#-give-it-a-try-in-alpha">​</a></h2>
<p>Golden Retriever already works — tail awagging — and feels like magic
✨, but it is also unstable, and hasn’t been tested on all the different
devices yet. We encourage you to try it out though:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/transloadit/uppy.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git checkout feature/restore-files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A new browser tab with Uppy + Golden Retriever should open in a moment after the
last command from above. The app entry point is in
<code>examples/bundled-example/main.js</code>, it rebuilds on change. Enjoy! And please
give your feedback in the <a href="https://github.com/transloadit/uppy/pull/268" target="_blank" rel="noopener noreferrer">#268</a>
PR 🎉</p>
<p>The Uppy Team</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_Wr5y"><ul class="footer_ZfVL"><li><a href="https://twitter.com/uppy_io" target="_blank" rel="noopener">Twitter</a></li><li><a href="https://uppy.io/blog/atom.xml" target="_blank" rel="noopener">RSS feed</a></li><li><a href="https://github.com/transloadit/uppy" target="_blank" rel="noopener">GitHub</a></li></ul></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2017/08/0.18/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Uppy 0.18: Dogumentation and The GoldenRetriever</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2017/05/0.17/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Uppy 0.17: Restrictions</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/blog/2017/07/golden-retriever/#demo">Demo</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2017/07/golden-retriever/#uppy">Uppy?</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2017/07/golden-retriever/#hacking-trip">Hacking trip</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2017/07/golden-retriever/#the-golden-retriever">The Golden Retriever</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2017/07/golden-retriever/#-how-it-works">👻 How it works</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2017/07/golden-retriever/#-give-it-a-try-in-alpha">🚦 Give it a try in alpha</a></li></ul></div></div></div></div></div><footer class="footer_J6tW"><p><img class="IndexFooter-logo" title="Uppy" alt="Uppy" src="/img/logo.svg"></p><p>Released under the<!-- --> <a href="http://opensource.org/licenses/MIT" target="_blank" rel="noreferrer noopener">MIT License</a> <!-- -->⋅ <a href="/privacy-policy/">Privacy Policy</a> ⋅<!-- --> <a href="https://github.com/transloadit/uppy/blob/main/.github/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">Contributing</a></p><p>© 2016-<!-- -->2025<!-- --> <a href="https://transloadit.com" target="_blank" rel="noopener noreferrer">Transloadit</a></p></footer></div>
</body>
</html>